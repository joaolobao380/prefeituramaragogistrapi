{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _typeof = require(\"@babel/runtime/helpers/typeof\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _lodash = require(\"lodash\");\n\nvar _reactRouterDom = require(\"react-router-dom\");\n\nvar _reactIntl = require(\"react-intl\");\n\nvar _custom = require(\"@buffetjs/custom\");\n\nvar _strapiHelperPlugin = require(\"strapi-helper-plugin\");\n\nvar _pluginId = _interopRequireDefault(require(\"../../pluginId\"));\n\nvar _Block = _interopRequireDefault(require(\"../Block\"));\n\nvar _Container = _interopRequireDefault(require(\"../Container\"));\n\nvar _SectionTitle = _interopRequireDefault(require(\"../SectionTitle\"));\n\nvar _Separator = _interopRequireDefault(require(\"../Separator\"));\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nvar SettingsViewWrapper = function SettingsViewWrapper(_ref) {\n  var children = _ref.children,\n      goBack = _ref.history.goBack,\n      displayedFields = _ref.displayedFields,\n      inputs = _ref.inputs,\n      initialData = _ref.initialData,\n      isEditSettings = _ref.isEditSettings,\n      isLoading = _ref.isLoading,\n      modifiedData = _ref.modifiedData,\n      name = _ref.name,\n      onChange = _ref.onChange,\n      onConfirmReset = _ref.onConfirmReset,\n      onConfirmSubmit = _ref.onConfirmSubmit,\n      onModalConfirmClosed = _ref.onModalConfirmClosed;\n\n  var _useGlobalContext = (0, _strapiHelperPlugin.useGlobalContext)(),\n      emitEvent = _useGlobalContext.emitEvent,\n      formatMessage = _useGlobalContext.formatMessage;\n\n  var _useState = (0, _react.useState)(false),\n      _useState2 = (0, _slicedToArray2[\"default\"])(_useState, 2),\n      showWarningCancel = _useState2[0],\n      setWarningCancel = _useState2[1];\n\n  var _useState3 = (0, _react.useState)(false),\n      _useState4 = (0, _slicedToArray2[\"default\"])(_useState3, 2),\n      showWarningSubmit = _useState4[0],\n      setWarningSubmit = _useState4[1];\n\n  var attributes = (0, _react.useMemo)(function () {\n    return (0, _lodash.get)(modifiedData, ['attributes'], {});\n  }, [modifiedData]);\n\n  var toggleWarningCancel = function toggleWarningCancel() {\n    return setWarningCancel(function (prevState) {\n      return !prevState;\n    });\n  };\n\n  var toggleWarningSubmit = function toggleWarningSubmit() {\n    return setWarningSubmit(function (prevState) {\n      return !prevState;\n    });\n  };\n\n  var getPluginHeaderActions = function getPluginHeaderActions() {\n    return [{\n      color: 'cancel',\n      onClick: toggleWarningCancel,\n      label: formatMessage({\n        id: 'app.components.Button.reset'\n      }),\n      type: 'button',\n      disabled: (0, _lodash.isEqual)(modifiedData, initialData),\n      style: {\n        fontWeight: 600,\n        paddingLeft: 15,\n        paddingRight: 15\n      }\n    }, {\n      color: 'success',\n      label: formatMessage({\n        id: \"\".concat(_pluginId[\"default\"], \".containers.Edit.submit\")\n      }),\n      type: 'submit',\n      disabled: (0, _lodash.isEqual)(modifiedData, initialData),\n      style: {\n        minWidth: 150,\n        fontWeight: 600\n      }\n    }];\n  };\n\n  var headerProps = {\n    actions: getPluginHeaderActions(),\n    title: {\n      label: formatMessage({\n        id: \"\".concat(_pluginId[\"default\"], \".components.SettingsViewWrapper.pluginHeader.title\")\n      }, {\n        name: (0, _lodash.upperFirst)(name)\n      })\n    },\n    content: formatMessage({\n      id: \"\".concat(_pluginId[\"default\"], \".components.SettingsViewWrapper.pluginHeader.description.\").concat(isEditSettings ? 'edit' : 'list', \"-settings\")\n    })\n  };\n\n  var getSelectOptions = function getSelectOptions(input) {\n    if (input.name === 'settings.defaultSortBy') {\n      return ['id'].concat((0, _toConsumableArray2[\"default\"])(displayedFields.filter(function (name) {\n        var type = (0, _lodash.get)(attributes, [name, 'type']);\n        return !['media', 'richtext', 'dynamiczone', 'relation'].includes(type) && name !== 'id';\n      })));\n    }\n\n    if (input.name === 'settings.mainField') {\n      var options = Object.keys(attributes).filter(function (attr) {\n        var type = (0, _lodash.get)(attributes, [attr, 'type'], '');\n        return !['dynamiczone', 'json', 'text', 'relation', 'component', 'boolean', 'date', 'media', 'richtext', 'timestamp'].includes(type) && !!type;\n      });\n      return options;\n    }\n\n    return input.options;\n  };\n\n  var handleSubmit = function handleSubmit(e) {\n    e.preventDefault();\n    toggleWarningSubmit();\n    emitEvent('willSaveContentTypeLayout');\n  };\n\n  if (isLoading) {\n    return /*#__PURE__*/_react[\"default\"].createElement(_strapiHelperPlugin.LoadingIndicatorPage, null);\n  }\n\n  return /*#__PURE__*/_react[\"default\"].createElement(_react[\"default\"].Fragment, null, /*#__PURE__*/_react[\"default\"].createElement(_strapiHelperPlugin.BackHeader, {\n    onClick: goBack\n  }), /*#__PURE__*/_react[\"default\"].createElement(_Container[\"default\"], {\n    className: \"container-fluid\"\n  }, /*#__PURE__*/_react[\"default\"].createElement(\"form\", {\n    onSubmit: handleSubmit\n  }, /*#__PURE__*/_react[\"default\"].createElement(_custom.Header, headerProps), /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n    className: \"row\",\n    style: {\n      paddingTop: '3px'\n    }\n  }, /*#__PURE__*/_react[\"default\"].createElement(_Block[\"default\"], {\n    style: {\n      marginBottom: '13px',\n      paddingBottom: '30px',\n      paddingTop: '24px'\n    }\n  }, /*#__PURE__*/_react[\"default\"].createElement(_SectionTitle[\"default\"], {\n    isSettings: true\n  }), /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n    className: \"row\"\n  }, inputs.map(function (input) {\n    return /*#__PURE__*/_react[\"default\"].createElement(_reactIntl.FormattedMessage, {\n      key: input.name,\n      id: input.label.id\n    }, function (label) {\n      return /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n        className: input.customBootstrapClass\n      }, /*#__PURE__*/_react[\"default\"].createElement(_reactIntl.FormattedMessage, {\n        id: (0, _lodash.get)(input, 'description.id', 'app.utils.defaultMessage')\n      }, function (description) {\n        return /*#__PURE__*/_react[\"default\"].createElement(_custom.Inputs, (0, _extends2[\"default\"])({}, input, {\n          description: description,\n          label: label === ' ' ? null : label,\n          onChange: onChange,\n          options: getSelectOptions(input),\n          value: (0, _lodash.get)(modifiedData, input.name, '')\n        }));\n      }));\n    });\n  }), /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n    className: \"col-12\"\n  }, /*#__PURE__*/_react[\"default\"].createElement(_Separator[\"default\"], {\n    style: {\n      marginBottom: 20\n    }\n  }))), /*#__PURE__*/_react[\"default\"].createElement(_SectionTitle[\"default\"], null), children)), /*#__PURE__*/_react[\"default\"].createElement(_strapiHelperPlugin.PopUpWarning, {\n    isOpen: showWarningCancel,\n    toggleModal: toggleWarningCancel,\n    content: {\n      message: \"\".concat(_pluginId[\"default\"], \".popUpWarning.warning.cancelAllSettings\")\n    },\n    popUpWarningType: \"danger\",\n    onConfirm: function onConfirm() {\n      onConfirmReset();\n      toggleWarningCancel();\n    }\n  }), /*#__PURE__*/_react[\"default\"].createElement(_strapiHelperPlugin.ModalConfirm, {\n    isOpen: showWarningSubmit,\n    toggle: toggleWarningSubmit,\n    content: {\n      id: \"\".concat(_pluginId[\"default\"], \".popUpWarning.warning.updateAllSettings\")\n    },\n    type: \"success\",\n    onConfirm: /*#__PURE__*/(0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee() {\n      return _regenerator[\"default\"].wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return onConfirmSubmit();\n\n            case 2:\n              toggleWarningSubmit();\n\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    })),\n    onClosed: function onClosed() {\n      if (onModalConfirmClosed) {\n        onModalConfirmClosed();\n      }\n    }\n  }))));\n};\n\nSettingsViewWrapper.defaultProps = {\n  displayedFields: [],\n  inputs: [],\n  initialData: {},\n  isEditSettings: false,\n  modifiedData: {},\n  name: '',\n  onConfirmReset: function onConfirmReset() {},\n  onConfirmSubmit: function () {\n    var _onConfirmSubmit = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee2() {\n      return _regenerator[\"default\"].wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    function onConfirmSubmit() {\n      return _onConfirmSubmit.apply(this, arguments);\n    }\n\n    return onConfirmSubmit;\n  }(),\n  onModalConfirmClosed: null,\n  onSubmit: function onSubmit() {},\n  pluginHeaderProps: {\n    actions: [],\n    description: {\n      id: 'app.utils.defaultMessage'\n    },\n    title: {\n      id: 'app.utils.defaultMessage',\n      values: {}\n    }\n  }\n};\nSettingsViewWrapper.propTypes = {\n  children: _propTypes[\"default\"].node.isRequired,\n  displayedFields: _propTypes[\"default\"].array,\n  history: _propTypes[\"default\"].shape({\n    goBack: _propTypes[\"default\"].func.isRequired\n  }).isRequired,\n  initialData: _propTypes[\"default\"].object,\n  inputs: _propTypes[\"default\"].array,\n  isEditSettings: _propTypes[\"default\"].bool,\n  isLoading: _propTypes[\"default\"].bool.isRequired,\n  modifiedData: _propTypes[\"default\"].object,\n  name: _propTypes[\"default\"].string,\n  onChange: _propTypes[\"default\"].func.isRequired,\n  onConfirmReset: _propTypes[\"default\"].func,\n  onConfirmSubmit: _propTypes[\"default\"].func,\n  onModalConfirmClosed: _propTypes[\"default\"].func,\n  onSubmit: _propTypes[\"default\"].func,\n  pluginHeaderProps: _propTypes[\"default\"].shape({\n    actions: _propTypes[\"default\"].array,\n    description: _propTypes[\"default\"].shape({\n      id: _propTypes[\"default\"].string\n    }),\n    title: _propTypes[\"default\"].shape({\n      id: _propTypes[\"default\"].string,\n      values: _propTypes[\"default\"].object\n    })\n  })\n};\n\nvar _default = (0, _reactRouterDom.withRouter)(SettingsViewWrapper);\n\nexports[\"default\"] = _default;","map":{"version":3,"sources":["/Users/joaovictorlobao/prefeituramaragogistrapi/.cache/plugins/strapi-plugin-content-manager/admin/src/components/SettingsViewWrapper/index.js"],"names":["SettingsViewWrapper","children","goBack","history","displayedFields","inputs","initialData","isEditSettings","isLoading","modifiedData","name","onChange","onConfirmReset","onConfirmSubmit","onModalConfirmClosed","emitEvent","formatMessage","showWarningCancel","setWarningCancel","showWarningSubmit","setWarningSubmit","attributes","toggleWarningCancel","prevState","toggleWarningSubmit","getPluginHeaderActions","color","onClick","label","id","type","disabled","style","fontWeight","paddingLeft","paddingRight","pluginId","minWidth","headerProps","actions","title","content","getSelectOptions","input","filter","includes","options","Object","keys","attr","handleSubmit","e","preventDefault","paddingTop","marginBottom","paddingBottom","map","customBootstrapClass","description","message","defaultProps","onSubmit","pluginHeaderProps","values","propTypes","PropTypes","node","isRequired","array","shape","func","object","bool","string"],"mappings":";;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAQA;;AACA;;AACA;;AACA;;AACA;;;;;;AAEA,IAAMA,mBAAmB,GAAG,SAAtBA,mBAAsB,OActB;AAAA,MAbJC,QAaI,QAbJA,QAaI;AAAA,MAZOC,MAYP,QAZJC,OAYI,CAZOD,MAYP;AAAA,MAXJE,eAWI,QAXJA,eAWI;AAAA,MAVJC,MAUI,QAVJA,MAUI;AAAA,MATJC,WASI,QATJA,WASI;AAAA,MARJC,cAQI,QARJA,cAQI;AAAA,MAPJC,SAOI,QAPJA,SAOI;AAAA,MANJC,YAMI,QANJA,YAMI;AAAA,MALJC,IAKI,QALJA,IAKI;AAAA,MAJJC,QAII,QAJJA,QAII;AAAA,MAHJC,cAGI,QAHJA,cAGI;AAAA,MAFJC,eAEI,QAFJA,eAEI;AAAA,MADJC,oBACI,QADJA,oBACI;;AACJ,0BAAqC,2CAArC;AAAA,MAAQC,SAAR,qBAAQA,SAAR;AAAA,MAAmBC,aAAnB,qBAAmBA,aAAnB;;AACA,kBAA8C,qBAAS,KAAT,CAA9C;AAAA;AAAA,MAAOC,iBAAP;AAAA,MAA0BC,gBAA1B;;AACA,mBAA8C,qBAAS,KAAT,CAA9C;AAAA;AAAA,MAAOC,iBAAP;AAAA,MAA0BC,gBAA1B;;AAEA,MAAMC,UAAU,GAAG,oBAAQ,YAAM;AAC/B,WAAO,iBAAIZ,YAAJ,EAAkB,CAAC,YAAD,CAAlB,EAAkC,EAAlC,CAAP;AACD,GAFkB,EAEhB,CAACA,YAAD,CAFgB,CAAnB;;AAIA,MAAMa,mBAAmB,GAAG,SAAtBA,mBAAsB;AAAA,WAAMJ,gBAAgB,CAAC,UAAAK,SAAS;AAAA,aAAI,CAACA,SAAL;AAAA,KAAV,CAAtB;AAAA,GAA5B;;AACA,MAAMC,mBAAmB,GAAG,SAAtBA,mBAAsB;AAAA,WAAMJ,gBAAgB,CAAC,UAAAG,SAAS;AAAA,aAAI,CAACA,SAAL;AAAA,KAAV,CAAtB;AAAA,GAA5B;;AAEA,MAAME,sBAAsB,GAAG,SAAzBA,sBAAyB,GAAM;AACnC,WAAO,CACL;AACEC,MAAAA,KAAK,EAAE,QADT;AAEEC,MAAAA,OAAO,EAAEL,mBAFX;AAGEM,MAAAA,KAAK,EAAEZ,aAAa,CAAC;AACnBa,QAAAA,EAAE,EAAE;AADe,OAAD,CAHtB;AAMEC,MAAAA,IAAI,EAAE,QANR;AAOEC,MAAAA,QAAQ,EAAE,qBAAQtB,YAAR,EAAsBH,WAAtB,CAPZ;AAQE0B,MAAAA,KAAK,EAAE;AACLC,QAAAA,UAAU,EAAE,GADP;AAELC,QAAAA,WAAW,EAAE,EAFR;AAGLC,QAAAA,YAAY,EAAE;AAHT;AART,KADK,EAeL;AACET,MAAAA,KAAK,EAAE,SADT;AAEEE,MAAAA,KAAK,EAAEZ,aAAa,CAAC;AACnBa,QAAAA,EAAE,YAAKO,oBAAL;AADiB,OAAD,CAFtB;AAKEN,MAAAA,IAAI,EAAE,QALR;AAMEC,MAAAA,QAAQ,EAAE,qBAAQtB,YAAR,EAAsBH,WAAtB,CANZ;AAOE0B,MAAAA,KAAK,EAAE;AACLK,QAAAA,QAAQ,EAAE,GADL;AAELJ,QAAAA,UAAU,EAAE;AAFP;AAPT,KAfK,CAAP;AA4BD,GA7BD;;AA+BA,MAAMK,WAAW,GAAG;AAClBC,IAAAA,OAAO,EAAEd,sBAAsB,EADb;AAElBe,IAAAA,KAAK,EAAE;AACLZ,MAAAA,KAAK,EAAEZ,aAAa,CAClB;AACEa,QAAAA,EAAE,YAAKO,oBAAL;AADJ,OADkB,EAIlB;AAAE1B,QAAAA,IAAI,EAAE,wBAAWA,IAAX;AAAR,OAJkB;AADf,KAFW;AAUlB+B,IAAAA,OAAO,EAAEzB,aAAa,CAAC;AACrBa,MAAAA,EAAE,YAAKO,oBAAL,sEACA7B,cAAc,GAAG,MAAH,GAAY,MAD1B;AADmB,KAAD;AAVJ,GAApB;;AAiBA,MAAMmC,gBAAgB,GAAG,SAAnBA,gBAAmB,CAAAC,KAAK,EAAI;AAChC,QAAIA,KAAK,CAACjC,IAAN,KAAe,wBAAnB,EAA6C;AAC3C,cACE,IADF,6CAEKN,eAAe,CAACwC,MAAhB,CAAuB,UAAAlC,IAAI,EAAI;AAChC,YAAMoB,IAAI,GAAG,iBAAIT,UAAJ,EAAgB,CAACX,IAAD,EAAO,MAAP,CAAhB,CAAb;AAEA,eAAO,CAAC,CAAC,OAAD,EAAU,UAAV,EAAsB,aAAtB,EAAqC,UAArC,EAAiDmC,QAAjD,CAA0Df,IAA1D,CAAD,IAAoEpB,IAAI,KAAK,IAApF;AACD,OAJE,CAFL;AAQD;;AAED,QAAIiC,KAAK,CAACjC,IAAN,KAAe,oBAAnB,EAAyC;AACvC,UAAMoC,OAAO,GAAGC,MAAM,CAACC,IAAP,CAAY3B,UAAZ,EAAwBuB,MAAxB,CAA+B,UAAAK,IAAI,EAAI;AACrD,YAAMnB,IAAI,GAAG,iBAAIT,UAAJ,EAAgB,CAAC4B,IAAD,EAAO,MAAP,CAAhB,EAAgC,EAAhC,CAAb;AAEA,eACE,CAAC,CACC,aADD,EAEC,MAFD,EAGC,MAHD,EAIC,UAJD,EAKC,WALD,EAMC,SAND,EAOC,MAPD,EAQC,OARD,EASC,UATD,EAUC,WAVD,EAWCJ,QAXD,CAWUf,IAXV,CAAD,IAWoB,CAAC,CAACA,IAZxB;AAcD,OAjBe,CAAhB;AAmBA,aAAOgB,OAAP;AACD;;AAED,WAAOH,KAAK,CAACG,OAAb;AACD,GApCD;;AAsCA,MAAMI,YAAY,GAAG,SAAfA,YAAe,CAAAC,CAAC,EAAI;AACxBA,IAAAA,CAAC,CAACC,cAAF;AACA5B,IAAAA,mBAAmB;AACnBT,IAAAA,SAAS,CAAC,2BAAD,CAAT;AACD,GAJD;;AAMA,MAAIP,SAAJ,EAAe;AACb,wBAAO,gCAAC,wCAAD,OAAP;AACD;;AAED,sBACE,+EACE,gCAAC,8BAAD;AAAY,IAAA,OAAO,EAAEN;AAArB,IADF,eAEE,gCAAC,qBAAD;AAAW,IAAA,SAAS,EAAC;AAArB,kBACE;AAAM,IAAA,QAAQ,EAAEgD;AAAhB,kBACE,gCAAC,cAAD,EAAYZ,WAAZ,CADF,eAEE;AACE,IAAA,SAAS,EAAC,KADZ;AAEE,IAAA,KAAK,EAAE;AACLe,MAAAA,UAAU,EAAE;AADP;AAFT,kBAME,gCAAC,iBAAD;AACE,IAAA,KAAK,EAAE;AACLC,MAAAA,YAAY,EAAE,MADT;AAELC,MAAAA,aAAa,EAAE,MAFV;AAGLF,MAAAA,UAAU,EAAE;AAHP;AADT,kBAOE,gCAAC,wBAAD;AAAc,IAAA,UAAU;AAAxB,IAPF,eAQE;AAAK,IAAA,SAAS,EAAC;AAAf,KACGhD,MAAM,CAACmD,GAAP,CAAW,UAAAb,KAAK,EAAI;AACnB,wBACE,gCAAC,2BAAD;AAAkB,MAAA,GAAG,EAAEA,KAAK,CAACjC,IAA7B;AAAmC,MAAA,EAAE,EAAEiC,KAAK,CAACf,KAAN,CAAYC;AAAnD,OACG,UAAAD,KAAK;AAAA,0BACJ;AAAK,QAAA,SAAS,EAAEe,KAAK,CAACc;AAAtB,sBACE,gCAAC,2BAAD;AACE,QAAA,EAAE,EAAE,iBAAId,KAAJ,EAAW,gBAAX,EAA6B,0BAA7B;AADN,SAGG,UAAAe,WAAW;AAAA,4BACV,gCAAC,cAAD,gCACMf,KADN;AAEE,UAAA,WAAW,EAAEe,WAFf;AAGE,UAAA,KAAK,EAAE9B,KAAK,KAAK,GAAV,GAAgB,IAAhB,GAAuBA,KAHhC;AAIE,UAAA,QAAQ,EAAEjB,QAJZ;AAKE,UAAA,OAAO,EAAE+B,gBAAgB,CAACC,KAAD,CAL3B;AAME,UAAA,KAAK,EAAE,iBAAIlC,YAAJ,EAAkBkC,KAAK,CAACjC,IAAxB,EAA8B,EAA9B;AANT,WADU;AAAA,OAHd,CADF,CADI;AAAA,KADR,CADF;AAsBD,GAvBA,CADH,eAyBE;AAAK,IAAA,SAAS,EAAC;AAAf,kBACE,gCAAC,qBAAD;AAAW,IAAA,KAAK,EAAE;AAAE4C,MAAAA,YAAY,EAAE;AAAhB;AAAlB,IADF,CAzBF,CARF,eAqCE,gCAAC,wBAAD,OArCF,EAsCGrD,QAtCH,CANF,CAFF,eAiDE,gCAAC,gCAAD;AACE,IAAA,MAAM,EAAEgB,iBADV;AAEE,IAAA,WAAW,EAAEK,mBAFf;AAGE,IAAA,OAAO,EAAE;AACPqC,MAAAA,OAAO,YAAKvB,oBAAL;AADA,KAHX;AAME,IAAA,gBAAgB,EAAC,QANnB;AAOE,IAAA,SAAS,EAAE,qBAAM;AACfxB,MAAAA,cAAc;AACdU,MAAAA,mBAAmB;AACpB;AAVH,IAjDF,eA6DE,gCAAC,gCAAD;AACE,IAAA,MAAM,EAAEH,iBADV;AAEE,IAAA,MAAM,EAAEK,mBAFV;AAGE,IAAA,OAAO,EAAE;AACPK,MAAAA,EAAE,YAAKO,oBAAL;AADK,KAHX;AAME,IAAA,IAAI,EAAC,SANP;AAOE,IAAA,SAAS,6FAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACHvB,eAAe,EADZ;;AAAA;AAETW,cAAAA,mBAAmB;;AAFV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAF,EAPX;AAWE,IAAA,QAAQ,EAAE,oBAAM;AACd,UAAIV,oBAAJ,EAA0B;AACxBA,QAAAA,oBAAoB;AACrB;AACF;AAfH,IA7DF,CADF,CAFF,CADF;AAsFD,CAhND;;AAkNAd,mBAAmB,CAAC4D,YAApB,GAAmC;AACjCxD,EAAAA,eAAe,EAAE,EADgB;AAEjCC,EAAAA,MAAM,EAAE,EAFyB;AAGjCC,EAAAA,WAAW,EAAE,EAHoB;AAIjCC,EAAAA,cAAc,EAAE,KAJiB;AAKjCE,EAAAA,YAAY,EAAE,EALmB;AAMjCC,EAAAA,IAAI,EAAE,EAN2B;AAOjCE,EAAAA,cAAc,EAAE,0BAAM,CAAE,CAPS;AAQjCC,EAAAA,eAAe;AAAA,yGAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAF;;AAAA;AAAA;AAAA;;AAAA;AAAA,KARkB;AASjCC,EAAAA,oBAAoB,EAAE,IATW;AAUjC+C,EAAAA,QAAQ,EAAE,oBAAM,CAAE,CAVe;AAWjCC,EAAAA,iBAAiB,EAAE;AACjBvB,IAAAA,OAAO,EAAE,EADQ;AAEjBmB,IAAAA,WAAW,EAAE;AACX7B,MAAAA,EAAE,EAAE;AADO,KAFI;AAKjBW,IAAAA,KAAK,EAAE;AACLX,MAAAA,EAAE,EAAE,0BADC;AAELkC,MAAAA,MAAM,EAAE;AAFH;AALU;AAXc,CAAnC;AAuBA/D,mBAAmB,CAACgE,SAApB,GAAgC;AAC9B/D,EAAAA,QAAQ,EAAEgE,sBAAUC,IAAV,CAAeC,UADK;AAE9B/D,EAAAA,eAAe,EAAE6D,sBAAUG,KAFG;AAG9BjE,EAAAA,OAAO,EAAE8D,sBAAUI,KAAV,CAAgB;AACvBnE,IAAAA,MAAM,EAAE+D,sBAAUK,IAAV,CAAeH;AADA,GAAhB,EAENA,UAL2B;AAM9B7D,EAAAA,WAAW,EAAE2D,sBAAUM,MANO;AAO9BlE,EAAAA,MAAM,EAAE4D,sBAAUG,KAPY;AAQ9B7D,EAAAA,cAAc,EAAE0D,sBAAUO,IARI;AAS9BhE,EAAAA,SAAS,EAAEyD,sBAAUO,IAAV,CAAeL,UATI;AAU9B1D,EAAAA,YAAY,EAAEwD,sBAAUM,MAVM;AAW9B7D,EAAAA,IAAI,EAAEuD,sBAAUQ,MAXc;AAY9B9D,EAAAA,QAAQ,EAAEsD,sBAAUK,IAAV,CAAeH,UAZK;AAa9BvD,EAAAA,cAAc,EAAEqD,sBAAUK,IAbI;AAc9BzD,EAAAA,eAAe,EAAEoD,sBAAUK,IAdG;AAe9BxD,EAAAA,oBAAoB,EAAEmD,sBAAUK,IAfF;AAgB9BT,EAAAA,QAAQ,EAAEI,sBAAUK,IAhBU;AAiB9BR,EAAAA,iBAAiB,EAAEG,sBAAUI,KAAV,CAAgB;AACjC9B,IAAAA,OAAO,EAAE0B,sBAAUG,KADc;AAEjCV,IAAAA,WAAW,EAAEO,sBAAUI,KAAV,CAAgB;AAC3BxC,MAAAA,EAAE,EAAEoC,sBAAUQ;AADa,KAAhB,CAFoB;AAKjCjC,IAAAA,KAAK,EAAEyB,sBAAUI,KAAV,CAAgB;AACrBxC,MAAAA,EAAE,EAAEoC,sBAAUQ,MADO;AAErBV,MAAAA,MAAM,EAAEE,sBAAUM;AAFG,KAAhB;AAL0B,GAAhB;AAjBW,CAAhC;;eA6Be,gCAAWvE,mBAAX,C","sourcesContent":["import React, { useState, useMemo } from 'react';\nimport PropTypes from 'prop-types';\nimport { get, isEqual, upperFirst } from 'lodash';\nimport { withRouter } from 'react-router-dom';\nimport { FormattedMessage } from 'react-intl';\nimport { Inputs as Input, Header } from '@buffetjs/custom';\nimport {\n  BackHeader,\n  LoadingIndicatorPage,\n  ModalConfirm,\n  PopUpWarning,\n  // contexts\n  useGlobalContext,\n} from 'strapi-helper-plugin';\nimport pluginId from '../../pluginId';\nimport Block from '../Block';\nimport Container from '../Container';\nimport SectionTitle from '../SectionTitle';\nimport Separator from '../Separator';\n\nconst SettingsViewWrapper = ({\n  children,\n  history: { goBack },\n  displayedFields,\n  inputs,\n  initialData,\n  isEditSettings,\n  isLoading,\n  modifiedData,\n  name,\n  onChange,\n  onConfirmReset,\n  onConfirmSubmit,\n  onModalConfirmClosed,\n}) => {\n  const { emitEvent, formatMessage } = useGlobalContext();\n  const [showWarningCancel, setWarningCancel] = useState(false);\n  const [showWarningSubmit, setWarningSubmit] = useState(false);\n\n  const attributes = useMemo(() => {\n    return get(modifiedData, ['attributes'], {});\n  }, [modifiedData]);\n\n  const toggleWarningCancel = () => setWarningCancel(prevState => !prevState);\n  const toggleWarningSubmit = () => setWarningSubmit(prevState => !prevState);\n\n  const getPluginHeaderActions = () => {\n    return [\n      {\n        color: 'cancel',\n        onClick: toggleWarningCancel,\n        label: formatMessage({\n          id: 'app.components.Button.reset',\n        }),\n        type: 'button',\n        disabled: isEqual(modifiedData, initialData),\n        style: {\n          fontWeight: 600,\n          paddingLeft: 15,\n          paddingRight: 15,\n        },\n      },\n      {\n        color: 'success',\n        label: formatMessage({\n          id: `${pluginId}.containers.Edit.submit`,\n        }),\n        type: 'submit',\n        disabled: isEqual(modifiedData, initialData),\n        style: {\n          minWidth: 150,\n          fontWeight: 600,\n        },\n      },\n    ];\n  };\n\n  const headerProps = {\n    actions: getPluginHeaderActions(),\n    title: {\n      label: formatMessage(\n        {\n          id: `${pluginId}.components.SettingsViewWrapper.pluginHeader.title`,\n        },\n        { name: upperFirst(name) }\n      ),\n    },\n    content: formatMessage({\n      id: `${pluginId}.components.SettingsViewWrapper.pluginHeader.description.${\n        isEditSettings ? 'edit' : 'list'\n      }-settings`,\n    }),\n  };\n\n  const getSelectOptions = input => {\n    if (input.name === 'settings.defaultSortBy') {\n      return [\n        'id',\n        ...displayedFields.filter(name => {\n          const type = get(attributes, [name, 'type']);\n\n          return !['media', 'richtext', 'dynamiczone', 'relation'].includes(type) && name !== 'id';\n        }),\n      ];\n    }\n\n    if (input.name === 'settings.mainField') {\n      const options = Object.keys(attributes).filter(attr => {\n        const type = get(attributes, [attr, 'type'], '');\n\n        return (\n          ![\n            'dynamiczone',\n            'json',\n            'text',\n            'relation',\n            'component',\n            'boolean',\n            'date',\n            'media',\n            'richtext',\n            'timestamp',\n          ].includes(type) && !!type\n        );\n      });\n\n      return options;\n    }\n\n    return input.options;\n  };\n\n  const handleSubmit = e => {\n    e.preventDefault();\n    toggleWarningSubmit();\n    emitEvent('willSaveContentTypeLayout');\n  };\n\n  if (isLoading) {\n    return <LoadingIndicatorPage />;\n  }\n\n  return (\n    <>\n      <BackHeader onClick={goBack} />\n      <Container className=\"container-fluid\">\n        <form onSubmit={handleSubmit}>\n          <Header {...headerProps} />\n          <div\n            className=\"row\"\n            style={{\n              paddingTop: '3px',\n            }}\n          >\n            <Block\n              style={{\n                marginBottom: '13px',\n                paddingBottom: '30px',\n                paddingTop: '24px',\n              }}\n            >\n              <SectionTitle isSettings />\n              <div className=\"row\">\n                {inputs.map(input => {\n                  return (\n                    <FormattedMessage key={input.name} id={input.label.id}>\n                      {label => (\n                        <div className={input.customBootstrapClass}>\n                          <FormattedMessage\n                            id={get(input, 'description.id', 'app.utils.defaultMessage')}\n                          >\n                            {description => (\n                              <Input\n                                {...input}\n                                description={description}\n                                label={label === ' ' ? null : label}\n                                onChange={onChange}\n                                options={getSelectOptions(input)}\n                                value={get(modifiedData, input.name, '')}\n                              />\n                            )}\n                          </FormattedMessage>\n                        </div>\n                      )}\n                    </FormattedMessage>\n                  );\n                })}\n                <div className=\"col-12\">\n                  <Separator style={{ marginBottom: 20 }} />\n                </div>\n              </div>\n              <SectionTitle />\n              {children}\n            </Block>\n          </div>\n          <PopUpWarning\n            isOpen={showWarningCancel}\n            toggleModal={toggleWarningCancel}\n            content={{\n              message: `${pluginId}.popUpWarning.warning.cancelAllSettings`,\n            }}\n            popUpWarningType=\"danger\"\n            onConfirm={() => {\n              onConfirmReset();\n              toggleWarningCancel();\n            }}\n          />\n          <ModalConfirm\n            isOpen={showWarningSubmit}\n            toggle={toggleWarningSubmit}\n            content={{\n              id: `${pluginId}.popUpWarning.warning.updateAllSettings`,\n            }}\n            type=\"success\"\n            onConfirm={async () => {\n              await onConfirmSubmit();\n              toggleWarningSubmit();\n            }}\n            onClosed={() => {\n              if (onModalConfirmClosed) {\n                onModalConfirmClosed();\n              }\n            }}\n          />\n        </form>\n      </Container>\n    </>\n  );\n};\n\nSettingsViewWrapper.defaultProps = {\n  displayedFields: [],\n  inputs: [],\n  initialData: {},\n  isEditSettings: false,\n  modifiedData: {},\n  name: '',\n  onConfirmReset: () => {},\n  onConfirmSubmit: async () => {},\n  onModalConfirmClosed: null,\n  onSubmit: () => {},\n  pluginHeaderProps: {\n    actions: [],\n    description: {\n      id: 'app.utils.defaultMessage',\n    },\n    title: {\n      id: 'app.utils.defaultMessage',\n      values: {},\n    },\n  },\n};\n\nSettingsViewWrapper.propTypes = {\n  children: PropTypes.node.isRequired,\n  displayedFields: PropTypes.array,\n  history: PropTypes.shape({\n    goBack: PropTypes.func.isRequired,\n  }).isRequired,\n  initialData: PropTypes.object,\n  inputs: PropTypes.array,\n  isEditSettings: PropTypes.bool,\n  isLoading: PropTypes.bool.isRequired,\n  modifiedData: PropTypes.object,\n  name: PropTypes.string,\n  onChange: PropTypes.func.isRequired,\n  onConfirmReset: PropTypes.func,\n  onConfirmSubmit: PropTypes.func,\n  onModalConfirmClosed: PropTypes.func,\n  onSubmit: PropTypes.func,\n  pluginHeaderProps: PropTypes.shape({\n    actions: PropTypes.array,\n    description: PropTypes.shape({\n      id: PropTypes.string,\n    }),\n    title: PropTypes.shape({\n      id: PropTypes.string,\n      values: PropTypes.object,\n    }),\n  }),\n};\n\nexport default withRouter(SettingsViewWrapper);\n"]},"metadata":{},"sourceType":"script"}