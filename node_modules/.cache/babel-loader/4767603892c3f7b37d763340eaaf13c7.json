{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _typeof = require(\"@babel/runtime/helpers/typeof\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.RepeatableComponent = exports[\"default\"] = void 0;\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _reactDnd = require(\"react-dnd\");\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _lodash = require(\"lodash\");\n\nvar _reactIntl = require(\"react-intl\");\n\nvar _styles = require(\"@buffetjs/styles\");\n\nvar _pluginId = _interopRequireDefault(require(\"../../pluginId\"));\n\nvar _utils = require(\"../../utils\");\n\nvar _hooks = require(\"../../hooks\");\n\nvar _ItemTypes = _interopRequireDefault(require(\"../../utils/ItemTypes\"));\n\nvar _connect = _interopRequireDefault(require(\"./utils/connect\"));\n\nvar _select = _interopRequireDefault(require(\"./utils/select\"));\n\nvar _AddFieldButton = _interopRequireDefault(require(\"./AddFieldButton\"));\n\nvar _DraggedItem = _interopRequireDefault(require(\"./DraggedItem\"));\n\nvar _EmptyComponent = _interopRequireDefault(require(\"./EmptyComponent\"));\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\n/* eslint-disable import/no-cycle */\nvar RepeatableComponent = function RepeatableComponent(_ref) {\n  var addRepeatableComponentToField = _ref.addRepeatableComponentToField,\n      formErrors = _ref.formErrors,\n      componentUid = _ref.componentUid,\n      componentValue = _ref.componentValue,\n      componentValueLength = _ref.componentValueLength,\n      isNested = _ref.isNested,\n      isReadOnly = _ref.isReadOnly,\n      max = _ref.max,\n      min = _ref.min,\n      name = _ref.name;\n\n  var _useState = (0, _react.useState)(''),\n      _useState2 = (0, _slicedToArray2[\"default\"])(_useState, 2),\n      collapseToOpen = _useState2[0],\n      setCollapseToOpen = _useState2[1];\n\n  var _useDrop = (0, _reactDnd.useDrop)({\n    accept: _ItemTypes[\"default\"].COMPONENT\n  }),\n      _useDrop2 = (0, _slicedToArray2[\"default\"])(_useDrop, 2),\n      drop = _useDrop2[1];\n\n  var _useContentTypeLayout = (0, _hooks.useContentTypeLayout)(),\n      getComponentLayout = _useContentTypeLayout.getComponentLayout;\n\n  var componentLayoutData = (0, _react.useMemo)(function () {\n    return getComponentLayout(componentUid);\n  }, [componentUid, getComponentLayout]);\n  var nextTempKey = (0, _react.useMemo)(function () {\n    return (0, _utils.getMaxTempKey)(componentValue || []) + 1;\n  }, [componentValue]);\n  var componentErrorKeys = Object.keys(formErrors).filter(function (errorKey) {\n    return (0, _lodash.take)(errorKey.split('.'), isNested ? 3 : 1).join('.') === name;\n  }).map(function (errorKey) {\n    return errorKey.split('.').slice(0, name.split('.').length + 1).join('.');\n  });\n\n  var toggleCollapses = function toggleCollapses() {\n    setCollapseToOpen('');\n  };\n\n  var missingComponentsValue = min - componentValueLength;\n  var errorsArray = componentErrorKeys.map(function (key) {\n    return (0, _lodash.get)(formErrors, [key, 'id'], '');\n  });\n  var hasMinError = (0, _lodash.get)(errorsArray, [0], '').includes('min');\n  var handleClick = (0, _react.useCallback)(function () {\n    if (!isReadOnly) {\n      if (componentValueLength < max) {\n        var shouldCheckErrors = hasMinError;\n        addRepeatableComponentToField(name, componentUid, shouldCheckErrors);\n        setCollapseToOpen(nextTempKey);\n      } else if (componentValueLength >= max) {\n        strapi.notification.info(\"\".concat(_pluginId[\"default\"], \".components.notification.info.maximum-requirement\"));\n      }\n    }\n  }, [addRepeatableComponentToField, componentUid, componentValueLength, hasMinError, isReadOnly, max, name, nextTempKey]);\n  return /*#__PURE__*/_react[\"default\"].createElement(\"div\", null, componentValueLength === 0 && /*#__PURE__*/_react[\"default\"].createElement(_EmptyComponent[\"default\"], {\n    hasMinError: hasMinError\n  }, /*#__PURE__*/_react[\"default\"].createElement(_reactIntl.FormattedMessage, {\n    id: \"\".concat(_pluginId[\"default\"], \".components.empty-repeatable\")\n  }, function (msg) {\n    return /*#__PURE__*/_react[\"default\"].createElement(\"p\", null, msg);\n  })), /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n    ref: drop\n  }, componentValueLength > 0 && componentValue.map(function (data, index) {\n    var key = data.__temp_key__;\n    var isOpen = collapseToOpen === key;\n    var componentFieldName = \"\".concat(name, \".\").concat(index);\n    var previousComponentTempKey = (0, _lodash.get)(componentValue, [index - 1, '__temp_key__']);\n    var doesPreviousFieldContainErrorsAndIsOpen = componentErrorKeys.includes(\"\".concat(name, \".\").concat(index - 1)) && index !== 0 && collapseToOpen === previousComponentTempKey;\n    var hasErrors = componentErrorKeys.includes(componentFieldName);\n    return /*#__PURE__*/_react[\"default\"].createElement(_DraggedItem[\"default\"], {\n      componentFieldName: componentFieldName,\n      componentUid: componentUid,\n      doesPreviousFieldContainErrorsAndIsOpen: doesPreviousFieldContainErrorsAndIsOpen,\n      hasErrors: hasErrors,\n      hasMinError: hasMinError,\n      isFirst: index === 0,\n      isReadOnly: isReadOnly,\n      isOpen: isOpen,\n      key: key,\n      onClickToggle: function onClickToggle() {\n        if (isOpen) {\n          setCollapseToOpen('');\n        } else {\n          setCollapseToOpen(key);\n        }\n      },\n      parentName: name,\n      schema: componentLayoutData,\n      toggleCollapses: toggleCollapses\n    });\n  })), /*#__PURE__*/_react[\"default\"].createElement(_AddFieldButton[\"default\"], {\n    hasMinError: hasMinError,\n    disabled: isReadOnly,\n    withBorderRadius: false,\n    doesPreviousFieldContainErrorsAndIsClosed: componentValueLength > 0 && componentErrorKeys.includes(\"\".concat(name, \".\").concat(componentValueLength - 1)) && componentValue[componentValueLength - 1].__temp_key__ !== collapseToOpen,\n    type: \"button\",\n    onClick: handleClick\n  }, /*#__PURE__*/_react[\"default\"].createElement(\"i\", {\n    className: \"fa fa-plus\"\n  }), /*#__PURE__*/_react[\"default\"].createElement(_reactIntl.FormattedMessage, {\n    id: \"\".concat(_pluginId[\"default\"], \".containers.EditView.add.new\")\n  })), hasMinError && /*#__PURE__*/_react[\"default\"].createElement(_styles.ErrorMessage, null, /*#__PURE__*/_react[\"default\"].createElement(_reactIntl.FormattedMessage, {\n    id: \"\".concat(_pluginId[\"default\"], \".components.DynamicZone.missing\").concat(missingComponentsValue > 1 ? '.plural' : '.singular'),\n    values: {\n      count: missingComponentsValue\n    }\n  })));\n};\n\nexports.RepeatableComponent = RepeatableComponent;\nRepeatableComponent.defaultProps = {\n  componentValue: null,\n  componentValueLength: 0,\n  formErrors: {},\n  isNested: false,\n  max: Infinity,\n  min: -Infinity\n};\nRepeatableComponent.propTypes = {\n  addRepeatableComponentToField: _propTypes[\"default\"].func.isRequired,\n  componentUid: _propTypes[\"default\"].string.isRequired,\n  componentValue: _propTypes[\"default\"].oneOfType([_propTypes[\"default\"].array, _propTypes[\"default\"].object]),\n  componentValueLength: _propTypes[\"default\"].number,\n  formErrors: _propTypes[\"default\"].object,\n  isNested: _propTypes[\"default\"].bool,\n  isReadOnly: _propTypes[\"default\"].bool.isRequired,\n  max: _propTypes[\"default\"].number,\n  min: _propTypes[\"default\"].number,\n  name: _propTypes[\"default\"].string.isRequired\n};\nvar Memoized = /*#__PURE__*/(0, _react.memo)(RepeatableComponent);\n\nvar _default = (0, _connect[\"default\"])(Memoized, _select[\"default\"]);\n\nexports[\"default\"] = _default;","map":{"version":3,"sources":["/Users/joaovictorlobao/prefeituramaragogistrapi/.cache/plugins/strapi-plugin-content-manager/admin/src/components/RepeatableComponent/index.js"],"names":["RepeatableComponent","addRepeatableComponentToField","formErrors","componentUid","componentValue","componentValueLength","isNested","isReadOnly","max","min","name","collapseToOpen","setCollapseToOpen","accept","ItemTypes","COMPONENT","drop","getComponentLayout","componentLayoutData","nextTempKey","componentErrorKeys","Object","keys","filter","errorKey","split","join","map","slice","length","toggleCollapses","missingComponentsValue","errorsArray","key","hasMinError","includes","handleClick","shouldCheckErrors","strapi","notification","info","pluginId","msg","data","index","__temp_key__","isOpen","componentFieldName","previousComponentTempKey","doesPreviousFieldContainErrorsAndIsOpen","hasErrors","count","defaultProps","Infinity","propTypes","PropTypes","func","isRequired","string","oneOfType","array","object","number","bool","Memoized","select"],"mappings":"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","sourcesContent":["import React, { memo, useCallback, useMemo, useState } from 'react';\n/* eslint-disable import/no-cycle */\nimport { useDrop } from 'react-dnd';\nimport PropTypes from 'prop-types';\nimport { get, take } from 'lodash';\nimport { FormattedMessage } from 'react-intl';\nimport { ErrorMessage } from '@buffetjs/styles';\nimport pluginId from '../../pluginId';\nimport { getMaxTempKey } from '../../utils';\nimport { useContentTypeLayout } from '../../hooks';\nimport ItemTypes from '../../utils/ItemTypes';\nimport connect from './utils/connect';\nimport select from './utils/select';\nimport Button from './AddFieldButton';\nimport DraggedItem from './DraggedItem';\nimport EmptyComponent from './EmptyComponent';\n\nconst RepeatableComponent = ({\n  addRepeatableComponentToField,\n  formErrors,\n  componentUid,\n  componentValue,\n  componentValueLength,\n  isNested,\n  isReadOnly,\n  max,\n  min,\n  name,\n}) => {\n  const [collapseToOpen, setCollapseToOpen] = useState('');\n  const [, drop] = useDrop({ accept: ItemTypes.COMPONENT });\n  const { getComponentLayout } = useContentTypeLayout();\n  const componentLayoutData = useMemo(() => getComponentLayout(componentUid), [\n    componentUid,\n    getComponentLayout,\n  ]);\n\n  const nextTempKey = useMemo(() => {\n    return getMaxTempKey(componentValue || []) + 1;\n  }, [componentValue]);\n\n  const componentErrorKeys = Object.keys(formErrors)\n    .filter(errorKey => {\n      return take(errorKey.split('.'), isNested ? 3 : 1).join('.') === name;\n    })\n    .map(errorKey => {\n      return errorKey\n        .split('.')\n        .slice(0, name.split('.').length + 1)\n        .join('.');\n    });\n\n  const toggleCollapses = () => {\n    setCollapseToOpen('');\n  };\n  const missingComponentsValue = min - componentValueLength;\n  const errorsArray = componentErrorKeys.map(key => get(formErrors, [key, 'id'], ''));\n\n  const hasMinError = get(errorsArray, [0], '').includes('min');\n\n  const handleClick = useCallback(() => {\n    if (!isReadOnly) {\n      if (componentValueLength < max) {\n        const shouldCheckErrors = hasMinError;\n\n        addRepeatableComponentToField(name, componentUid, shouldCheckErrors);\n\n        setCollapseToOpen(nextTempKey);\n      } else if (componentValueLength >= max) {\n        strapi.notification.info(`${pluginId}.components.notification.info.maximum-requirement`);\n      }\n    }\n  }, [\n    addRepeatableComponentToField,\n    componentUid,\n    componentValueLength,\n    hasMinError,\n    isReadOnly,\n    max,\n    name,\n    nextTempKey,\n  ]);\n\n  return (\n    <div>\n      {componentValueLength === 0 && (\n        <EmptyComponent hasMinError={hasMinError}>\n          <FormattedMessage id={`${pluginId}.components.empty-repeatable`}>\n            {msg => <p>{msg}</p>}\n          </FormattedMessage>\n        </EmptyComponent>\n      )}\n      <div ref={drop}>\n        {componentValueLength > 0 &&\n          componentValue.map((data, index) => {\n            const key = data.__temp_key__;\n            const isOpen = collapseToOpen === key;\n            const componentFieldName = `${name}.${index}`;\n            const previousComponentTempKey = get(componentValue, [index - 1, '__temp_key__']);\n            const doesPreviousFieldContainErrorsAndIsOpen =\n              componentErrorKeys.includes(`${name}.${index - 1}`) &&\n              index !== 0 &&\n              collapseToOpen === previousComponentTempKey;\n\n            const hasErrors = componentErrorKeys.includes(componentFieldName);\n\n            return (\n              <DraggedItem\n                componentFieldName={componentFieldName}\n                componentUid={componentUid}\n                doesPreviousFieldContainErrorsAndIsOpen={doesPreviousFieldContainErrorsAndIsOpen}\n                hasErrors={hasErrors}\n                hasMinError={hasMinError}\n                isFirst={index === 0}\n                isReadOnly={isReadOnly}\n                isOpen={isOpen}\n                key={key}\n                onClickToggle={() => {\n                  if (isOpen) {\n                    setCollapseToOpen('');\n                  } else {\n                    setCollapseToOpen(key);\n                  }\n                }}\n                parentName={name}\n                schema={componentLayoutData}\n                toggleCollapses={toggleCollapses}\n              />\n            );\n          })}\n      </div>\n      <Button\n        hasMinError={hasMinError}\n        disabled={isReadOnly}\n        withBorderRadius={false}\n        doesPreviousFieldContainErrorsAndIsClosed={\n          componentValueLength > 0 &&\n          componentErrorKeys.includes(`${name}.${componentValueLength - 1}`) &&\n          componentValue[componentValueLength - 1].__temp_key__ !== collapseToOpen\n        }\n        type=\"button\"\n        onClick={handleClick}\n      >\n        <i className=\"fa fa-plus\" />\n        <FormattedMessage id={`${pluginId}.containers.EditView.add.new`} />\n      </Button>\n      {hasMinError && (\n        <ErrorMessage>\n          <FormattedMessage\n            id={`${pluginId}.components.DynamicZone.missing${\n              missingComponentsValue > 1 ? '.plural' : '.singular'\n            }`}\n            values={{ count: missingComponentsValue }}\n          />\n        </ErrorMessage>\n      )}\n    </div>\n  );\n};\n\nRepeatableComponent.defaultProps = {\n  componentValue: null,\n  componentValueLength: 0,\n  formErrors: {},\n  isNested: false,\n  max: Infinity,\n  min: -Infinity,\n};\n\nRepeatableComponent.propTypes = {\n  addRepeatableComponentToField: PropTypes.func.isRequired,\n  componentUid: PropTypes.string.isRequired,\n  componentValue: PropTypes.oneOfType([PropTypes.array, PropTypes.object]),\n  componentValueLength: PropTypes.number,\n  formErrors: PropTypes.object,\n  isNested: PropTypes.bool,\n  isReadOnly: PropTypes.bool.isRequired,\n  max: PropTypes.number,\n  min: PropTypes.number,\n  name: PropTypes.string.isRequired,\n};\n\nconst Memoized = memo(RepeatableComponent);\n\nexport default connect(Memoized, select);\n\nexport { RepeatableComponent };\n"]},"metadata":{},"sourceType":"script"}