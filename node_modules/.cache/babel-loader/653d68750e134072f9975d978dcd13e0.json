{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _typeof = require(\"@babel/runtime/helpers/typeof\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.mapDispatchToProps = mapDispatchToProps;\nexports[\"default\"] = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _reactRedux = require(\"react-redux\");\n\nvar _redux = require(\"redux\");\n\nvar _lodash = require(\"lodash\");\n\nvar _reactIntl = require(\"react-intl\");\n\nvar _reactRouterDom = require(\"react-router-dom\");\n\nvar _custom = require(\"@buffetjs/custom\");\n\nvar _core = require(\"@buffetjs/core\");\n\nvar _reactFastCompare = _interopRequireDefault(require(\"react-fast-compare\"));\n\nvar _qs = require(\"qs\");\n\nvar _strapiHelperPlugin = require(\"strapi-helper-plugin\");\n\nvar _pluginId = _interopRequireDefault(require(\"../../pluginId\"));\n\nvar _permissions = _interopRequireDefault(require(\"../../permissions\"));\n\nvar _utils = require(\"../../utils\");\n\nvar _Container = _interopRequireDefault(require(\"../../components/Container\"));\n\nvar _CustomTable = _interopRequireDefault(require(\"../../components/CustomTable\"));\n\nvar _FilterPicker = _interopRequireDefault(require(\"../../components/FilterPicker\"));\n\nvar _Search = _interopRequireDefault(require(\"../../components/Search\"));\n\nvar _ListViewProvider = _interopRequireDefault(require(\"../ListViewProvider\"));\n\nvar _components = require(\"./components\");\n\nvar _FieldPicker = _interopRequireDefault(require(\"./FieldPicker\"));\n\nvar _Filter = _interopRequireDefault(require(\"./Filter\"));\n\nvar _Footer = _interopRequireDefault(require(\"./Footer\"));\n\nvar _actions = require(\"./actions\");\n\nvar _selectors = _interopRequireDefault(require(\"./selectors\"));\n\nvar _utils2 = require(\"./utils\");\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\n/* eslint-disable react/no-array-index-key */\nfunction ListView(_ref) {\n  var canCreate = _ref.canCreate,\n      canDelete = _ref.canDelete,\n      canRead = _ref.canRead,\n      canUpdate = _ref.canUpdate,\n      didDeleteData = _ref.didDeleteData,\n      entriesToDelete = _ref.entriesToDelete,\n      onChangeBulk = _ref.onChangeBulk,\n      onChangeBulkSelectall = _ref.onChangeBulkSelectall,\n      onDeleteDataError = _ref.onDeleteDataError,\n      onDeleteDataSucceeded = _ref.onDeleteDataSucceeded,\n      onDeleteSeveralDataSucceeded = _ref.onDeleteSeveralDataSucceeded,\n      setModalLoadingState = _ref.setModalLoadingState,\n      showWarningDelete = _ref.showWarningDelete,\n      showModalConfirmButtonLoading = _ref.showModalConfirmButtonLoading,\n      showWarningDeleteAll = _ref.showWarningDeleteAll,\n      toggleModalDelete = _ref.toggleModalDelete,\n      toggleModalDeleteAll = _ref.toggleModalDeleteAll,\n      data = _ref.data,\n      displayedHeaders = _ref.displayedHeaders,\n      getData = _ref.getData,\n      getDataSucceeded = _ref.getDataSucceeded,\n      isLoading = _ref.isLoading,\n      layout = _ref.layout,\n      onChangeListHeaders = _ref.onChangeListHeaders,\n      onResetListHeaders = _ref.onResetListHeaders,\n      total = _ref.pagination.total,\n      slug = _ref.slug;\n  var _layout$contentType = layout.contentType,\n      attributes = _layout$contentType.attributes,\n      metadatas = _layout$contentType.metadatas,\n      _layout$contentType$s = _layout$contentType.settings,\n      isBulkable = _layout$contentType$s.bulkable,\n      isFilterable = _layout$contentType$s.filterable,\n      isSearchable = _layout$contentType$s.searchable;\n\n  var _useGlobalContext = (0, _strapiHelperPlugin.useGlobalContext)(),\n      emitEvent = _useGlobalContext.emitEvent;\n\n  var _useUser = (0, _strapiHelperPlugin.useUser)(),\n      fetchUserPermissions = _useUser.fetchUserPermissions;\n\n  var emitEventRef = (0, _react.useRef)(emitEvent);\n  var fetchPermissionsRef = (0, _react.useRef)(fetchUserPermissions);\n\n  var _useQueryParams = (0, _strapiHelperPlugin.useQueryParams)(),\n      _useQueryParams2 = (0, _slicedToArray2[\"default\"])(_useQueryParams, 2),\n      query = _useQueryParams2[0].query,\n      setQuery = _useQueryParams2[1];\n\n  var params = (0, _utils2.buildQueryString)(query);\n\n  var _useLocation = (0, _reactRouterDom.useLocation)(),\n      pathname = _useLocation.pathname;\n\n  var _useHistory = (0, _reactRouterDom.useHistory)(),\n      push = _useHistory.push;\n\n  var _useIntl = (0, _reactIntl.useIntl)(),\n      formatMessage = _useIntl.formatMessage;\n\n  var _useState = (0, _react.useState)(false),\n      _useState2 = (0, _slicedToArray2[\"default\"])(_useState, 2),\n      isFilterPickerOpen = _useState2[0],\n      setFilterPickerState = _useState2[1];\n\n  var _useState3 = (0, _react.useState)(null),\n      _useState4 = (0, _slicedToArray2[\"default\"])(_useState3, 2),\n      idToDelete = _useState4[0],\n      setIdToDelete = _useState4[1];\n\n  var contentType = layout.contentType;\n  var hasDraftAndPublish = (0, _lodash.get)(contentType, 'options.draftAndPublish', false);\n  var allAllowedHeaders = (0, _react.useMemo)(function () {\n    return (0, _utils2.getAllAllowedHeaders)(attributes);\n  }, [attributes]);\n  var filters = (0, _react.useMemo)(function () {\n    return (0, _utils.formatFiltersFromQuery)(query);\n  }, [query]);\n  var _sort = query._sort;\n\n  var _q = query._q || '';\n\n  var label = contentType.info.label;\n  var firstSortableHeader = (0, _react.useMemo)(function () {\n    return (0, _utils2.getFirstSortableHeader)(displayedHeaders);\n  }, [displayedHeaders]);\n  (0, _react.useEffect)(function () {\n    setFilterPickerState(false);\n  }, []); // Using a ref to avoid requests being fired multiple times on slug on change\n  // We need it because the hook as mulitple dependencies so it may run before the permissions have checked\n\n  var requestUrlRef = (0, _react.useRef)('');\n  var fetchData = (0, _react.useCallback)( /*#__PURE__*/function () {\n    var _ref2 = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee(endPoint) {\n      var abortSignal,\n          signal,\n          _yield$request,\n          results,\n          pagination,\n          resStatus,\n          _args = arguments;\n\n      return _regenerator[\"default\"].wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              abortSignal = _args.length > 1 && _args[1] !== undefined ? _args[1] : false;\n              getData();\n              signal = abortSignal || new AbortController().signal;\n              _context.prev = 3;\n              _context.next = 6;\n              return (0, _strapiHelperPlugin.request)(endPoint, {\n                method: 'GET',\n                signal: signal\n              });\n\n            case 6:\n              _yield$request = _context.sent;\n              results = _yield$request.results;\n              pagination = _yield$request.pagination;\n              getDataSucceeded(pagination, results);\n              _context.next = 23;\n              break;\n\n            case 12:\n              _context.prev = 12;\n              _context.t0 = _context[\"catch\"](3);\n              resStatus = (0, _lodash.get)(_context.t0, 'response.status', null);\n              console.log(_context.t0);\n\n              if (!(resStatus === 403)) {\n                _context.next = 22;\n                break;\n              }\n\n              _context.next = 19;\n              return fetchPermissionsRef.current();\n\n            case 19:\n              strapi.notification.info((0, _utils.getTrad)('permissions.not-allowed.update'));\n              push('/');\n              return _context.abrupt(\"return\");\n\n            case 22:\n              if (_context.t0.name !== 'AbortError') {\n                console.error(_context.t0);\n                strapi.notification.error((0, _utils.getTrad)('error.model.fetch'));\n              }\n\n            case 23:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[3, 12]]);\n    }));\n\n    return function (_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }(), [getData, getDataSucceeded, push]);\n  var handleChangeListLabels = (0, _react.useCallback)(function (_ref3) {\n    var name = _ref3.name,\n        value = _ref3.value;\n\n    // Display a notification if trying to remove the last displayed field\n    if (value && displayedHeaders.length === 1) {\n      strapi.notification.toggle({\n        type: 'warning',\n        message: {\n          id: 'content-manager.notification.error.displayedFields'\n        }\n      });\n    } else {\n      emitEventRef.current('didChangeDisplayedFields');\n      onChangeListHeaders({\n        name: name,\n        value: value\n      });\n    }\n  }, [displayedHeaders, onChangeListHeaders]);\n  var handleConfirmDeleteAllData = (0, _react.useCallback)( /*#__PURE__*/(0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee2() {\n    return _regenerator[\"default\"].wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.prev = 0;\n            setModalLoadingState();\n            _context2.next = 4;\n            return (0, _strapiHelperPlugin.request)((0, _utils.getRequestUrl)(\"collection-types/\".concat(slug, \"/actions/bulkDelete\")), {\n              method: 'POST',\n              body: {\n                ids: entriesToDelete\n              }\n            });\n\n          case 4:\n            onDeleteSeveralDataSucceeded();\n            emitEventRef.current('didBulkDeleteEntries');\n            _context2.next = 11;\n            break;\n\n          case 8:\n            _context2.prev = 8;\n            _context2.t0 = _context2[\"catch\"](0);\n            strapi.notification.error(\"\".concat(_pluginId[\"default\"], \".error.record.delete\"));\n\n          case 11:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2, null, [[0, 8]]);\n  })), [entriesToDelete, onDeleteSeveralDataSucceeded, slug, setModalLoadingState]);\n  var handleConfirmDeleteData = (0, _react.useCallback)( /*#__PURE__*/(0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee3() {\n    var trackerProperty, dataToDelete, isDraftEntry, status, errorMessage;\n    return _regenerator[\"default\"].wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _context3.prev = 0;\n            trackerProperty = {};\n\n            if (hasDraftAndPublish) {\n              dataToDelete = data.find(function (obj) {\n                return obj.id.toString() === idToDelete.toString();\n              });\n              isDraftEntry = (0, _lodash.isEmpty)(dataToDelete.published_at);\n              status = isDraftEntry ? 'draft' : 'published';\n              trackerProperty = {\n                status: status\n              };\n            }\n\n            emitEventRef.current('willDeleteEntry', trackerProperty);\n            setModalLoadingState();\n            _context3.next = 7;\n            return (0, _strapiHelperPlugin.request)((0, _utils.getRequestUrl)(\"collection-types/\".concat(slug, \"/\").concat(idToDelete)), {\n              method: 'DELETE'\n            });\n\n          case 7:\n            strapi.notification.toggle({\n              type: 'success',\n              message: {\n                id: \"\".concat(_pluginId[\"default\"], \".success.record.delete\")\n              }\n            }); // Close the modal and refetch data\n\n            onDeleteDataSucceeded();\n            emitEventRef.current('didDeleteEntry', trackerProperty);\n            _context3.next = 17;\n            break;\n\n          case 12:\n            _context3.prev = 12;\n            _context3.t0 = _context3[\"catch\"](0);\n            errorMessage = (0, _lodash.get)(_context3.t0, 'response.payload.message', formatMessage({\n              id: \"\".concat(_pluginId[\"default\"], \".error.record.delete\")\n            }));\n            strapi.notification.toggle({\n              type: 'warning',\n              message: errorMessage\n            }); // Close the modal\n\n            onDeleteDataError();\n\n          case 17:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3, null, [[0, 12]]);\n  })), [hasDraftAndPublish, setModalLoadingState, slug, idToDelete, onDeleteDataSucceeded, data, formatMessage, onDeleteDataError]);\n  (0, _react.useEffect)(function () {\n    var abortController = new AbortController();\n    var signal = abortController.signal;\n    var shouldSendRequest = canRead;\n    var requestUrl = \"/\".concat(_pluginId[\"default\"], \"/collection-types/\").concat(slug).concat(params);\n\n    if (shouldSendRequest && requestUrl.includes(requestUrlRef.current)) {\n      fetchData(requestUrl, signal);\n    }\n\n    return function () {\n      requestUrlRef.current = slug;\n      abortController.abort();\n    };\n  }, [canRead, getData, slug, params, getDataSucceeded, fetchData]);\n\n  var handleClickDelete = function handleClickDelete(id) {\n    setIdToDelete(id);\n    toggleModalDelete();\n  };\n\n  var handleModalClose = (0, _react.useCallback)(function () {\n    if (didDeleteData) {\n      var requestUrl = \"/\".concat(_pluginId[\"default\"], \"/collection-types/\").concat(slug).concat(params);\n      fetchData(requestUrl);\n    }\n  }, [fetchData, didDeleteData, slug, params]);\n  var toggleFilterPickerState = (0, _react.useCallback)(function () {\n    setFilterPickerState(function (prevState) {\n      if (!prevState) {\n        emitEventRef.current('willFilterEntries');\n      }\n\n      return !prevState;\n    });\n  }, []);\n  var headerAction = (0, _react.useMemo)(function () {\n    if (!canCreate) {\n      return [];\n    }\n\n    return [{\n      label: formatMessage({\n        id: 'content-manager.containers.List.addAnEntry'\n      }, {\n        entity: label || 'Content Manager'\n      }),\n      onClick: function onClick() {\n        var trackerProperty = hasDraftAndPublish ? {\n          status: 'draft'\n        } : {};\n        emitEventRef.current('willCreateEntry', trackerProperty);\n        push({\n          pathname: \"\".concat(pathname, \"/create\"),\n          search: query.plugins ? (0, _qs.stringify)({\n            plugins: query.plugins\n          }, {\n            encode: false\n          }) : ''\n        });\n      },\n      color: 'primary',\n      type: 'button',\n      icon: true,\n      style: {\n        paddingLeft: 15,\n        paddingRight: 15,\n        fontWeight: 600\n      }\n    }];\n  }, [label, pathname, canCreate, formatMessage, hasDraftAndPublish, push, query]);\n  var headerProps = (0, _react.useMemo)(function () {\n    /* eslint-disable indent */\n    return {\n      title: {\n        label: label || 'Content Manager'\n      },\n      content: canRead ? formatMessage({\n        id: total > 1 ? \"\".concat(_pluginId[\"default\"], \".containers.List.pluginHeaderDescription\") : \"\".concat(_pluginId[\"default\"], \".containers.List.pluginHeaderDescription.singular\")\n      }, {\n        label: total\n      }) : null,\n      actions: headerAction\n    };\n  }, [total, headerAction, label, canRead, formatMessage]);\n\n  var handleToggleModalDeleteAll = function handleToggleModalDeleteAll(e) {\n    emitEventRef.current('willBulkDeleteEntries');\n    toggleModalDeleteAll(e);\n  };\n\n  return /*#__PURE__*/_react[\"default\"].createElement(_react[\"default\"].Fragment, null, /*#__PURE__*/_react[\"default\"].createElement(_ListViewProvider[\"default\"], {\n    _q: _q,\n    _sort: _sort,\n    data: data,\n    entriesToDelete: entriesToDelete,\n    filters: filters,\n    firstSortableHeader: firstSortableHeader,\n    label: label,\n    onChangeBulk: onChangeBulk,\n    onChangeBulkSelectall: onChangeBulkSelectall,\n    onClickDelete: handleClickDelete,\n    slug: slug,\n    toggleModalDeleteAll: handleToggleModalDeleteAll,\n    setQuery: setQuery\n  }, /*#__PURE__*/_react[\"default\"].createElement(_FilterPicker[\"default\"], {\n    contentType: contentType,\n    filters: filters,\n    isOpen: isFilterPickerOpen,\n    metadatas: metadatas,\n    name: label,\n    toggleFilterPickerState: toggleFilterPickerState,\n    setQuery: setQuery,\n    slug: slug\n  }), /*#__PURE__*/_react[\"default\"].createElement(_Container[\"default\"], {\n    className: \"container-fluid\"\n  }, !isFilterPickerOpen && /*#__PURE__*/_react[\"default\"].createElement(_custom.Header, (0, _extends2[\"default\"])({}, headerProps, {\n    isLoading: isLoading && canRead\n  })), isSearchable && canRead && /*#__PURE__*/_react[\"default\"].createElement(_Search[\"default\"], {\n    changeParams: setQuery,\n    initValue: _q,\n    model: label,\n    value: _q\n  }), !canRead && /*#__PURE__*/_react[\"default\"].createElement(_core.Flex, {\n    justifyContent: \"flex-end\"\n  }, /*#__PURE__*/_react[\"default\"].createElement(_core.Padded, {\n    right: true,\n    size: \"sm\"\n  }, /*#__PURE__*/_react[\"default\"].createElement(_strapiHelperPlugin.InjectionZone, {\n    area: \"\".concat(_pluginId[\"default\"], \".listView.actions\")\n  }))), canRead && /*#__PURE__*/_react[\"default\"].createElement(_components.Wrapper, null, /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n    className: \"row\",\n    style: {\n      marginBottom: '5px'\n    }\n  }, /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n    className: \"col-9\"\n  }, /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n    className: \"row\",\n    style: {\n      marginLeft: 0,\n      marginRight: 0\n    }\n  }, isFilterable && /*#__PURE__*/_react[\"default\"].createElement(_react[\"default\"].Fragment, null, /*#__PURE__*/_react[\"default\"].createElement(_components.AddFilterCta, {\n    type: \"button\",\n    onClick: toggleFilterPickerState\n  }, /*#__PURE__*/_react[\"default\"].createElement(_components.FilterIcon, null), /*#__PURE__*/_react[\"default\"].createElement(_reactIntl.FormattedMessage, {\n    id: \"app.utils.filters\"\n  })), filters.map(function (_ref6, key) {\n    var filterName = _ref6.filter,\n        name = _ref6.name,\n        value = _ref6.value;\n    return /*#__PURE__*/_react[\"default\"].createElement(_Filter[\"default\"], {\n      contentType: contentType,\n      filterName: filterName,\n      filters: filters,\n      index: key,\n      key: key,\n      metadatas: metadatas,\n      name: name,\n      toggleFilterPickerState: toggleFilterPickerState,\n      isFilterPickerOpen: isFilterPickerOpen,\n      setQuery: setQuery,\n      value: value\n    });\n  })))), /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n    className: \"col-3\"\n  }, /*#__PURE__*/_react[\"default\"].createElement(_core.Flex, {\n    justifyContent: \"flex-end\"\n  }, /*#__PURE__*/_react[\"default\"].createElement(_core.Padded, {\n    right: true,\n    size: \"sm\"\n  }, /*#__PURE__*/_react[\"default\"].createElement(_strapiHelperPlugin.InjectionZone, {\n    area: \"\".concat(_pluginId[\"default\"], \".listView.actions\")\n  })), /*#__PURE__*/_react[\"default\"].createElement(_strapiHelperPlugin.CheckPermissions, {\n    permissions: _permissions[\"default\"].collectionTypesConfigurations\n  }, /*#__PURE__*/_react[\"default\"].createElement(_FieldPicker[\"default\"], {\n    displayedHeaders: displayedHeaders,\n    items: allAllowedHeaders,\n    onChange: handleChangeListLabels,\n    onClickReset: onResetListHeaders,\n    slug: slug\n  }))))), /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n    className: \"row\",\n    style: {\n      paddingTop: '12px'\n    }\n  }, /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n    className: \"col-12\"\n  }, /*#__PURE__*/_react[\"default\"].createElement(_CustomTable[\"default\"], {\n    data: data,\n    canCreate: canCreate,\n    canDelete: canDelete,\n    canUpdate: canUpdate,\n    displayedHeaders: displayedHeaders,\n    hasDraftAndPublish: hasDraftAndPublish,\n    isBulkable: isBulkable,\n    setQuery: setQuery,\n    showLoader: isLoading\n  }), /*#__PURE__*/_react[\"default\"].createElement(_Footer[\"default\"], {\n    count: total,\n    params: query,\n    onChange: setQuery\n  }))))), /*#__PURE__*/_react[\"default\"].createElement(_strapiHelperPlugin.PopUpWarning, {\n    isOpen: showWarningDelete,\n    toggleModal: toggleModalDelete,\n    content: {\n      message: (0, _utils.getTrad)('popUpWarning.bodyMessage.contentType.delete')\n    },\n    onConfirm: handleConfirmDeleteData,\n    popUpWarningType: \"danger\",\n    onClosed: handleModalClose,\n    isConfirmButtonLoading: showModalConfirmButtonLoading\n  }, /*#__PURE__*/_react[\"default\"].createElement(_strapiHelperPlugin.InjectionZoneList, {\n    area: \"\".concat(_pluginId[\"default\"], \".listView.deleteModalAdditionalInfos\")\n  })), /*#__PURE__*/_react[\"default\"].createElement(_strapiHelperPlugin.PopUpWarning, {\n    isOpen: showWarningDeleteAll,\n    toggleModal: toggleModalDeleteAll,\n    content: {\n      message: (0, _utils.getTrad)(\"popUpWarning.bodyMessage.contentType.delete\".concat(entriesToDelete.length > 1 ? '.all' : ''))\n    },\n    popUpWarningType: \"danger\",\n    onConfirm: handleConfirmDeleteAllData,\n    onClosed: handleModalClose,\n    isConfirmButtonLoading: showModalConfirmButtonLoading\n  }, /*#__PURE__*/_react[\"default\"].createElement(_strapiHelperPlugin.InjectionZoneList, {\n    area: \"\".concat(_pluginId[\"default\"], \".listView.deleteModalAdditionalInfos\")\n  }))));\n}\n\nListView.defaultProps = {\n  permissions: []\n};\nListView.propTypes = {\n  canCreate: _propTypes[\"default\"].bool.isRequired,\n  canDelete: _propTypes[\"default\"].bool.isRequired,\n  canRead: _propTypes[\"default\"].bool.isRequired,\n  canUpdate: _propTypes[\"default\"].bool.isRequired,\n  displayedHeaders: _propTypes[\"default\"].array.isRequired,\n  data: _propTypes[\"default\"].array.isRequired,\n  didDeleteData: _propTypes[\"default\"].bool.isRequired,\n  entriesToDelete: _propTypes[\"default\"].array.isRequired,\n  layout: _propTypes[\"default\"].exact({\n    components: _propTypes[\"default\"].object.isRequired,\n    contentType: _propTypes[\"default\"].shape({\n      attributes: _propTypes[\"default\"].object.isRequired,\n      metadatas: _propTypes[\"default\"].object.isRequired,\n      info: _propTypes[\"default\"].shape({\n        label: _propTypes[\"default\"].string.isRequired\n      }).isRequired,\n      layouts: _propTypes[\"default\"].shape({\n        list: _propTypes[\"default\"].array.isRequired,\n        editRelations: _propTypes[\"default\"].array\n      }).isRequired,\n      options: _propTypes[\"default\"].object.isRequired,\n      settings: _propTypes[\"default\"].object.isRequired\n    }).isRequired\n  }).isRequired,\n  isLoading: _propTypes[\"default\"].bool.isRequired,\n  getData: _propTypes[\"default\"].func.isRequired,\n  getDataSucceeded: _propTypes[\"default\"].func.isRequired,\n  onChangeBulk: _propTypes[\"default\"].func.isRequired,\n  onChangeBulkSelectall: _propTypes[\"default\"].func.isRequired,\n  onChangeListHeaders: _propTypes[\"default\"].func.isRequired,\n  onDeleteDataError: _propTypes[\"default\"].func.isRequired,\n  onDeleteDataSucceeded: _propTypes[\"default\"].func.isRequired,\n  onDeleteSeveralDataSucceeded: _propTypes[\"default\"].func.isRequired,\n  onResetListHeaders: _propTypes[\"default\"].func.isRequired,\n  pagination: _propTypes[\"default\"].shape({\n    total: _propTypes[\"default\"].number.isRequired\n  }).isRequired,\n  setModalLoadingState: _propTypes[\"default\"].func.isRequired,\n  showModalConfirmButtonLoading: _propTypes[\"default\"].bool.isRequired,\n  showWarningDelete: _propTypes[\"default\"].bool.isRequired,\n  showWarningDeleteAll: _propTypes[\"default\"].bool.isRequired,\n  slug: _propTypes[\"default\"].string.isRequired,\n  toggleModalDelete: _propTypes[\"default\"].func.isRequired,\n  toggleModalDeleteAll: _propTypes[\"default\"].func.isRequired,\n  setLayout: _propTypes[\"default\"].func.isRequired,\n  permissions: _propTypes[\"default\"].arrayOf(_propTypes[\"default\"].shape({\n    action: _propTypes[\"default\"].string.isRequired,\n    subject: _propTypes[\"default\"].string.isRequired,\n    properties: _propTypes[\"default\"].object,\n    conditions: _propTypes[\"default\"].arrayOf(_propTypes[\"default\"].string)\n  }))\n};\nvar mapStateToProps = (0, _selectors[\"default\"])();\n\nfunction mapDispatchToProps(dispatch) {\n  return (0, _redux.bindActionCreators)({\n    getData: _actions.getData,\n    getDataSucceeded: _actions.getDataSucceeded,\n    onChangeBulk: _actions.onChangeBulk,\n    onChangeBulkSelectall: _actions.onChangeBulkSelectall,\n    onChangeListHeaders: _actions.onChangeListHeaders,\n    onDeleteDataError: _actions.onDeleteDataError,\n    onDeleteDataSucceeded: _actions.onDeleteDataSucceeded,\n    onDeleteSeveralDataSucceeded: _actions.onDeleteSeveralDataSucceeded,\n    onResetListHeaders: _actions.onResetListHeaders,\n    setModalLoadingState: _actions.setModalLoadingState,\n    toggleModalDelete: _actions.toggleModalDelete,\n    toggleModalDeleteAll: _actions.toggleModalDeleteAll,\n    setLayout: _actions.setLayout\n  }, dispatch);\n}\n\nvar withConnect = (0, _reactRedux.connect)(mapStateToProps, mapDispatchToProps);\n\nvar _default = (0, _redux.compose)(withConnect)( /*#__PURE__*/(0, _react.memo)(ListView, _reactFastCompare[\"default\"]));\n\nexports[\"default\"] = _default;","map":{"version":3,"sources":["/Users/joaovictorlobao/prefeituramaragogistrapi/.cache/plugins/strapi-plugin-content-manager/admin/src/containers/ListView/index.js"],"names":["ListView","canCreate","canDelete","canRead","canUpdate","didDeleteData","entriesToDelete","onChangeBulk","onChangeBulkSelectall","onDeleteDataError","onDeleteDataSucceeded","onDeleteSeveralDataSucceeded","setModalLoadingState","showWarningDelete","showModalConfirmButtonLoading","showWarningDeleteAll","toggleModalDelete","toggleModalDeleteAll","data","displayedHeaders","getData","getDataSucceeded","isLoading","layout","onChangeListHeaders","onResetListHeaders","total","pagination","slug","contentType","attributes","metadatas","settings","isBulkable","bulkable","isFilterable","filterable","isSearchable","searchable","emitEvent","fetchUserPermissions","emitEventRef","fetchPermissionsRef","query","setQuery","params","pathname","push","formatMessage","isFilterPickerOpen","setFilterPickerState","idToDelete","setIdToDelete","hasDraftAndPublish","allAllowedHeaders","filters","_sort","_q","label","info","firstSortableHeader","requestUrlRef","fetchData","endPoint","abortSignal","signal","AbortController","method","results","resStatus","console","log","current","strapi","notification","name","error","handleChangeListLabels","value","length","toggle","type","message","id","handleConfirmDeleteAllData","body","ids","pluginId","handleConfirmDeleteData","trackerProperty","dataToDelete","find","obj","toString","isDraftEntry","published_at","status","errorMessage","abortController","shouldSendRequest","requestUrl","includes","abort","handleClickDelete","handleModalClose","toggleFilterPickerState","prevState","headerAction","entity","onClick","search","plugins","encode","color","icon","style","paddingLeft","paddingRight","fontWeight","headerProps","title","content","actions","handleToggleModalDeleteAll","e","marginBottom","marginLeft","marginRight","map","key","filterName","filter","pluginPermissions","collectionTypesConfigurations","paddingTop","defaultProps","permissions","propTypes","PropTypes","bool","isRequired","array","exact","components","object","shape","string","layouts","list","editRelations","options","func","number","setLayout","arrayOf","action","subject","properties","conditions","mapStateToProps","mapDispatchToProps","dispatch","withConnect","isEqual"],"mappings":"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","sourcesContent":["import React, { memo, useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { bindActionCreators, compose } from 'redux';\nimport { get, isEmpty } from 'lodash';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { useHistory, useLocation } from 'react-router-dom';\nimport { Header } from '@buffetjs/custom';\nimport { Flex, Padded } from '@buffetjs/core';\nimport isEqual from 'react-fast-compare';\nimport { stringify } from 'qs';\nimport {\n  CheckPermissions,\n  InjectionZone,\n  InjectionZoneList,\n  PopUpWarning,\n  useGlobalContext,\n  useQueryParams,\n  useUser,\n  request,\n} from 'strapi-helper-plugin';\nimport pluginId from '../../pluginId';\nimport pluginPermissions from '../../permissions';\nimport { formatFiltersFromQuery, getRequestUrl, getTrad } from '../../utils';\nimport Container from '../../components/Container';\nimport CustomTable from '../../components/CustomTable';\nimport FilterPicker from '../../components/FilterPicker';\nimport Search from '../../components/Search';\nimport ListViewProvider from '../ListViewProvider';\nimport { AddFilterCta, FilterIcon, Wrapper } from './components';\nimport FieldPicker from './FieldPicker';\nimport Filter from './Filter';\nimport Footer from './Footer';\nimport {\n  getData,\n  getDataSucceeded,\n  onChangeBulk,\n  onChangeBulkSelectall,\n  onDeleteDataError,\n  onDeleteDataSucceeded,\n  onDeleteSeveralDataSucceeded,\n  setModalLoadingState,\n  toggleModalDelete,\n  toggleModalDeleteAll,\n  setLayout,\n  onChangeListHeaders,\n  onResetListHeaders,\n} from './actions';\nimport makeSelectListView from './selectors';\nimport { getAllAllowedHeaders, getFirstSortableHeader, buildQueryString } from './utils';\n\n/* eslint-disable react/no-array-index-key */\nfunction ListView({\n  canCreate,\n  canDelete,\n  canRead,\n  canUpdate,\n  didDeleteData,\n  entriesToDelete,\n  onChangeBulk,\n  onChangeBulkSelectall,\n  onDeleteDataError,\n  onDeleteDataSucceeded,\n  onDeleteSeveralDataSucceeded,\n  setModalLoadingState,\n  showWarningDelete,\n  showModalConfirmButtonLoading,\n  showWarningDeleteAll,\n  toggleModalDelete,\n  toggleModalDeleteAll,\n  data,\n  displayedHeaders,\n  getData,\n  getDataSucceeded,\n  isLoading,\n  layout,\n  onChangeListHeaders,\n  onResetListHeaders,\n  pagination: { total },\n  slug,\n}) {\n  const {\n    contentType: {\n      attributes,\n      metadatas,\n      settings: { bulkable: isBulkable, filterable: isFilterable, searchable: isSearchable },\n    },\n  } = layout;\n\n  const { emitEvent } = useGlobalContext();\n  const { fetchUserPermissions } = useUser();\n  const emitEventRef = useRef(emitEvent);\n  const fetchPermissionsRef = useRef(fetchUserPermissions);\n\n  const [{ query }, setQuery] = useQueryParams();\n  const params = buildQueryString(query);\n\n  const { pathname } = useLocation();\n  const { push } = useHistory();\n  const { formatMessage } = useIntl();\n\n  const [isFilterPickerOpen, setFilterPickerState] = useState(false);\n  const [idToDelete, setIdToDelete] = useState(null);\n  const contentType = layout.contentType;\n  const hasDraftAndPublish = get(contentType, 'options.draftAndPublish', false);\n  const allAllowedHeaders = useMemo(() => getAllAllowedHeaders(attributes), [attributes]);\n\n  const filters = useMemo(() => {\n    return formatFiltersFromQuery(query);\n  }, [query]);\n\n  const _sort = query._sort;\n  const _q = query._q || '';\n\n  const label = contentType.info.label;\n\n  const firstSortableHeader = useMemo(() => getFirstSortableHeader(displayedHeaders), [\n    displayedHeaders,\n  ]);\n\n  useEffect(() => {\n    setFilterPickerState(false);\n  }, []);\n\n  // Using a ref to avoid requests being fired multiple times on slug on change\n  // We need it because the hook as mulitple dependencies so it may run before the permissions have checked\n  const requestUrlRef = useRef('');\n\n  const fetchData = useCallback(\n    async (endPoint, abortSignal = false) => {\n      getData();\n      const signal = abortSignal || new AbortController().signal;\n\n      try {\n        const { results, pagination } = await request(endPoint, { method: 'GET', signal });\n\n        getDataSucceeded(pagination, results);\n      } catch (err) {\n        const resStatus = get(err, 'response.status', null);\n        console.log(err);\n\n        if (resStatus === 403) {\n          await fetchPermissionsRef.current();\n\n          strapi.notification.info(getTrad('permissions.not-allowed.update'));\n\n          push('/');\n\n          return;\n        }\n\n        if (err.name !== 'AbortError') {\n          console.error(err);\n          strapi.notification.error(getTrad('error.model.fetch'));\n        }\n      }\n    },\n    [getData, getDataSucceeded, push]\n  );\n\n  const handleChangeListLabels = useCallback(\n    ({ name, value }) => {\n      // Display a notification if trying to remove the last displayed field\n\n      if (value && displayedHeaders.length === 1) {\n        strapi.notification.toggle({\n          type: 'warning',\n          message: { id: 'content-manager.notification.error.displayedFields' },\n        });\n      } else {\n        emitEventRef.current('didChangeDisplayedFields');\n\n        onChangeListHeaders({ name, value });\n      }\n    },\n    [displayedHeaders, onChangeListHeaders]\n  );\n\n  const handleConfirmDeleteAllData = useCallback(async () => {\n    try {\n      setModalLoadingState();\n\n      await request(getRequestUrl(`collection-types/${slug}/actions/bulkDelete`), {\n        method: 'POST',\n        body: { ids: entriesToDelete },\n      });\n\n      onDeleteSeveralDataSucceeded();\n      emitEventRef.current('didBulkDeleteEntries');\n    } catch (err) {\n      strapi.notification.error(`${pluginId}.error.record.delete`);\n    }\n  }, [entriesToDelete, onDeleteSeveralDataSucceeded, slug, setModalLoadingState]);\n\n  const handleConfirmDeleteData = useCallback(async () => {\n    try {\n      let trackerProperty = {};\n\n      if (hasDraftAndPublish) {\n        const dataToDelete = data.find(obj => obj.id.toString() === idToDelete.toString());\n        const isDraftEntry = isEmpty(dataToDelete.published_at);\n        const status = isDraftEntry ? 'draft' : 'published';\n\n        trackerProperty = { status };\n      }\n\n      emitEventRef.current('willDeleteEntry', trackerProperty);\n      setModalLoadingState();\n\n      await request(getRequestUrl(`collection-types/${slug}/${idToDelete}`), {\n        method: 'DELETE',\n      });\n\n      strapi.notification.toggle({\n        type: 'success',\n        message: { id: `${pluginId}.success.record.delete` },\n      });\n\n      // Close the modal and refetch data\n      onDeleteDataSucceeded();\n      emitEventRef.current('didDeleteEntry', trackerProperty);\n    } catch (err) {\n      const errorMessage = get(\n        err,\n        'response.payload.message',\n        formatMessage({ id: `${pluginId}.error.record.delete` })\n      );\n\n      strapi.notification.toggle({\n        type: 'warning',\n        message: errorMessage,\n      });\n      // Close the modal\n      onDeleteDataError();\n    }\n  }, [\n    hasDraftAndPublish,\n    setModalLoadingState,\n    slug,\n    idToDelete,\n    onDeleteDataSucceeded,\n    data,\n    formatMessage,\n    onDeleteDataError,\n  ]);\n\n  useEffect(() => {\n    const abortController = new AbortController();\n    const { signal } = abortController;\n\n    const shouldSendRequest = canRead;\n    const requestUrl = `/${pluginId}/collection-types/${slug}${params}`;\n\n    if (shouldSendRequest && requestUrl.includes(requestUrlRef.current)) {\n      fetchData(requestUrl, signal);\n    }\n\n    return () => {\n      requestUrlRef.current = slug;\n      abortController.abort();\n    };\n  }, [canRead, getData, slug, params, getDataSucceeded, fetchData]);\n\n  const handleClickDelete = id => {\n    setIdToDelete(id);\n    toggleModalDelete();\n  };\n\n  const handleModalClose = useCallback(() => {\n    if (didDeleteData) {\n      const requestUrl = `/${pluginId}/collection-types/${slug}${params}`;\n\n      fetchData(requestUrl);\n    }\n  }, [fetchData, didDeleteData, slug, params]);\n\n  const toggleFilterPickerState = useCallback(() => {\n    setFilterPickerState(prevState => {\n      if (!prevState) {\n        emitEventRef.current('willFilterEntries');\n      }\n\n      return !prevState;\n    });\n  }, []);\n\n  const headerAction = useMemo(() => {\n    if (!canCreate) {\n      return [];\n    }\n\n    return [\n      {\n        label: formatMessage(\n          {\n            id: 'content-manager.containers.List.addAnEntry',\n          },\n          {\n            entity: label || 'Content Manager',\n          }\n        ),\n        onClick: () => {\n          const trackerProperty = hasDraftAndPublish ? { status: 'draft' } : {};\n\n          emitEventRef.current('willCreateEntry', trackerProperty);\n          push({\n            pathname: `${pathname}/create`,\n            search: query.plugins ? stringify({ plugins: query.plugins }, { encode: false }) : '',\n          });\n        },\n        color: 'primary',\n        type: 'button',\n        icon: true,\n        style: {\n          paddingLeft: 15,\n          paddingRight: 15,\n          fontWeight: 600,\n        },\n      },\n    ];\n  }, [label, pathname, canCreate, formatMessage, hasDraftAndPublish, push, query]);\n\n  const headerProps = useMemo(() => {\n    /* eslint-disable indent */\n    return {\n      title: {\n        label: label || 'Content Manager',\n      },\n      content: canRead\n        ? formatMessage(\n            {\n              id:\n                total > 1\n                  ? `${pluginId}.containers.List.pluginHeaderDescription`\n                  : `${pluginId}.containers.List.pluginHeaderDescription.singular`,\n            },\n            { label: total }\n          )\n        : null,\n      actions: headerAction,\n    };\n  }, [total, headerAction, label, canRead, formatMessage]);\n\n  const handleToggleModalDeleteAll = e => {\n    emitEventRef.current('willBulkDeleteEntries');\n    toggleModalDeleteAll(e);\n  };\n\n  return (\n    <>\n      <ListViewProvider\n        _q={_q}\n        _sort={_sort}\n        data={data}\n        entriesToDelete={entriesToDelete}\n        filters={filters}\n        firstSortableHeader={firstSortableHeader}\n        label={label}\n        onChangeBulk={onChangeBulk}\n        onChangeBulkSelectall={onChangeBulkSelectall}\n        onClickDelete={handleClickDelete}\n        slug={slug}\n        toggleModalDeleteAll={handleToggleModalDeleteAll}\n        setQuery={setQuery}\n      >\n        <FilterPicker\n          contentType={contentType}\n          filters={filters}\n          isOpen={isFilterPickerOpen}\n          metadatas={metadatas}\n          name={label}\n          toggleFilterPickerState={toggleFilterPickerState}\n          setQuery={setQuery}\n          slug={slug}\n        />\n        <Container className=\"container-fluid\">\n          {!isFilterPickerOpen && <Header {...headerProps} isLoading={isLoading && canRead} />}\n          {isSearchable && canRead && (\n            <Search changeParams={setQuery} initValue={_q} model={label} value={_q} />\n          )}\n\n          {!canRead && (\n            <Flex justifyContent=\"flex-end\">\n              <Padded right size=\"sm\">\n                <InjectionZone area={`${pluginId}.listView.actions`} />\n              </Padded>\n            </Flex>\n          )}\n\n          {canRead && (\n            <Wrapper>\n              <div className=\"row\" style={{ marginBottom: '5px' }}>\n                <div className=\"col-9\">\n                  <div className=\"row\" style={{ marginLeft: 0, marginRight: 0 }}>\n                    {isFilterable && (\n                      <>\n                        <AddFilterCta type=\"button\" onClick={toggleFilterPickerState}>\n                          <FilterIcon />\n                          <FormattedMessage id=\"app.utils.filters\" />\n                        </AddFilterCta>\n                        {filters.map(({ filter: filterName, name, value }, key) => (\n                          <Filter\n                            contentType={contentType}\n                            filterName={filterName}\n                            filters={filters}\n                            index={key}\n                            key={key}\n                            metadatas={metadatas}\n                            name={name}\n                            toggleFilterPickerState={toggleFilterPickerState}\n                            isFilterPickerOpen={isFilterPickerOpen}\n                            setQuery={setQuery}\n                            value={value}\n                          />\n                        ))}\n                      </>\n                    )}\n                  </div>\n                </div>\n\n                <div className=\"col-3\">\n                  <Flex justifyContent=\"flex-end\">\n                    <Padded right size=\"sm\">\n                      <InjectionZone area={`${pluginId}.listView.actions`} />\n                    </Padded>\n\n                    <CheckPermissions permissions={pluginPermissions.collectionTypesConfigurations}>\n                      <FieldPicker\n                        displayedHeaders={displayedHeaders}\n                        items={allAllowedHeaders}\n                        onChange={handleChangeListLabels}\n                        onClickReset={onResetListHeaders}\n                        slug={slug}\n                      />\n                    </CheckPermissions>\n                  </Flex>\n                </div>\n              </div>\n              <div className=\"row\" style={{ paddingTop: '12px' }}>\n                <div className=\"col-12\">\n                  <CustomTable\n                    data={data}\n                    canCreate={canCreate}\n                    canDelete={canDelete}\n                    canUpdate={canUpdate}\n                    displayedHeaders={displayedHeaders}\n                    hasDraftAndPublish={hasDraftAndPublish}\n                    isBulkable={isBulkable}\n                    setQuery={setQuery}\n                    showLoader={isLoading}\n                  />\n                  <Footer count={total} params={query} onChange={setQuery} />\n                </div>\n              </div>\n            </Wrapper>\n          )}\n        </Container>\n        <PopUpWarning\n          isOpen={showWarningDelete}\n          toggleModal={toggleModalDelete}\n          content={{\n            message: getTrad('popUpWarning.bodyMessage.contentType.delete'),\n          }}\n          onConfirm={handleConfirmDeleteData}\n          popUpWarningType=\"danger\"\n          onClosed={handleModalClose}\n          isConfirmButtonLoading={showModalConfirmButtonLoading}\n        >\n          <InjectionZoneList area={`${pluginId}.listView.deleteModalAdditionalInfos`} />\n        </PopUpWarning>\n        <PopUpWarning\n          isOpen={showWarningDeleteAll}\n          toggleModal={toggleModalDeleteAll}\n          content={{\n            message: getTrad(\n              `popUpWarning.bodyMessage.contentType.delete${\n                entriesToDelete.length > 1 ? '.all' : ''\n              }`\n            ),\n          }}\n          popUpWarningType=\"danger\"\n          onConfirm={handleConfirmDeleteAllData}\n          onClosed={handleModalClose}\n          isConfirmButtonLoading={showModalConfirmButtonLoading}\n        >\n          <InjectionZoneList area={`${pluginId}.listView.deleteModalAdditionalInfos`} />\n        </PopUpWarning>\n      </ListViewProvider>\n    </>\n  );\n}\n\nListView.defaultProps = {\n  permissions: [],\n};\n\nListView.propTypes = {\n  canCreate: PropTypes.bool.isRequired,\n  canDelete: PropTypes.bool.isRequired,\n  canRead: PropTypes.bool.isRequired,\n  canUpdate: PropTypes.bool.isRequired,\n  displayedHeaders: PropTypes.array.isRequired,\n  data: PropTypes.array.isRequired,\n  didDeleteData: PropTypes.bool.isRequired,\n  entriesToDelete: PropTypes.array.isRequired,\n  layout: PropTypes.exact({\n    components: PropTypes.object.isRequired,\n    contentType: PropTypes.shape({\n      attributes: PropTypes.object.isRequired,\n      metadatas: PropTypes.object.isRequired,\n      info: PropTypes.shape({ label: PropTypes.string.isRequired }).isRequired,\n      layouts: PropTypes.shape({\n        list: PropTypes.array.isRequired,\n        editRelations: PropTypes.array,\n      }).isRequired,\n      options: PropTypes.object.isRequired,\n      settings: PropTypes.object.isRequired,\n    }).isRequired,\n  }).isRequired,\n  isLoading: PropTypes.bool.isRequired,\n  getData: PropTypes.func.isRequired,\n  getDataSucceeded: PropTypes.func.isRequired,\n  onChangeBulk: PropTypes.func.isRequired,\n  onChangeBulkSelectall: PropTypes.func.isRequired,\n  onChangeListHeaders: PropTypes.func.isRequired,\n  onDeleteDataError: PropTypes.func.isRequired,\n  onDeleteDataSucceeded: PropTypes.func.isRequired,\n  onDeleteSeveralDataSucceeded: PropTypes.func.isRequired,\n  onResetListHeaders: PropTypes.func.isRequired,\n  pagination: PropTypes.shape({ total: PropTypes.number.isRequired }).isRequired,\n  setModalLoadingState: PropTypes.func.isRequired,\n  showModalConfirmButtonLoading: PropTypes.bool.isRequired,\n  showWarningDelete: PropTypes.bool.isRequired,\n  showWarningDeleteAll: PropTypes.bool.isRequired,\n  slug: PropTypes.string.isRequired,\n  toggleModalDelete: PropTypes.func.isRequired,\n  toggleModalDeleteAll: PropTypes.func.isRequired,\n  setLayout: PropTypes.func.isRequired,\n  permissions: PropTypes.arrayOf(\n    PropTypes.shape({\n      action: PropTypes.string.isRequired,\n      subject: PropTypes.string.isRequired,\n      properties: PropTypes.object,\n      conditions: PropTypes.arrayOf(PropTypes.string),\n    })\n  ),\n};\n\nconst mapStateToProps = makeSelectListView();\n\nexport function mapDispatchToProps(dispatch) {\n  return bindActionCreators(\n    {\n      getData,\n      getDataSucceeded,\n      onChangeBulk,\n      onChangeBulkSelectall,\n      onChangeListHeaders,\n      onDeleteDataError,\n      onDeleteDataSucceeded,\n      onDeleteSeveralDataSucceeded,\n      onResetListHeaders,\n      setModalLoadingState,\n      toggleModalDelete,\n      toggleModalDeleteAll,\n      setLayout,\n    },\n    dispatch\n  );\n}\nconst withConnect = connect(mapStateToProps, mapDispatchToProps);\n\nexport default compose(withConnect)(memo(ListView, isEqual));\n"]},"metadata":{},"sourceType":"script"}