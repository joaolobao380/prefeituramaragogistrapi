{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _typeof = require(\"@babel/runtime/helpers/typeof\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.mapDispatchToProps = mapDispatchToProps;\nexports[\"default\"] = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _reactRedux = require(\"react-redux\");\n\nvar _redux = require(\"redux\");\n\nvar _reactRouterDom = require(\"react-router-dom\");\n\nvar _strapiHelperPlugin = require(\"strapi-helper-plugin\");\n\nvar _reactDnd = require(\"react-dnd\");\n\nvar _reactDndHtml5Backend = _interopRequireDefault(require(\"react-dnd-html5-backend\"));\n\nvar _pluginId = _interopRequireDefault(require(\"../../pluginId\"));\n\nvar _permissions = _interopRequireDefault(require(\"../../permissions\"));\n\nvar _utils = require(\"../../utils\");\n\nvar _DragLayer = _interopRequireDefault(require(\"../../components/DragLayer\"));\n\nvar _CollectionTypeRecursivePath = _interopRequireDefault(require(\"../CollectionTypeRecursivePath\"));\n\nvar _ComponentSetttingsView = _interopRequireDefault(require(\"../ComponentSetttingsView\"));\n\nvar _SingleTypeRecursivePath = _interopRequireDefault(require(\"../SingleTypeRecursivePath\"));\n\nvar _actions = require(\"./actions\");\n\nvar _selectors = _interopRequireDefault(require(\"./selectors\"));\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nfunction Main(_ref) {\n  var getData = _ref.getData,\n      getDataSucceeded = _ref.getDataSucceeded,\n      isLoading = _ref.isLoading,\n      resetProps = _ref.resetProps;\n  (0, _react.useEffect)(function () {\n    var abortController = new AbortController();\n    var signal = abortController.signal;\n\n    var fetchData = /*#__PURE__*/function () {\n      var _ref2 = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee(signal) {\n        var _yield$Promise$all, _yield$Promise$all2, components, models;\n\n        return _regenerator[\"default\"].wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                getData();\n                _context.prev = 1;\n                _context.next = 4;\n                return Promise.all(['components', 'content-types'].map(function (endPoint) {\n                  return (0, _strapiHelperPlugin.request)((0, _utils.getRequestUrl)(endPoint), {\n                    method: 'GET',\n                    signal: signal\n                  });\n                }));\n\n              case 4:\n                _yield$Promise$all = _context.sent;\n                _yield$Promise$all2 = (0, _slicedToArray2[\"default\"])(_yield$Promise$all, 2);\n                components = _yield$Promise$all2[0].data;\n                models = _yield$Promise$all2[1].data;\n                getDataSucceeded(models, components);\n                _context.next = 15;\n                break;\n\n              case 11:\n                _context.prev = 11;\n                _context.t0 = _context[\"catch\"](1);\n                console.error(_context.t0);\n                strapi.notification.error('notification.error');\n\n              case 15:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[1, 11]]);\n      }));\n\n      return function fetchData(_x) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    fetchData(signal);\n    return function () {\n      abortController.abort();\n      resetProps();\n    };\n  }, [getData, getDataSucceeded, resetProps]);\n\n  if (isLoading) {\n    return /*#__PURE__*/_react[\"default\"].createElement(_strapiHelperPlugin.LoadingIndicatorPage, null);\n  }\n\n  return /*#__PURE__*/_react[\"default\"].createElement(_reactDnd.DndProvider, {\n    backend: _reactDndHtml5Backend[\"default\"]\n  }, /*#__PURE__*/_react[\"default\"].createElement(_DragLayer[\"default\"], null), /*#__PURE__*/_react[\"default\"].createElement(_reactRouterDom.Switch, null, /*#__PURE__*/_react[\"default\"].createElement(_reactRouterDom.Route, {\n    path: \"/plugins/\".concat(_pluginId[\"default\"], \"/components/:uid/configurations/edit\")\n  }, /*#__PURE__*/_react[\"default\"].createElement(_strapiHelperPlugin.CheckPagePermissions, {\n    permissions: _permissions[\"default\"].componentsConfigurations\n  }, /*#__PURE__*/_react[\"default\"].createElement(_ComponentSetttingsView[\"default\"], null))), /*#__PURE__*/_react[\"default\"].createElement(_reactRouterDom.Route, {\n    path: \"/plugins/\".concat(_pluginId[\"default\"], \"/collectionType/:slug\"),\n    component: _CollectionTypeRecursivePath[\"default\"]\n  }), /*#__PURE__*/_react[\"default\"].createElement(_reactRouterDom.Route, {\n    path: \"/plugins/\".concat(_pluginId[\"default\"], \"/singleType/:slug\"),\n    component: _SingleTypeRecursivePath[\"default\"]\n  }), /*#__PURE__*/_react[\"default\"].createElement(_reactRouterDom.Route, {\n    path: \"\",\n    component: _strapiHelperPlugin.NotFound\n  })));\n}\n\nMain.propTypes = {\n  getData: _propTypes[\"default\"].func.isRequired,\n  getDataSucceeded: _propTypes[\"default\"].func.isRequired,\n  isLoading: _propTypes[\"default\"].bool.isRequired,\n  resetProps: _propTypes[\"default\"].func.isRequired\n};\nvar mapStateToProps = (0, _selectors[\"default\"])();\n\nfunction mapDispatchToProps(dispatch) {\n  return (0, _redux.bindActionCreators)({\n    getData: _actions.getData,\n    getDataSucceeded: _actions.getDataSucceeded,\n    resetProps: _actions.resetProps\n  }, dispatch);\n}\n\nvar withConnect = (0, _reactRedux.connect)(mapStateToProps, mapDispatchToProps);\n\nvar _default = (0, _redux.compose)(withConnect)(Main);\n\nexports[\"default\"] = _default;","map":{"version":3,"sources":["/Users/joaovictorlobao/prefeituramaragogistrapi/.cache/plugins/strapi-plugin-content-manager/admin/src/containers/Main/index.js"],"names":["Main","getData","getDataSucceeded","isLoading","resetProps","abortController","AbortController","signal","fetchData","Promise","all","map","endPoint","method","components","data","models","console","error","strapi","notification","abort","HTML5Backend","pluginId","pluginPermissions","componentsConfigurations","CollectionTypeRecursivePath","SingleTypeRecursivePath","NotFound","propTypes","PropTypes","func","isRequired","bool","mapStateToProps","mapDispatchToProps","dispatch","withConnect"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { bindActionCreators, compose } from 'redux';\nimport { Switch, Route } from 'react-router-dom';\nimport {\n  CheckPagePermissions,\n  LoadingIndicatorPage,\n  NotFound,\n  request,\n} from 'strapi-helper-plugin';\nimport { DndProvider } from 'react-dnd';\nimport HTML5Backend from 'react-dnd-html5-backend';\nimport pluginId from '../../pluginId';\nimport pluginPermissions from '../../permissions';\nimport { getRequestUrl } from '../../utils';\nimport DragLayer from '../../components/DragLayer';\nimport CollectionTypeRecursivePath from '../CollectionTypeRecursivePath';\nimport ComponentSettingsView from '../ComponentSetttingsView';\nimport SingleTypeRecursivePath from '../SingleTypeRecursivePath';\nimport { getData, getDataSucceeded, resetProps } from './actions';\nimport makeSelectMain from './selectors';\n\nfunction Main({ getData, getDataSucceeded, isLoading, resetProps }) {\n  useEffect(() => {\n    const abortController = new AbortController();\n    const { signal } = abortController;\n\n    const fetchData = async signal => {\n      getData();\n\n      try {\n        const [{ data: components }, { data: models }] = await Promise.all(\n          ['components', 'content-types'].map(endPoint =>\n            request(getRequestUrl(endPoint), { method: 'GET', signal })\n          )\n        );\n\n        getDataSucceeded(models, components);\n      } catch (err) {\n        console.error(err);\n        strapi.notification.error('notification.error');\n      }\n    };\n\n    fetchData(signal);\n\n    return () => {\n      abortController.abort();\n      resetProps();\n    };\n  }, [getData, getDataSucceeded, resetProps]);\n\n  if (isLoading) {\n    return <LoadingIndicatorPage />;\n  }\n\n  return (\n    <DndProvider backend={HTML5Backend}>\n      <DragLayer />\n\n      <Switch>\n        <Route path={`/plugins/${pluginId}/components/:uid/configurations/edit`}>\n          <CheckPagePermissions permissions={pluginPermissions.componentsConfigurations}>\n            <ComponentSettingsView />\n          </CheckPagePermissions>\n        </Route>\n        <Route\n          path={`/plugins/${pluginId}/collectionType/:slug`}\n          component={CollectionTypeRecursivePath}\n        />\n        <Route path={`/plugins/${pluginId}/singleType/:slug`} component={SingleTypeRecursivePath} />\n        <Route path=\"\" component={NotFound} />\n      </Switch>\n    </DndProvider>\n  );\n}\n\nMain.propTypes = {\n  getData: PropTypes.func.isRequired,\n  getDataSucceeded: PropTypes.func.isRequired,\n  isLoading: PropTypes.bool.isRequired,\n  resetProps: PropTypes.func.isRequired,\n};\n\nconst mapStateToProps = makeSelectMain();\n\nexport function mapDispatchToProps(dispatch) {\n  return bindActionCreators(\n    {\n      getData,\n      getDataSucceeded,\n      resetProps,\n    },\n    dispatch\n  );\n}\nconst withConnect = connect(mapStateToProps, mapDispatchToProps);\n\nexport default compose(withConnect)(Main);\n"]},"metadata":{},"sourceType":"script"}