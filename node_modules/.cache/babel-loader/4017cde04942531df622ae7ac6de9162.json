{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _typeof = require(\"@babel/runtime/helpers/typeof\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _reactRouterDom = require(\"react-router-dom\");\n\nvar _reactIntl = require(\"react-intl\");\n\nvar _lodash = require(\"lodash\");\n\nvar _strapiHelperPlugin = require(\"strapi-helper-plugin\");\n\nvar _qs = require(\"qs\");\n\nvar _useListView2 = _interopRequireDefault(require(\"../../hooks/useListView\"));\n\nvar _utils = require(\"../../utils\");\n\nvar _State = _interopRequireDefault(require(\"../State\"));\n\nvar _styledComponents = require(\"./styledComponents\");\n\nvar _ActionCollapse = _interopRequireDefault(require(\"./ActionCollapse\"));\n\nvar _Headers = _interopRequireDefault(require(\"./Headers\"));\n\nvar _Row = _interopRequireDefault(require(\"./Row\"));\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nvar CustomTable = function CustomTable(_ref) {\n  var canCreate = _ref.canCreate,\n      canUpdate = _ref.canUpdate,\n      canDelete = _ref.canDelete,\n      data = _ref.data,\n      displayedHeaders = _ref.displayedHeaders,\n      hasDraftAndPublish = _ref.hasDraftAndPublish,\n      isBulkable = _ref.isBulkable,\n      showLoader = _ref.showLoader;\n\n  var _useIntl = (0, _reactIntl.useIntl)(),\n      formatMessage = _useIntl.formatMessage;\n\n  var _useListView = (0, _useListView2[\"default\"])(),\n      entriesToDelete = _useListView.entriesToDelete,\n      label = _useListView.label,\n      filters = _useListView.filters,\n      _q = _useListView._q;\n\n  var _useGlobalContext = (0, _strapiHelperPlugin.useGlobalContext)(),\n      emitEvent = _useGlobalContext.emitEvent;\n\n  var _useLocation = (0, _reactRouterDom.useLocation)(),\n      pathname = _useLocation.pathname,\n      search = _useLocation.search;\n\n  var query = search ? (0, _qs.parse)(search.substring(1)) : {};\n\n  var _useHistory = (0, _reactRouterDom.useHistory)(),\n      push = _useHistory.push;\n\n  var searchToPersist = query.plugins ? (0, _qs.stringify)({\n    plugins: query.plugins\n  }, {\n    encode: false\n  }) : '';\n  var headers = (0, _react.useMemo)(function () {\n    if (hasDraftAndPublish) {\n      return [].concat((0, _toConsumableArray2[\"default\"])(displayedHeaders), [{\n        key: '__published_at_temp_key__',\n        name: 'published_at',\n        fieldSchema: {\n          type: 'custom'\n        },\n        metadatas: {\n          label: formatMessage({\n            id: (0, _utils.getTrad)('containers.ListPage.table-headers.published_at')\n          }),\n          searchable: false,\n          sortable: true\n        },\n        cellFormatter: function cellFormatter(cellData) {\n          var isPublished = !(0, _lodash.isEmpty)(cellData.published_at);\n          return /*#__PURE__*/_react[\"default\"].createElement(_State[\"default\"], {\n            isPublished: isPublished\n          });\n        }\n      }]);\n    }\n\n    return displayedHeaders;\n  }, [formatMessage, hasDraftAndPublish, displayedHeaders]);\n  var colSpanLength = isBulkable && canDelete ? headers.length + 2 : headers.length + 1;\n\n  var handleRowGoTo = function handleRowGoTo(id) {\n    emitEvent('willEditEntryFromList');\n    push({\n      pathname: \"\".concat(pathname, \"/\").concat(id),\n      state: {\n        from: pathname\n      },\n      search: searchToPersist\n    });\n  };\n\n  var handleEditGoTo = function handleEditGoTo(id) {\n    emitEvent('willEditEntryFromButton');\n    push({\n      pathname: \"\".concat(pathname, \"/\").concat(id),\n      state: {\n        from: pathname\n      },\n      search: searchToPersist\n    });\n  };\n\n  var values = {\n    contentType: (0, _lodash.upperFirst)(label),\n    search: _q\n  };\n  var tableEmptyMsgId = filters.length > 0 ? 'withFilters' : 'withoutFilter';\n\n  if (_q !== '') {\n    tableEmptyMsgId = 'withSearch';\n  }\n\n  var content = data.length === 0 ? /*#__PURE__*/_react[\"default\"].createElement(_styledComponents.TableEmpty, null, /*#__PURE__*/_react[\"default\"].createElement(\"td\", {\n    colSpan: colSpanLength\n  }, /*#__PURE__*/_react[\"default\"].createElement(_reactIntl.FormattedMessage, {\n    id: \"content-manager.components.TableEmpty.\".concat(tableEmptyMsgId),\n    values: values\n  }))) : data.map(function (row) {\n    return /*#__PURE__*/_react[\"default\"].createElement(_styledComponents.TableRow, {\n      key: row.id,\n      onClick: function onClick(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        handleRowGoTo(row.id);\n      }\n    }, /*#__PURE__*/_react[\"default\"].createElement(_Row[\"default\"], {\n      canCreate: canCreate,\n      canDelete: canDelete,\n      canUpdate: canUpdate,\n      isBulkable: isBulkable && canDelete,\n      headers: headers,\n      row: row,\n      goTo: handleEditGoTo\n    }));\n  });\n\n  if (showLoader) {\n    return /*#__PURE__*/_react[\"default\"].createElement(_react[\"default\"].Fragment, null, /*#__PURE__*/_react[\"default\"].createElement(_styledComponents.Table, {\n      className: \"table\"\n    }, /*#__PURE__*/_react[\"default\"].createElement(_Headers[\"default\"], {\n      headers: headers,\n      isBulkable: isBulkable && canDelete\n    })), /*#__PURE__*/_react[\"default\"].createElement(_styledComponents.LoadingWrapper, null, /*#__PURE__*/_react[\"default\"].createElement(_styledComponents.LoadingContainer, null, /*#__PURE__*/_react[\"default\"].createElement(_strapiHelperPlugin.LoadingIndicator, null))));\n  }\n\n  return /*#__PURE__*/_react[\"default\"].createElement(_styledComponents.Table, {\n    className: \"table\"\n  }, /*#__PURE__*/_react[\"default\"].createElement(_Headers[\"default\"], {\n    headers: headers,\n    isBulkable: isBulkable && canDelete\n  }), /*#__PURE__*/_react[\"default\"].createElement(\"tbody\", null, entriesToDelete.length > 0 && /*#__PURE__*/_react[\"default\"].createElement(_ActionCollapse[\"default\"], {\n    colSpan: colSpanLength\n  }), content));\n};\n\nCustomTable.propTypes = {\n  canCreate: _propTypes[\"default\"].bool.isRequired,\n  canDelete: _propTypes[\"default\"].bool.isRequired,\n  canUpdate: _propTypes[\"default\"].bool.isRequired,\n  data: _propTypes[\"default\"].array.isRequired,\n  displayedHeaders: _propTypes[\"default\"].array.isRequired,\n  hasDraftAndPublish: _propTypes[\"default\"].bool.isRequired,\n  isBulkable: _propTypes[\"default\"].bool.isRequired,\n  showLoader: _propTypes[\"default\"].bool.isRequired\n};\n\nvar _default = /*#__PURE__*/(0, _react.memo)(CustomTable);\n\nexports[\"default\"] = _default;","map":{"version":3,"sources":["/Users/joaovictorlobao/prefeituramaragogistrapi/.cache/plugins/strapi-plugin-content-manager/admin/src/components/CustomTable/index.js"],"names":["CustomTable","canCreate","canUpdate","canDelete","data","displayedHeaders","hasDraftAndPublish","isBulkable","showLoader","formatMessage","entriesToDelete","label","filters","_q","emitEvent","pathname","search","query","substring","push","searchToPersist","plugins","encode","headers","key","name","fieldSchema","type","metadatas","id","searchable","sortable","cellFormatter","cellData","isPublished","published_at","colSpanLength","length","handleRowGoTo","state","from","handleEditGoTo","values","contentType","tableEmptyMsgId","content","map","row","e","preventDefault","stopPropagation","propTypes","PropTypes","bool","isRequired","array"],"mappings":"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","sourcesContent":["import React, { memo, useMemo } from 'react';\nimport PropTypes from 'prop-types';\nimport { useLocation, useHistory } from 'react-router-dom';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { upperFirst, isEmpty } from 'lodash';\nimport { LoadingIndicator, useGlobalContext } from 'strapi-helper-plugin';\nimport { parse, stringify } from 'qs';\nimport useListView from '../../hooks/useListView';\nimport { getTrad } from '../../utils';\nimport State from '../State';\nimport { LoadingContainer, LoadingWrapper, Table, TableEmpty, TableRow } from './styledComponents';\nimport ActionCollapse from './ActionCollapse';\nimport Headers from './Headers';\nimport Row from './Row';\n\nconst CustomTable = ({\n  canCreate,\n  canUpdate,\n  canDelete,\n  data,\n  displayedHeaders,\n  hasDraftAndPublish,\n  isBulkable,\n  showLoader,\n}) => {\n  const { formatMessage } = useIntl();\n  const { entriesToDelete, label, filters, _q } = useListView();\n  const { emitEvent } = useGlobalContext();\n  const { pathname, search } = useLocation();\n  const query = search ? parse(search.substring(1)) : {};\n  const { push } = useHistory();\n  const searchToPersist = query.plugins\n    ? stringify({ plugins: query.plugins }, { encode: false })\n    : '';\n\n  const headers = useMemo(() => {\n    if (hasDraftAndPublish) {\n      return [\n        ...displayedHeaders,\n        {\n          key: '__published_at_temp_key__',\n          name: 'published_at',\n          fieldSchema: {\n            type: 'custom',\n          },\n          metadatas: {\n            label: formatMessage({ id: getTrad('containers.ListPage.table-headers.published_at') }),\n            searchable: false,\n            sortable: true,\n          },\n          cellFormatter: cellData => {\n            const isPublished = !isEmpty(cellData.published_at);\n\n            return <State isPublished={isPublished} />;\n          },\n        },\n      ];\n    }\n\n    return displayedHeaders;\n  }, [formatMessage, hasDraftAndPublish, displayedHeaders]);\n\n  const colSpanLength = isBulkable && canDelete ? headers.length + 2 : headers.length + 1;\n\n  const handleRowGoTo = id => {\n    emitEvent('willEditEntryFromList');\n    push({\n      pathname: `${pathname}/${id}`,\n      state: { from: pathname },\n      search: searchToPersist,\n    });\n  };\n  const handleEditGoTo = id => {\n    emitEvent('willEditEntryFromButton');\n    push({\n      pathname: `${pathname}/${id}`,\n      state: { from: pathname },\n      search: searchToPersist,\n    });\n  };\n\n  const values = { contentType: upperFirst(label), search: _q };\n  let tableEmptyMsgId = filters.length > 0 ? 'withFilters' : 'withoutFilter';\n\n  if (_q !== '') {\n    tableEmptyMsgId = 'withSearch';\n  }\n\n  const content =\n    data.length === 0 ? (\n      <TableEmpty>\n        <td colSpan={colSpanLength}>\n          <FormattedMessage\n            id={`content-manager.components.TableEmpty.${tableEmptyMsgId}`}\n            values={values}\n          />\n        </td>\n      </TableEmpty>\n    ) : (\n      data.map(row => {\n        return (\n          <TableRow\n            key={row.id}\n            onClick={e => {\n              e.preventDefault();\n              e.stopPropagation();\n\n              handleRowGoTo(row.id);\n            }}\n          >\n            <Row\n              canCreate={canCreate}\n              canDelete={canDelete}\n              canUpdate={canUpdate}\n              isBulkable={isBulkable && canDelete}\n              headers={headers}\n              row={row}\n              goTo={handleEditGoTo}\n            />\n          </TableRow>\n        );\n      })\n    );\n\n  if (showLoader) {\n    return (\n      <>\n        <Table className=\"table\">\n          <Headers headers={headers} isBulkable={isBulkable && canDelete} />\n        </Table>\n        <LoadingWrapper>\n          <LoadingContainer>\n            <LoadingIndicator />\n          </LoadingContainer>\n        </LoadingWrapper>\n      </>\n    );\n  }\n\n  return (\n    <Table className=\"table\">\n      <Headers headers={headers} isBulkable={isBulkable && canDelete} />\n      <tbody>\n        {entriesToDelete.length > 0 && <ActionCollapse colSpan={colSpanLength} />}\n        {content}\n      </tbody>\n    </Table>\n  );\n};\n\nCustomTable.propTypes = {\n  canCreate: PropTypes.bool.isRequired,\n  canDelete: PropTypes.bool.isRequired,\n  canUpdate: PropTypes.bool.isRequired,\n  data: PropTypes.array.isRequired,\n  displayedHeaders: PropTypes.array.isRequired,\n  hasDraftAndPublish: PropTypes.bool.isRequired,\n  isBulkable: PropTypes.bool.isRequired,\n  showLoader: PropTypes.bool.isRequired,\n};\n\nexport default memo(CustomTable);\n"]},"metadata":{},"sourceType":"script"}