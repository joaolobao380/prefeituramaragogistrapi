{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _typeof = require(\"@babel/runtime/helpers/typeof\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _lodash = require(\"lodash\");\n\nvar _reactDnd = require(\"react-dnd\");\n\nvar _reactSelect = _interopRequireWildcard(require(\"react-select\"));\n\nvar _ItemTypes = _interopRequireDefault(require(\"../../utils/ItemTypes\"));\n\nvar _components = require(\"./components\");\n\nvar _ListItem = _interopRequireDefault(require(\"./ListItem\"));\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nfunction SelectMany(_ref) {\n  var addRelation = _ref.addRelation,\n      components = _ref.components,\n      displayNavigationLink = _ref.displayNavigationLink,\n      mainField = _ref.mainField,\n      name = _ref.name,\n      isDisabled = _ref.isDisabled,\n      isLoading = _ref.isLoading,\n      move = _ref.move,\n      onInputChange = _ref.onInputChange,\n      onMenuClose = _ref.onMenuClose,\n      onMenuOpen = _ref.onMenuOpen,\n      onMenuScrollToBottom = _ref.onMenuScrollToBottom,\n      _onRemove = _ref.onRemove,\n      options = _ref.options,\n      placeholder = _ref.placeholder,\n      searchToPersist = _ref.searchToPersist,\n      styles = _ref.styles,\n      targetModel = _ref.targetModel,\n      value = _ref.value;\n\n  var _useDrop = (0, _reactDnd.useDrop)({\n    accept: _ItemTypes[\"default\"].RELATION\n  }),\n      _useDrop2 = (0, _slicedToArray2[\"default\"])(_useDrop, 2),\n      drop = _useDrop2[1];\n\n  var findRelation = function findRelation(id) {\n    var relation = value.filter(function (c) {\n      return \"\".concat(c.id) === \"\".concat(id);\n    })[0];\n    return {\n      relation: relation,\n      index: value.indexOf(relation)\n    };\n  };\n\n  var moveRelation = (0, _react.useCallback)(function (id, atIndex) {\n    var _findRelation = findRelation(id),\n        index = _findRelation.index;\n\n    move(index, atIndex, name);\n  }, // eslint-disable-next-line react-hooks/exhaustive-deps\n  [value]);\n  var filterConfig = {\n    ignoreCase: true,\n    ignoreAccents: true,\n    trim: false,\n    matchFrom: 'any'\n  };\n  return /*#__PURE__*/_react[\"default\"].createElement(_react[\"default\"].Fragment, null, /*#__PURE__*/_react[\"default\"].createElement(_reactSelect[\"default\"], {\n    components: components,\n    isDisabled: isDisabled,\n    id: name,\n    filterOption: function filterOption(candidate, input) {\n      if (!(0, _lodash.isEmpty)(value)) {\n        var isSelected = value.findIndex(function (item) {\n          return item.id === candidate.value.id;\n        }) !== -1;\n\n        if (isSelected) {\n          return false;\n        }\n      }\n\n      if (input) {\n        return (0, _reactSelect.createFilter)(filterConfig)(candidate, input);\n      }\n\n      return true;\n    },\n    mainField: mainField,\n    isLoading: isLoading,\n    isMulti: true,\n    isSearchable: true,\n    options: options,\n    onChange: addRelation,\n    onInputChange: onInputChange,\n    onMenuClose: onMenuClose,\n    onMenuOpen: onMenuOpen,\n    onMenuScrollToBottom: onMenuScrollToBottom,\n    placeholder: placeholder,\n    styles: styles,\n    value: []\n  }), /*#__PURE__*/_react[\"default\"].createElement(_components.ListWrapper, {\n    ref: drop\n  }, !(0, _lodash.isEmpty)(value) && /*#__PURE__*/_react[\"default\"].createElement(\"ul\", null, value.map(function (data, index) {\n    return /*#__PURE__*/_react[\"default\"].createElement(_ListItem[\"default\"], {\n      key: data.id,\n      data: data,\n      displayNavigationLink: displayNavigationLink,\n      isDisabled: isDisabled,\n      findRelation: findRelation,\n      mainField: mainField,\n      moveRelation: moveRelation,\n      onRemove: function onRemove() {\n        if (!isDisabled) {\n          _onRemove(\"\".concat(name, \".\").concat(index));\n        }\n      },\n      searchToPersist: searchToPersist,\n      targetModel: targetModel\n    });\n  })), !(0, _lodash.isEmpty)(value) && value.length > 4 && /*#__PURE__*/_react[\"default\"].createElement(_components.ListShadow, null)));\n}\n\nSelectMany.defaultProps = {\n  components: {},\n  move: function move() {},\n  searchToPersist: null,\n  value: null\n};\nSelectMany.propTypes = {\n  addRelation: _propTypes[\"default\"].func.isRequired,\n  components: _propTypes[\"default\"].object,\n  displayNavigationLink: _propTypes[\"default\"].bool.isRequired,\n  isDisabled: _propTypes[\"default\"].bool.isRequired,\n  isLoading: _propTypes[\"default\"].bool.isRequired,\n  mainField: _propTypes[\"default\"].shape({\n    name: _propTypes[\"default\"].string.isRequired,\n    schema: _propTypes[\"default\"].shape({\n      type: _propTypes[\"default\"].string.isRequired\n    }).isRequired\n  }).isRequired,\n  move: _propTypes[\"default\"].func,\n  name: _propTypes[\"default\"].string.isRequired,\n  onInputChange: _propTypes[\"default\"].func.isRequired,\n  onMenuClose: _propTypes[\"default\"].func.isRequired,\n  onMenuOpen: _propTypes[\"default\"].func.isRequired,\n  onMenuScrollToBottom: _propTypes[\"default\"].func.isRequired,\n  onRemove: _propTypes[\"default\"].func.isRequired,\n  options: _propTypes[\"default\"].array.isRequired,\n  placeholder: _propTypes[\"default\"].node.isRequired,\n  searchToPersist: _propTypes[\"default\"].string,\n  styles: _propTypes[\"default\"].object.isRequired,\n  targetModel: _propTypes[\"default\"].string.isRequired,\n  value: _propTypes[\"default\"].array\n};\n\nvar _default = /*#__PURE__*/(0, _react.memo)(SelectMany);\n\nexports[\"default\"] = _default;","map":{"version":3,"sources":["/Users/joaovictorlobao/prefeituramaragogistrapi/.cache/plugins/strapi-plugin-content-manager/admin/src/components/SelectMany/index.js"],"names":["SelectMany","addRelation","components","displayNavigationLink","mainField","name","isDisabled","isLoading","move","onInputChange","onMenuClose","onMenuOpen","onMenuScrollToBottom","onRemove","options","placeholder","searchToPersist","styles","targetModel","value","accept","ItemTypes","RELATION","drop","findRelation","id","relation","filter","c","index","indexOf","moveRelation","atIndex","filterConfig","ignoreCase","ignoreAccents","trim","matchFrom","candidate","input","isSelected","findIndex","item","map","data","length","defaultProps","propTypes","PropTypes","func","isRequired","object","bool","shape","string","schema","type","array","node"],"mappings":"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","sourcesContent":["import React, { memo, useCallback } from 'react';\nimport PropTypes from 'prop-types';\nimport { isEmpty } from 'lodash';\nimport { useDrop } from 'react-dnd';\nimport Select, { createFilter } from 'react-select';\nimport ItemTypes from '../../utils/ItemTypes';\nimport { ListShadow, ListWrapper } from './components';\nimport ListItem from './ListItem';\n\nfunction SelectMany({\n  addRelation,\n  components,\n  displayNavigationLink,\n  mainField,\n  name,\n  isDisabled,\n  isLoading,\n  move,\n  onInputChange,\n  onMenuClose,\n  onMenuOpen,\n  onMenuScrollToBottom,\n  onRemove,\n  options,\n  placeholder,\n  searchToPersist,\n  styles,\n  targetModel,\n  value,\n}) {\n  const [, drop] = useDrop({ accept: ItemTypes.RELATION });\n  const findRelation = id => {\n    const relation = value.filter(c => {\n      return `${c.id}` === `${id}`;\n    })[0];\n\n    return {\n      relation,\n      index: value.indexOf(relation),\n    };\n  };\n\n  const moveRelation = useCallback(\n    (id, atIndex) => {\n      const { index } = findRelation(id);\n\n      move(index, atIndex, name);\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [value]\n  );\n\n  const filterConfig = {\n    ignoreCase: true,\n    ignoreAccents: true,\n    trim: false,\n    matchFrom: 'any',\n  };\n\n  return (\n    <>\n      <Select\n        components={components}\n        isDisabled={isDisabled}\n        id={name}\n        filterOption={(candidate, input) => {\n          if (!isEmpty(value)) {\n            const isSelected = value.findIndex(item => item.id === candidate.value.id) !== -1;\n\n            if (isSelected) {\n              return false;\n            }\n          }\n\n          if (input) {\n            return createFilter(filterConfig)(candidate, input);\n          }\n\n          return true;\n        }}\n        mainField={mainField}\n        isLoading={isLoading}\n        isMulti\n        isSearchable\n        options={options}\n        onChange={addRelation}\n        onInputChange={onInputChange}\n        onMenuClose={onMenuClose}\n        onMenuOpen={onMenuOpen}\n        onMenuScrollToBottom={onMenuScrollToBottom}\n        placeholder={placeholder}\n        styles={styles}\n        value={[]}\n      />\n\n      <ListWrapper ref={drop}>\n        {!isEmpty(value) && (\n          <ul>\n            {value.map((data, index) => (\n              <ListItem\n                key={data.id}\n                data={data}\n                displayNavigationLink={displayNavigationLink}\n                isDisabled={isDisabled}\n                findRelation={findRelation}\n                mainField={mainField}\n                moveRelation={moveRelation}\n                onRemove={() => {\n                  if (!isDisabled) {\n                    onRemove(`${name}.${index}`);\n                  }\n                }}\n                searchToPersist={searchToPersist}\n                targetModel={targetModel}\n              />\n            ))}\n          </ul>\n        )}\n        {!isEmpty(value) && value.length > 4 && <ListShadow />}\n      </ListWrapper>\n    </>\n  );\n}\n\nSelectMany.defaultProps = {\n  components: {},\n  move: () => {},\n  searchToPersist: null,\n  value: null,\n};\n\nSelectMany.propTypes = {\n  addRelation: PropTypes.func.isRequired,\n  components: PropTypes.object,\n  displayNavigationLink: PropTypes.bool.isRequired,\n  isDisabled: PropTypes.bool.isRequired,\n  isLoading: PropTypes.bool.isRequired,\n  mainField: PropTypes.shape({\n    name: PropTypes.string.isRequired,\n    schema: PropTypes.shape({\n      type: PropTypes.string.isRequired,\n    }).isRequired,\n  }).isRequired,\n  move: PropTypes.func,\n  name: PropTypes.string.isRequired,\n  onInputChange: PropTypes.func.isRequired,\n  onMenuClose: PropTypes.func.isRequired,\n  onMenuOpen: PropTypes.func.isRequired,\n  onMenuScrollToBottom: PropTypes.func.isRequired,\n  onRemove: PropTypes.func.isRequired,\n  options: PropTypes.array.isRequired,\n  placeholder: PropTypes.node.isRequired,\n  searchToPersist: PropTypes.string,\n  styles: PropTypes.object.isRequired,\n  targetModel: PropTypes.string.isRequired,\n  value: PropTypes.array,\n};\n\nexport default memo(SelectMany);\n"]},"metadata":{},"sourceType":"script"}