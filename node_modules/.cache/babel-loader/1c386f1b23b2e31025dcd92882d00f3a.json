{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _typeof = require(\"@babel/runtime/helpers/typeof\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _core = require(\"@buffetjs/core\");\n\nvar _reactIntl = require(\"react-intl\");\n\nvar _FormBloc = _interopRequireDefault(require(\"../FormBloc\"));\n\nvar _getTrad = _interopRequireDefault(require(\"../../utils/getTrad\"));\n\nvar _Policies = _interopRequireDefault(require(\"../Policies\"));\n\nvar _Permissions = _interopRequireDefault(require(\"../Permissions\"));\n\nvar _reducer = _interopRequireWildcard(require(\"./reducer\"));\n\nvar _UsersPermissionsContext = require(\"../../contexts/UsersPermissionsContext\");\n\nvar _init = _interopRequireDefault(require(\"./init\"));\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2[\"default\"])(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nvar UsersPermissions = /*#__PURE__*/(0, _react.forwardRef)(function (_ref, ref) {\n  var permissions = _ref.permissions,\n      routes = _ref.routes,\n      policies = _ref.policies;\n\n  var _useIntl = (0, _reactIntl.useIntl)(),\n      formatMessage = _useIntl.formatMessage;\n\n  var _useReducer = (0, _react.useReducer)(_reducer[\"default\"], _reducer.initialState, function (state) {\n    return (0, _init[\"default\"])(state, permissions, routes, policies);\n  }),\n      _useReducer2 = (0, _slicedToArray2[\"default\"])(_useReducer, 2),\n      state = _useReducer2[0],\n      dispatch = _useReducer2[1];\n\n  (0, _react.useImperativeHandle)(ref, function () {\n    return {\n      getPermissions: function getPermissions() {\n        return {\n          permissions: state.modifiedData\n        };\n      },\n      resetForm: function resetForm() {\n        dispatch({\n          type: 'ON_RESET'\n        });\n      },\n      setFormAfterSubmit: function setFormAfterSubmit() {\n        dispatch({\n          type: 'ON_SUBMIT_SUCCEEDED'\n        });\n      }\n    };\n  });\n  var handleChange = (0, _react.useCallback)(function (_ref2) {\n    var _ref2$target = _ref2.target,\n        name = _ref2$target.name,\n        value = _ref2$target.value;\n    dispatch({\n      type: 'ON_CHANGE',\n      keys: name.split('.'),\n      value: value === 'empty__string_value' ? '' : value\n    });\n  }, []);\n  var handleChangeSelectAll = (0, _react.useCallback)(function (_ref3) {\n    var _ref3$target = _ref3.target,\n        name = _ref3$target.name,\n        value = _ref3$target.value;\n    dispatch({\n      type: 'ON_CHANGE_SELECT_ALL',\n      keys: name.split('.'),\n      value: value\n    });\n  }, []);\n  var handleSelectedAction = (0, _react.useCallback)(function (actionToSelect) {\n    dispatch({\n      type: 'SELECT_ACTION',\n      actionToSelect: actionToSelect\n    });\n  }, []);\n\n  var providerValue = _objectSpread(_objectSpread({}, state), {}, {\n    onChange: handleChange,\n    onChangeSelectAll: handleChangeSelectAll,\n    onSelectedAction: handleSelectedAction\n  });\n\n  return /*#__PURE__*/_react[\"default\"].createElement(_UsersPermissionsContext.UsersPermissionsProvider, {\n    value: providerValue\n  }, /*#__PURE__*/_react[\"default\"].createElement(_core.Flex, null, /*#__PURE__*/_react[\"default\"].createElement(_FormBloc[\"default\"], {\n    title: formatMessage({\n      id: (0, _getTrad[\"default\"])('Plugins.header.title')\n    }),\n    subtitle: formatMessage({\n      id: (0, _getTrad[\"default\"])('Plugins.header.description')\n    })\n  }, /*#__PURE__*/_react[\"default\"].createElement(_core.Padded, {\n    left: true,\n    right: true,\n    size: \"xs\"\n  }, /*#__PURE__*/_react[\"default\"].createElement(_Permissions[\"default\"], null))), /*#__PURE__*/_react[\"default\"].createElement(_Policies[\"default\"], null)));\n});\nUsersPermissions.propTypes = {\n  permissions: _propTypes[\"default\"].object.isRequired,\n  routes: _propTypes[\"default\"].object.isRequired,\n  policies: _propTypes[\"default\"].array.isRequired\n};\n\nvar _default = /*#__PURE__*/(0, _react.memo)(UsersPermissions);\n\nexports[\"default\"] = _default;","map":{"version":3,"sources":["/Users/joaovictorlobao/prefeituramaragogistrapi/.cache/plugins/strapi-plugin-users-permissions/admin/src/components/UsersPermissions/index.js"],"names":["UsersPermissions","ref","permissions","routes","policies","formatMessage","reducer","initialState","state","dispatch","getPermissions","modifiedData","resetForm","type","setFormAfterSubmit","handleChange","target","name","value","keys","split","handleChangeSelectAll","handleSelectedAction","actionToSelect","providerValue","onChange","onChangeSelectAll","onSelectedAction","id","propTypes","PropTypes","object","isRequired","array"],"mappings":"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","sourcesContent":["import React, { memo, useReducer, useCallback, forwardRef, useImperativeHandle } from 'react';\nimport PropTypes from 'prop-types';\nimport { Padded, Flex } from '@buffetjs/core';\nimport { useIntl } from 'react-intl';\n\nimport FormCard from '../FormBloc';\nimport getTrad from '../../utils/getTrad';\nimport Policies from '../Policies';\nimport Permissions from '../Permissions';\nimport reducer, { initialState } from './reducer';\nimport { UsersPermissionsProvider } from '../../contexts/UsersPermissionsContext';\nimport init from './init';\n\nconst UsersPermissions = forwardRef(({ permissions, routes, policies }, ref) => {\n  const { formatMessage } = useIntl();\n  const [state, dispatch] = useReducer(reducer, initialState, state =>\n    init(state, permissions, routes, policies)\n  );\n\n  useImperativeHandle(ref, () => ({\n    getPermissions: () => {\n      return {\n        permissions: state.modifiedData,\n      };\n    },\n    resetForm: () => {\n      dispatch({ type: 'ON_RESET' });\n    },\n    setFormAfterSubmit: () => {\n      dispatch({ type: 'ON_SUBMIT_SUCCEEDED' });\n    },\n  }));\n\n  const handleChange = useCallback(({ target: { name, value } }) => {\n    dispatch({\n      type: 'ON_CHANGE',\n      keys: name.split('.'),\n      value: value === 'empty__string_value' ? '' : value,\n    });\n  }, []);\n\n  const handleChangeSelectAll = useCallback(({ target: { name, value } }) => {\n    dispatch({\n      type: 'ON_CHANGE_SELECT_ALL',\n      keys: name.split('.'),\n      value,\n    });\n  }, []);\n\n  const handleSelectedAction = useCallback(actionToSelect => {\n    dispatch({\n      type: 'SELECT_ACTION',\n      actionToSelect,\n    });\n  }, []);\n\n  const providerValue = {\n    ...state,\n    onChange: handleChange,\n    onChangeSelectAll: handleChangeSelectAll,\n    onSelectedAction: handleSelectedAction,\n  };\n\n  return (\n    <UsersPermissionsProvider value={providerValue}>\n      <Flex>\n        <FormCard\n          title={formatMessage({\n            id: getTrad('Plugins.header.title'),\n          })}\n          subtitle={formatMessage({\n            id: getTrad('Plugins.header.description'),\n          })}\n        >\n          <Padded left right size=\"xs\">\n            <Permissions />\n          </Padded>\n        </FormCard>\n        <Policies />\n      </Flex>\n    </UsersPermissionsProvider>\n  );\n});\n\nUsersPermissions.propTypes = {\n  permissions: PropTypes.object.isRequired,\n  routes: PropTypes.object.isRequired,\n  policies: PropTypes.array.isRequired,\n};\n\nexport default memo(UsersPermissions);\n"]},"metadata":{},"sourceType":"script"}