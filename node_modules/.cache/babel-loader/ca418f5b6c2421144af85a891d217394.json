{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _typeof = require(\"@babel/runtime/helpers/typeof\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _reactIntl = require(\"react-intl\");\n\nvar _core = require(\"@buffetjs/core\");\n\nvar _strapiHelperPlugin = require(\"strapi-helper-plugin\");\n\nvar _utils = require(\"../../../utils\");\n\nvar _init = _interopRequireDefault(require(\"./init\"));\n\nvar _reducer = _interopRequireWildcard(require(\"./reducer\"));\n\nvar _Wrapper = _interopRequireDefault(require(\"./Wrapper\"));\n\nvar _InputWrapper = _interopRequireDefault(require(\"./InputWrapper\"));\n\nvar _FilterButton = _interopRequireDefault(require(\"./FilterButton\"));\n\nvar _FilterInput = _interopRequireDefault(require(\"./FilterInput\"));\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nvar FiltersCard = function FiltersCard(_ref) {\n  var onChange = _ref.onChange;\n\n  var _useGlobalContext = (0, _strapiHelperPlugin.useGlobalContext)(),\n      plugins = _useGlobalContext.plugins;\n\n  var timestamps = (0, _utils.getFileModelTimestamps)(plugins);\n\n  var _useReducer = (0, _react.useReducer)(_reducer[\"default\"], _reducer.initialState, function () {\n    return (0, _init[\"default\"])(_reducer.initialState, timestamps);\n  }),\n      _useReducer2 = (0, _slicedToArray2[\"default\"])(_useReducer, 2),\n      state = _useReducer2[0],\n      dispatch = _useReducer2[1];\n\n  var _state$toJS = state.toJS(),\n      name = _state$toJS.name,\n      filter = _state$toJS.filter,\n      filtersForm = _state$toJS.filtersForm,\n      value = _state$toJS.value;\n\n  var type = filtersForm[name].type;\n  var filtersOptions = (0, _strapiHelperPlugin.getFilterType)(type);\n  var options = ['image', 'video', 'file'];\n\n  var handleChange = function handleChange(_ref2) {\n    var _ref2$target = _ref2.target,\n        name = _ref2$target.name,\n        value = _ref2$target.value;\n    dispatch({\n      type: 'ON_CHANGE',\n      name: name,\n      value: value,\n      defaultValue: value === 'mime' ? options[0] : null\n    });\n  };\n\n  var addFilter = function addFilter() {\n    onChange({\n      target: {\n        value: {\n          name: name,\n          filter: filter,\n          value: value\n        }\n      }\n    });\n    dispatch({\n      type: 'RESET_FORM'\n    });\n  };\n\n  var renderFiltersOptions = function renderFiltersOptions() {\n    return filtersOptions.map(function (_ref3) {\n      var id = _ref3.id,\n          value = _ref3.value;\n      return /*#__PURE__*/_react[\"default\"].createElement(_reactIntl.FormattedMessage, {\n        id: id,\n        key: id\n      }, function (msg) {\n        return /*#__PURE__*/_react[\"default\"].createElement(\"option\", {\n          value: value\n        }, msg);\n      });\n    });\n  };\n\n  var renderNamesOptions = function renderNamesOptions() {\n    return Object.keys(filtersForm).map(function (key) {\n      return /*#__PURE__*/_react[\"default\"].createElement(\"option\", {\n        key: key,\n        value: key\n      }, key === 'mime' ? 'type' : key);\n    });\n  };\n\n  return /*#__PURE__*/_react[\"default\"].createElement(_Wrapper[\"default\"], null, /*#__PURE__*/_react[\"default\"].createElement(_InputWrapper[\"default\"], null, /*#__PURE__*/_react[\"default\"].createElement(_core.Select, {\n    onChange: handleChange,\n    name: \"name\",\n    options: renderNamesOptions(),\n    value: name\n  })), /*#__PURE__*/_react[\"default\"].createElement(_InputWrapper[\"default\"], null, /*#__PURE__*/_react[\"default\"].createElement(_core.Select, {\n    onChange: handleChange,\n    name: \"filter\",\n    options: renderFiltersOptions(),\n    value: filter\n  })), /*#__PURE__*/_react[\"default\"].createElement(_InputWrapper[\"default\"], null, /*#__PURE__*/_react[\"default\"].createElement(_FilterInput[\"default\"], {\n    type: type,\n    onChange: handleChange,\n    name: \"value\",\n    options: options,\n    value: value\n  })), /*#__PURE__*/_react[\"default\"].createElement(_FilterButton[\"default\"], {\n    icon: true,\n    onClick: addFilter\n  }, /*#__PURE__*/_react[\"default\"].createElement(_reactIntl.FormattedMessage, {\n    id: (0, _utils.getTrad)('filter.add')\n  })));\n};\n\nFiltersCard.defaultProps = {\n  onChange: function onChange() {}\n};\nFiltersCard.propTypes = {\n  onChange: _propTypes[\"default\"].func\n};\nvar _default = FiltersCard;\nexports[\"default\"] = _default;","map":{"version":3,"sources":["/Users/joaovictorlobao/prefeituramaragogistrapi/.cache/plugins/strapi-plugin-upload/admin/src/components/FiltersPicker/FiltersCard/index.js"],"names":["FiltersCard","onChange","plugins","timestamps","reducer","initialState","state","dispatch","toJS","name","filter","filtersForm","value","type","filtersOptions","options","handleChange","target","defaultValue","addFilter","renderFiltersOptions","map","id","msg","renderNamesOptions","Object","keys","key","defaultProps","propTypes","PropTypes","func"],"mappings":"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","sourcesContent":["import React, { useReducer } from 'react';\nimport PropTypes from 'prop-types';\nimport { FormattedMessage } from 'react-intl';\nimport { Select } from '@buffetjs/core';\nimport { getFilterType, useGlobalContext } from 'strapi-helper-plugin';\nimport { getTrad, getFileModelTimestamps } from '../../../utils';\nimport init from './init';\nimport reducer, { initialState } from './reducer';\n\nimport Wrapper from './Wrapper';\nimport InputWrapper from './InputWrapper';\nimport FilterButton from './FilterButton';\nimport FilterInput from './FilterInput';\n\nconst FiltersCard = ({ onChange }) => {\n  const { plugins } = useGlobalContext();\n  const timestamps = getFileModelTimestamps(plugins);\n  const [state, dispatch] = useReducer(reducer, initialState, () => init(initialState, timestamps));\n  const { name, filter, filtersForm, value } = state.toJS();\n\n  const type = filtersForm[name].type;\n  const filtersOptions = getFilterType(type);\n  const options = ['image', 'video', 'file'];\n\n  const handleChange = ({ target: { name, value } }) => {\n    dispatch({\n      type: 'ON_CHANGE',\n      name,\n      value,\n      defaultValue: value === 'mime' ? options[0] : null,\n    });\n  };\n\n  const addFilter = () => {\n    onChange({ target: { value: { name, filter, value } } });\n\n    dispatch({\n      type: 'RESET_FORM',\n    });\n  };\n\n  const renderFiltersOptions = () => {\n    return filtersOptions.map(({ id, value }) => (\n      <FormattedMessage id={id} key={id}>\n        {msg => <option value={value}>{msg}</option>}\n      </FormattedMessage>\n    ));\n  };\n\n  const renderNamesOptions = () => {\n    return Object.keys(filtersForm).map(key => {\n      return (\n        <option key={key} value={key}>\n          {key === 'mime' ? 'type' : key}\n        </option>\n      );\n    });\n  };\n\n  return (\n    <Wrapper>\n      <InputWrapper>\n        <Select onChange={handleChange} name=\"name\" options={renderNamesOptions()} value={name} />\n      </InputWrapper>\n      <InputWrapper>\n        <Select\n          onChange={handleChange}\n          name=\"filter\"\n          options={renderFiltersOptions()}\n          value={filter}\n        />\n      </InputWrapper>\n      <InputWrapper>\n        <FilterInput\n          type={type}\n          onChange={handleChange}\n          name=\"value\"\n          options={options}\n          value={value}\n        />\n      </InputWrapper>\n      <FilterButton icon onClick={addFilter}>\n        <FormattedMessage id={getTrad('filter.add')} />\n      </FilterButton>\n    </Wrapper>\n  );\n};\n\nFiltersCard.defaultProps = {\n  onChange: () => {},\n};\n\nFiltersCard.propTypes = {\n  onChange: PropTypes.func,\n};\n\nexport default FiltersCard;\n"]},"metadata":{},"sourceType":"script"}