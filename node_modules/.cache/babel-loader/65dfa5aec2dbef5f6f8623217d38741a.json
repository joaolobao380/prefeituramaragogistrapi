{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _typeof = require(\"@babel/runtime/helpers/typeof\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _reactRedux = require(\"react-redux\");\n\nvar _strapiHelperPlugin = require(\"strapi-helper-plugin\");\n\nvar _actions = require(\"./actions\");\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nvar PermissionsManager = function PermissionsManager(_ref) {\n  var children = _ref.children;\n\n  var _useSelector = (0, _reactRedux.useSelector)(function (state) {\n    return state.get('permissionsManager');\n  }),\n      isLoading = _useSelector.isLoading,\n      userPermissions = _useSelector.userPermissions;\n\n  var dispatch = (0, _reactRedux.useDispatch)();\n\n  var fetchUserPermissions = /*#__PURE__*/function () {\n    var _ref2 = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee() {\n      var resetState,\n          _yield$request,\n          data,\n          _args = arguments;\n\n      return _regenerator[\"default\"].wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              resetState = _args.length > 0 && _args[0] !== undefined ? _args[0] : false;\n\n              if (resetState) {\n                // Show a loader\n                dispatch((0, _actions.getUserPermissions)());\n              }\n\n              _context.prev = 2;\n              _context.next = 5;\n              return (0, _strapiHelperPlugin.request)('/admin/users/me/permissions', {\n                method: 'GET'\n              });\n\n            case 5:\n              _yield$request = _context.sent;\n              data = _yield$request.data;\n              dispatch((0, _actions.getUserPermissionsSucceeded)(data));\n              _context.next = 14;\n              break;\n\n            case 10:\n              _context.prev = 10;\n              _context.t0 = _context[\"catch\"](2);\n              console.error(_context.t0);\n              dispatch((0, _actions.getUserPermissionsError)(_context.t0));\n\n            case 14:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[2, 10]]);\n    }));\n\n    return function fetchUserPermissions() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  (0, _react.useEffect)(function () {\n    fetchUserPermissions(true); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  if (isLoading) {\n    return /*#__PURE__*/_react[\"default\"].createElement(_strapiHelperPlugin.LoadingIndicatorPage, null);\n  }\n\n  return /*#__PURE__*/_react[\"default\"].createElement(_strapiHelperPlugin.UserProvider, {\n    value: {\n      userPermissions: userPermissions,\n      fetchUserPermissions: fetchUserPermissions\n    }\n  }, children);\n};\n\nPermissionsManager.defaultProps = {};\nPermissionsManager.propTypes = {\n  children: _propTypes[\"default\"].node.isRequired\n};\nvar _default = PermissionsManager;\nexports[\"default\"] = _default;","map":{"version":3,"sources":["/Users/joaovictorlobao/prefeituramaragogistrapi/.cache/admin/src/containers/PermissionsManager/index.js"],"names":["PermissionsManager","children","state","get","isLoading","userPermissions","dispatch","fetchUserPermissions","resetState","method","data","console","error","defaultProps","propTypes","PropTypes","node","isRequired"],"mappings":";;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;;;;;AAMA,IAAMA,kBAAkB,GAAG,SAArBA,kBAAqB,OAAkB;AAAA,MAAfC,QAAe,QAAfA,QAAe;;AAC3C,qBAAuC,6BAAY,UAAAC,KAAK;AAAA,WAAIA,KAAK,CAACC,GAAN,CAAU,oBAAV,CAAJ;AAAA,GAAjB,CAAvC;AAAA,MAAQC,SAAR,gBAAQA,SAAR;AAAA,MAAmBC,eAAnB,gBAAmBA,eAAnB;;AAEA,MAAMC,QAAQ,GAAG,8BAAjB;;AACA,MAAMC,oBAAoB;AAAA,8FAAG;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAOC,cAAAA,UAAP,2DAAoB,KAApB;;AAC3B,kBAAIA,UAAJ,EAAgB;AACd;AACAF,gBAAAA,QAAQ,CAAC,kCAAD,CAAR;AACD;;AAJ0B;AAAA;AAAA,qBAOF,iCAAQ,6BAAR,EAAuC;AAAEG,gBAAAA,MAAM,EAAE;AAAV,eAAvC,CAPE;;AAAA;AAAA;AAOjBC,cAAAA,IAPiB,kBAOjBA,IAPiB;AASzBJ,cAAAA,QAAQ,CAAC,0CAA4BI,IAA5B,CAAD,CAAR;AATyB;AAAA;;AAAA;AAAA;AAAA;AAWzBC,cAAAA,OAAO,CAACC,KAAR;AACAN,cAAAA,QAAQ,CAAC,kDAAD,CAAR;;AAZyB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAApBC,oBAAoB;AAAA;AAAA;AAAA,KAA1B;;AAgBA,wBAAU,YAAM;AACdA,IAAAA,oBAAoB,CAAC,IAAD,CAApB,CADc,CAEd;AACD,GAHD,EAGG,EAHH;;AAKA,MAAIH,SAAJ,EAAe;AACb,wBAAO,gCAAC,wCAAD,OAAP;AACD;;AAED,sBAAO,gCAAC,gCAAD;AAAc,IAAA,KAAK,EAAE;AAAEC,MAAAA,eAAe,EAAfA,eAAF;AAAmBE,MAAAA,oBAAoB,EAApBA;AAAnB;AAArB,KAAiEN,QAAjE,CAAP;AACD,CA9BD;;AAgCAD,kBAAkB,CAACa,YAAnB,GAAkC,EAAlC;AAEAb,kBAAkB,CAACc,SAAnB,GAA+B;AAC7Bb,EAAAA,QAAQ,EAAEc,sBAAUC,IAAV,CAAeC;AADI,CAA/B;eAIejB,kB","sourcesContent":["import React, { useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { LoadingIndicatorPage, UserProvider, request } from 'strapi-helper-plugin';\nimport {\n  getUserPermissions,\n  getUserPermissionsError,\n  getUserPermissionsSucceeded,\n} from './actions';\n\nconst PermissionsManager = ({ children }) => {\n  const { isLoading, userPermissions } = useSelector(state => state.get('permissionsManager'));\n\n  const dispatch = useDispatch();\n  const fetchUserPermissions = async (resetState = false) => {\n    if (resetState) {\n      // Show a loader\n      dispatch(getUserPermissions());\n    }\n\n    try {\n      const { data } = await request('/admin/users/me/permissions', { method: 'GET' });\n\n      dispatch(getUserPermissionsSucceeded(data));\n    } catch (err) {\n      console.error(err);\n      dispatch(getUserPermissionsError(err));\n    }\n  };\n\n  useEffect(() => {\n    fetchUserPermissions(true);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  if (isLoading) {\n    return <LoadingIndicatorPage />;\n  }\n\n  return <UserProvider value={{ userPermissions, fetchUserPermissions }}>{children}</UserProvider>;\n};\n\nPermissionsManager.defaultProps = {};\n\nPermissionsManager.propTypes = {\n  children: PropTypes.node.isRequired,\n};\n\nexport default PermissionsManager;\n"]},"metadata":{},"sourceType":"script"}