{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _react = require(\"react\");\n\nvar _axios = _interopRequireDefault(require(\"axios\"));\n\nvar _strapiHelperPlugin = require(\"strapi-helper-plugin\");\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2[\"default\"])(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nvar useFetchPluginsFromMarketPlace = function useFetchPluginsFromMarketPlace() {\n  var _useGlobalContext = (0, _strapiHelperPlugin.useGlobalContext)(),\n      currentLocale = _useGlobalContext.currentLocale;\n\n  var _useState = (0, _react.useState)({\n    error: false,\n    isLoading: true,\n    data: null\n  }),\n      _useState2 = (0, _slicedToArray2[\"default\"])(_useState, 2),\n      state = _useState2[0],\n      setState = _useState2[1];\n\n  (0, _react.useEffect)(function () {\n    var CancelToken = _axios[\"default\"].CancelToken;\n    var source = CancelToken.source();\n\n    var getData = /*#__PURE__*/function () {\n      var _ref = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee() {\n        var _yield$axios$get, data;\n\n        return _regenerator[\"default\"].wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return _axios[\"default\"].get('https://marketplace.strapi.io/plugins', {\n                  cancelToken: source.token,\n                  params: {\n                    lang: currentLocale\n                  }\n                });\n\n              case 3:\n                _yield$axios$get = _context.sent;\n                data = _yield$axios$get.data;\n                setState({\n                  isLoading: false,\n                  data: data,\n                  error: false\n                });\n                _context.next = 11;\n                break;\n\n              case 8:\n                _context.prev = 8;\n                _context.t0 = _context[\"catch\"](0);\n\n                if (_axios[\"default\"].isCancel(_context.t0)) {// Silent\n                } else {\n                  // handle error\n                  setState(function (prev) {\n                    return _objectSpread(_objectSpread({}, prev), {}, {\n                      isLoading: false,\n                      error: true\n                    });\n                  });\n                }\n\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[0, 8]]);\n      }));\n\n      return function getData() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    getData();\n    return function () {\n      source.cancel();\n    };\n  }, [currentLocale]);\n  return state;\n};\n\nvar _default = useFetchPluginsFromMarketPlace;\nexports[\"default\"] = _default;","map":{"version":3,"sources":["/Users/joaovictorlobao/prefeituramaragogistrapi/.cache/admin/src/hooks/useFetchPluginsFromMarketPlace/index.js"],"names":["useFetchPluginsFromMarketPlace","currentLocale","error","isLoading","data","state","setState","CancelToken","axios","source","getData","get","cancelToken","token","params","lang","isCancel","prev","cancel"],"mappings":";;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;;;;;AAEA,IAAMA,8BAA8B,GAAG,SAAjCA,8BAAiC,GAAM;AAC3C,0BAA0B,2CAA1B;AAAA,MAAQC,aAAR,qBAAQA,aAAR;;AACA,kBAA0B,qBAAS;AACjCC,IAAAA,KAAK,EAAE,KAD0B;AAEjCC,IAAAA,SAAS,EAAE,IAFsB;AAGjCC,IAAAA,IAAI,EAAE;AAH2B,GAAT,CAA1B;AAAA;AAAA,MAAOC,KAAP;AAAA,MAAcC,QAAd;;AAMA,wBAAU,YAAM;AACd,QAAMC,WAAW,GAAGC,kBAAMD,WAA1B;AACA,QAAME,MAAM,GAAGF,WAAW,CAACE,MAAZ,EAAf;;AAEA,QAAMC,OAAO;AAAA,+FAAG;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAEWF,kBAAMG,GAAN,CAAU,uCAAV,EAAmD;AACxEC,kBAAAA,WAAW,EAAEH,MAAM,CAACI,KADoD;AAExEC,kBAAAA,MAAM,EAAE;AAAEC,oBAAAA,IAAI,EAAEd;AAAR;AAFgE,iBAAnD,CAFX;;AAAA;AAAA;AAEJG,gBAAAA,IAFI,oBAEJA,IAFI;AAOZE,gBAAAA,QAAQ,CAAC;AACPH,kBAAAA,SAAS,EAAE,KADJ;AAEPC,kBAAAA,IAAI,EAAJA,IAFO;AAGPF,kBAAAA,KAAK,EAAE;AAHA,iBAAD,CAAR;AAPY;AAAA;;AAAA;AAAA;AAAA;;AAaZ,oBAAIM,kBAAMQ,QAAN,aAAJ,EAAyB,CACvB;AACD,iBAFD,MAEO;AACL;AACAV,kBAAAA,QAAQ,CAAC,UAAAW,IAAI;AAAA,2DAAUA,IAAV;AAAgBd,sBAAAA,SAAS,EAAE,KAA3B;AAAkCD,sBAAAA,KAAK,EAAE;AAAzC;AAAA,mBAAL,CAAR;AACD;;AAlBW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAH;;AAAA,sBAAPQ,OAAO;AAAA;AAAA;AAAA,OAAb;;AAsBAA,IAAAA,OAAO;AAEP,WAAO,YAAM;AACXD,MAAAA,MAAM,CAACS,MAAP;AACD,KAFD;AAGD,GA/BD,EA+BG,CAACjB,aAAD,CA/BH;AAiCA,SAAOI,KAAP;AACD,CA1CD;;eA4CeL,8B","sourcesContent":["import { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport { useGlobalContext } from 'strapi-helper-plugin';\n\nconst useFetchPluginsFromMarketPlace = () => {\n  const { currentLocale } = useGlobalContext();\n  const [state, setState] = useState({\n    error: false,\n    isLoading: true,\n    data: null,\n  });\n\n  useEffect(() => {\n    const CancelToken = axios.CancelToken;\n    const source = CancelToken.source();\n\n    const getData = async () => {\n      try {\n        const { data } = await axios.get('https://marketplace.strapi.io/plugins', {\n          cancelToken: source.token,\n          params: { lang: currentLocale },\n        });\n\n        setState({\n          isLoading: false,\n          data,\n          error: false,\n        });\n      } catch (err) {\n        if (axios.isCancel(err)) {\n          // Silent\n        } else {\n          // handle error\n          setState(prev => ({ ...prev, isLoading: false, error: true }));\n        }\n      }\n    };\n\n    getData();\n\n    return () => {\n      source.cancel();\n    };\n  }, [currentLocale]);\n\n  return state;\n};\n\nexport default useFetchPluginsFromMarketPlace;\n"]},"metadata":{},"sourceType":"script"}