{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _typeof = require(\"@babel/runtime/helpers/typeof\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _reactDnd = require(\"react-dnd\");\n\nvar _reactDndHtml5Backend = require(\"react-dnd-html5-backend\");\n\nvar _lodash = require(\"lodash\");\n\nvar _pluginId = _interopRequireDefault(require(\"../../pluginId\"));\n\nvar _ItemTypes = _interopRequireDefault(require(\"../../utils/ItemTypes\"));\n\nvar _components = require(\"./components\");\n\nvar _Relation = _interopRequireDefault(require(\"./Relation\"));\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nfunction ListItem(_ref) {\n  var data = _ref.data,\n      displayNavigationLink = _ref.displayNavigationLink,\n      findRelation = _ref.findRelation,\n      isDisabled = _ref.isDisabled,\n      mainField = _ref.mainField,\n      moveRelation = _ref.moveRelation,\n      onRemove = _ref.onRemove,\n      searchToPersist = _ref.searchToPersist,\n      targetModel = _ref.targetModel;\n  var to = \"/plugins/\".concat(_pluginId[\"default\"], \"/collectionType/\").concat(targetModel, \"/\").concat(data.id);\n  var hasDraftAndPublish = (0, _lodash.has)(data, 'published_at');\n  var originalIndex = findRelation(data.id).index;\n\n  var _useDrag = (0, _reactDnd.useDrag)({\n    item: {\n      type: _ItemTypes[\"default\"].RELATION,\n      id: data.id,\n      originalIndex: originalIndex,\n      data: data,\n      hasDraftAndPublish: hasDraftAndPublish,\n      mainField: mainField\n    },\n    collect: function collect(monitor) {\n      return {\n        isDragging: monitor.isDragging()\n      };\n    }\n  }),\n      _useDrag2 = (0, _slicedToArray2[\"default\"])(_useDrag, 3),\n      isDragging = _useDrag2[0].isDragging,\n      drag = _useDrag2[1],\n      preview = _useDrag2[2];\n\n  var _useDrop = (0, _reactDnd.useDrop)({\n    accept: _ItemTypes[\"default\"].RELATION,\n    canDrop: function canDrop() {\n      return false;\n    },\n    hover: function hover(_ref2) {\n      var draggedId = _ref2.id;\n\n      if (draggedId !== data.id) {\n        var _findRelation = findRelation(data.id),\n            overIndex = _findRelation.index;\n\n        moveRelation(draggedId, overIndex);\n      }\n    }\n  }),\n      _useDrop2 = (0, _slicedToArray2[\"default\"])(_useDrop, 2),\n      drop = _useDrop2[1];\n\n  (0, _react.useEffect)(function () {\n    preview((0, _reactDndHtml5Backend.getEmptyImage)(), {\n      captureDraggingState: true\n    });\n  }, [preview]);\n  var opacity = isDragging ? 0.2 : 1;\n  return /*#__PURE__*/_react[\"default\"].createElement(_components.Li, {\n    ref: function ref(node) {\n      if (!isDisabled) {\n        drag(drop(node));\n      }\n    },\n    style: {\n      opacity: opacity\n    }\n  }, /*#__PURE__*/_react[\"default\"].createElement(_Relation[\"default\"], {\n    displayNavigationLink: displayNavigationLink,\n    hasDraftAndPublish: hasDraftAndPublish,\n    mainField: mainField,\n    onRemove: onRemove,\n    data: data,\n    to: to,\n    isDisabled: isDisabled,\n    searchToPersist: searchToPersist\n  }));\n}\n\nListItem.defaultProps = {\n  findRelation: function findRelation() {},\n  moveRelation: function moveRelation() {},\n  onRemove: function onRemove() {},\n  searchToPersist: null,\n  targetModel: ''\n};\nListItem.propTypes = {\n  data: _propTypes[\"default\"].object.isRequired,\n  displayNavigationLink: _propTypes[\"default\"].bool.isRequired,\n  findRelation: _propTypes[\"default\"].func,\n  isDisabled: _propTypes[\"default\"].bool.isRequired,\n  mainField: _propTypes[\"default\"].shape({\n    name: _propTypes[\"default\"].string.isRequired,\n    schema: _propTypes[\"default\"].shape({\n      type: _propTypes[\"default\"].string.isRequired\n    }).isRequired\n  }).isRequired,\n  moveRelation: _propTypes[\"default\"].func,\n  onRemove: _propTypes[\"default\"].func,\n  searchToPersist: _propTypes[\"default\"].string,\n  targetModel: _propTypes[\"default\"].string\n};\n\nvar _default = /*#__PURE__*/(0, _react.memo)(ListItem);\n\nexports[\"default\"] = _default;","map":{"version":3,"sources":["/Users/joaovictorlobao/prefeituramaragogistrapi/.cache/plugins/strapi-plugin-content-manager/admin/src/components/SelectMany/ListItem.js"],"names":["ListItem","data","displayNavigationLink","findRelation","isDisabled","mainField","moveRelation","onRemove","searchToPersist","targetModel","to","pluginId","id","hasDraftAndPublish","originalIndex","index","item","type","ItemTypes","RELATION","collect","monitor","isDragging","drag","preview","accept","canDrop","hover","draggedId","overIndex","drop","captureDraggingState","opacity","node","defaultProps","propTypes","PropTypes","object","isRequired","bool","func","shape","name","string","schema"],"mappings":"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","sourcesContent":["import React, { memo, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport { useDrag, useDrop } from 'react-dnd';\nimport { getEmptyImage } from 'react-dnd-html5-backend';\nimport { has } from 'lodash';\n\nimport pluginId from '../../pluginId';\nimport ItemTypes from '../../utils/ItemTypes';\n\nimport { Li } from './components';\nimport Relation from './Relation';\n\nfunction ListItem({\n  data,\n  displayNavigationLink,\n  findRelation,\n  isDisabled,\n  mainField,\n  moveRelation,\n  onRemove,\n  searchToPersist,\n  targetModel,\n}) {\n  const to = `/plugins/${pluginId}/collectionType/${targetModel}/${data.id}`;\n\n  const hasDraftAndPublish = has(data, 'published_at');\n\n  const originalIndex = findRelation(data.id).index;\n  const [{ isDragging }, drag, preview] = useDrag({\n    item: {\n      type: ItemTypes.RELATION,\n      id: data.id,\n      originalIndex,\n      data,\n      hasDraftAndPublish,\n      mainField,\n    },\n    collect: monitor => ({\n      isDragging: monitor.isDragging(),\n    }),\n  });\n  const [, drop] = useDrop({\n    accept: ItemTypes.RELATION,\n    canDrop: () => false,\n    hover({ id: draggedId }) {\n      if (draggedId !== data.id) {\n        const { index: overIndex } = findRelation(data.id);\n        moveRelation(draggedId, overIndex);\n      }\n    },\n  });\n\n  useEffect(() => {\n    preview(getEmptyImage(), { captureDraggingState: true });\n  }, [preview]);\n\n  const opacity = isDragging ? 0.2 : 1;\n\n  return (\n    <Li\n      ref={node => {\n        if (!isDisabled) {\n          drag(drop(node));\n        }\n      }}\n      style={{ opacity }}\n    >\n      <Relation\n        displayNavigationLink={displayNavigationLink}\n        hasDraftAndPublish={hasDraftAndPublish}\n        mainField={mainField}\n        onRemove={onRemove}\n        data={data}\n        to={to}\n        isDisabled={isDisabled}\n        searchToPersist={searchToPersist}\n      />\n    </Li>\n  );\n}\n\nListItem.defaultProps = {\n  findRelation: () => {},\n  moveRelation: () => {},\n  onRemove: () => {},\n  searchToPersist: null,\n  targetModel: '',\n};\n\nListItem.propTypes = {\n  data: PropTypes.object.isRequired,\n  displayNavigationLink: PropTypes.bool.isRequired,\n  findRelation: PropTypes.func,\n  isDisabled: PropTypes.bool.isRequired,\n  mainField: PropTypes.shape({\n    name: PropTypes.string.isRequired,\n    schema: PropTypes.shape({\n      type: PropTypes.string.isRequired,\n    }).isRequired,\n  }).isRequired,\n  moveRelation: PropTypes.func,\n  onRemove: PropTypes.func,\n  searchToPersist: PropTypes.string,\n  targetModel: PropTypes.string,\n};\n\nexport default memo(ListItem);\n"]},"metadata":{},"sourceType":"script"}