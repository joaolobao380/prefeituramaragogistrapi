{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _typeof = require(\"@babel/runtime/helpers/typeof\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime/helpers/assertThisInitialized\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _lodash = require(\"lodash\");\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _reactIntl = require(\"react-intl\");\n\nvar _strapiHelperPlugin = require(\"strapi-helper-plugin\");\n\nvar _getTrad = _interopRequireDefault(require(\"../../utils/getTrad\"));\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2[\"default\"])(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2[\"default\"])(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2[\"default\"])(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nvar WAIT = 400;\n\nvar Search = /*#__PURE__*/function (_React$Component) {\n  (0, _inherits2[\"default\"])(Search, _React$Component);\n\n  var _super = _createSuper(Search);\n\n  function Search() {\n    var _this;\n\n    (0, _classCallCheck2[\"default\"])(this, Search);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"state\", {\n      didType: false,\n      value: _this.props.initValue\n    });\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"timer\", null);\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"resetState\", function () {\n      return _this.setState({\n        value: ''\n      });\n    });\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"handleChange\", function (_ref) {\n      var target = _ref.target;\n\n      if (!_this.state.didType) {\n        _this.context.emitEvent('didSearch');\n      }\n\n      clearTimeout(_this.timer);\n\n      _this.setState({\n        value: target.value,\n        didType: !!target.value\n      });\n\n      _this.timer = setTimeout(function () {\n        return _this.triggerChange(target.value);\n      }, WAIT);\n    });\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"handleClick\", function () {\n      _this.setState({\n        value: '',\n        didType: false\n      });\n\n      _this.triggerChange('');\n    });\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"triggerChange\", function (value) {\n      var method = value ? 'push' : 'remove';\n      var params = method === 'push' ? {\n        _q: value,\n        page: 1\n      } : {\n        _q: ''\n      };\n\n      _this.props.changeParams(params, method);\n    });\n    return _this;\n  }\n\n  (0, _createClass2[\"default\"])(Search, [{\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      var _this$props = this.props,\n          model = _this$props.model,\n          value = _this$props.value;\n\n      if (prevProps.model !== model || !(0, _lodash.isEmpty)(prevProps.value) && (0, _lodash.isEmpty)(value)) {\n        this.resetState();\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var model = this.props.model;\n      var value = this.state.value;\n      return /*#__PURE__*/_react[\"default\"].createElement(_reactIntl.FormattedMessage, {\n        id: (0, _getTrad[\"default\"])('components.Search.placeholder')\n      }, function (placeholder) {\n        return /*#__PURE__*/_react[\"default\"].createElement(_strapiHelperPlugin.HeaderSearch, {\n          label: (0, _lodash.upperFirst)(model),\n          onChange: _this2.handleChange,\n          onClear: _this2.handleClick,\n          placeholder: placeholder,\n          value: value\n        });\n      });\n    }\n  }]);\n  return Search;\n}(_react[\"default\"].Component);\n\n(0, _defineProperty2[\"default\"])(Search, \"contextType\", _strapiHelperPlugin.GlobalContext);\nSearch.defaultProps = {\n  changeParams: function changeParams() {},\n  model: '',\n  value: ''\n};\nSearch.propTypes = {\n  changeParams: _propTypes[\"default\"].func,\n  initValue: _propTypes[\"default\"].string.isRequired,\n  model: _propTypes[\"default\"].string,\n  value: _propTypes[\"default\"].string\n};\n\nvar _default = /*#__PURE__*/(0, _react.memo)(Search);\n\nexports[\"default\"] = _default;","map":{"version":3,"sources":["/Users/joaovictorlobao/prefeituramaragogistrapi/.cache/plugins/strapi-plugin-content-manager/admin/src/components/Search/index.js"],"names":["WAIT","Search","didType","value","props","initValue","setState","target","state","context","emitEvent","clearTimeout","timer","setTimeout","triggerChange","method","params","_q","page","changeParams","prevProps","model","resetState","placeholder","handleChange","handleClick","React","Component","GlobalContext","defaultProps","propTypes","PropTypes","func","string","isRequired"],"mappings":"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","sourcesContent":["/*\n *\n * Search\n *\n */\n\nimport React, { memo } from 'react';\nimport { isEmpty, upperFirst } from 'lodash';\nimport PropTypes from 'prop-types';\nimport { FormattedMessage } from 'react-intl';\nimport { HeaderSearch, GlobalContext } from 'strapi-helper-plugin';\nimport getTrad from '../../utils/getTrad';\n\nconst WAIT = 400;\n\nclass Search extends React.Component {\n  static contextType = GlobalContext;\n\n  state = { didType: false, value: this.props.initValue };\n\n  timer = null;\n\n  componentDidUpdate(prevProps) {\n    const { model, value } = this.props;\n\n    if (prevProps.model !== model || (!isEmpty(prevProps.value) && isEmpty(value))) {\n      this.resetState();\n    }\n  }\n\n  resetState = () => this.setState({ value: '' });\n\n  handleChange = ({ target }) => {\n    if (!this.state.didType) {\n      this.context.emitEvent('didSearch');\n    }\n\n    clearTimeout(this.timer);\n    this.setState({ value: target.value, didType: !!target.value });\n    this.timer = setTimeout(() => this.triggerChange(target.value), WAIT);\n  };\n\n  handleClick = () => {\n    this.setState({ value: '', didType: false });\n    this.triggerChange('');\n  };\n\n  triggerChange = value => {\n    const method = value ? 'push' : 'remove';\n    const params = method === 'push' ? { _q: value, page: 1 } : { _q: '' };\n\n    this.props.changeParams(params, method);\n  };\n\n  render() {\n    const { model } = this.props;\n    const { value } = this.state;\n\n    return (\n      <FormattedMessage id={getTrad('components.Search.placeholder')}>\n        {placeholder => (\n          <HeaderSearch\n            label={upperFirst(model)}\n            onChange={this.handleChange}\n            onClear={this.handleClick}\n            placeholder={placeholder}\n            value={value}\n          />\n        )}\n      </FormattedMessage>\n    );\n  }\n}\n\nSearch.defaultProps = {\n  changeParams: () => {},\n  model: '',\n  value: '',\n};\n\nSearch.propTypes = {\n  changeParams: PropTypes.func,\n  initValue: PropTypes.string.isRequired,\n  model: PropTypes.string,\n  value: PropTypes.string,\n};\n\nexport default memo(Search);\n"]},"metadata":{},"sourceType":"script"}