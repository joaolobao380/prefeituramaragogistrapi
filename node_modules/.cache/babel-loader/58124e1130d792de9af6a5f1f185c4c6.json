{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _typeof = require(\"@babel/runtime/helpers/typeof\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _taggedTemplateLiteral2 = _interopRequireDefault(require(\"@babel/runtime/helpers/taggedTemplateLiteral\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _reactRedux = require(\"react-redux\");\n\nvar _core = require(\"@buffetjs/core\");\n\nvar _strapiHelperPlugin = require(\"strapi-helper-plugin\");\n\nvar _reactRouterDom = require(\"react-router-dom\");\n\nvar _styledComponents = _interopRequireDefault(require(\"styled-components\"));\n\nvar _get = _interopRequireDefault(require(\"lodash/get\"));\n\nvar _useContentTypePermissions = _interopRequireDefault(require(\"../../hooks/useContentTypePermissions\"));\n\nvar _useHasI18n = _interopRequireDefault(require(\"../../hooks/useHasI18n\"));\n\nvar _selectI18nLocales = _interopRequireDefault(require(\"../../selectors/selectI18nLocales\"));\n\nvar _getInitialLocale = _interopRequireDefault(require(\"../../utils/getInitialLocale\"));\n\nvar _templateObject, _templateObject2, _templateObject3;\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2[\"default\"])(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nvar List = _styledComponents[\"default\"].ul(_templateObject || (_templateObject = (0, _taggedTemplateLiteral2[\"default\"])([\"\\n  list-style-type: none;\\n  padding: 3px 0;\\n  margin: 0;\\n\"])));\n\nvar ListItem = _styledComponents[\"default\"].li(_templateObject2 || (_templateObject2 = (0, _taggedTemplateLiteral2[\"default\"])([\"\\n  margin-top: 0;\\n  margin-bottom: 0;\\n  margin-left: -10px;\\n  margin-right: -10px;\\n  padding-left: 10px;\\n  padding-right: 10px;\\n  height: 36px;\\n  display: flex;\\n  justify-content: center;\\n\\n  &:hover {\\n    background: \", \";\\n  }\\n\"])), function (props) {\n  return props.theme.main.colors.mediumGrey;\n});\n\nvar EllipsisParagraph = (0, _styledComponents[\"default\"])(_core.Text)(_templateObject3 || (_templateObject3 = (0, _taggedTemplateLiteral2[\"default\"])([\"\\n  width: \", \";\\n  text-overflow: ellipsis;\\n  overflow: hidden;\\n  white-space: nowrap;\\n  text-align: left;\\n\"])), function (props) {\n  return props.width;\n});\n\nvar LocalePicker = function LocalePicker() {\n  var dispatch = (0, _reactRedux.useDispatch)();\n  var locales = (0, _reactRedux.useSelector)(_selectI18nLocales[\"default\"]);\n\n  var _useQueryParams = (0, _strapiHelperPlugin.useQueryParams)(),\n      _useQueryParams2 = (0, _slicedToArray2[\"default\"])(_useQueryParams, 2),\n      query = _useQueryParams2[0].query,\n      setQuery = _useQueryParams2[1];\n\n  var _useRouteMatch = (0, _reactRouterDom.useRouteMatch)('/plugins/content-manager/collectionType/:slug'),\n      slug = _useRouteMatch.params.slug;\n\n  var isFieldLocalized = (0, _useHasI18n[\"default\"])();\n\n  var _useContentTypePermis = (0, _useContentTypePermissions[\"default\"])(slug),\n      createPermissions = _useContentTypePermis.createPermissions,\n      readPermissions = _useContentTypePermis.readPermissions;\n\n  var initialLocale = (0, _getInitialLocale[\"default\"])(query, locales);\n\n  var _useState = (0, _react.useState)(initialLocale),\n      _useState2 = (0, _slicedToArray2[\"default\"])(_useState, 2),\n      selected = _useState2[0],\n      setSelected = _useState2[1];\n\n  if (!isFieldLocalized) {\n    return null;\n  }\n\n  if (!locales || locales.length === 0) {\n    return null;\n  }\n\n  var displayedLocales = locales.filter(function (locale) {\n    var canCreate = createPermissions.find(function (_ref) {\n      var properties = _ref.properties;\n      return (0, _get[\"default\"])(properties, 'locales', []).includes(locale.code);\n    });\n    var canRead = readPermissions.find(function (_ref2) {\n      var properties = _ref2.properties;\n      return (0, _get[\"default\"])(properties, 'locales', []).includes(locale.code);\n    });\n    return canCreate || canRead;\n  });\n  return /*#__PURE__*/_react[\"default\"].createElement(_core.Picker, {\n    position: \"right\",\n    renderButtonContent: function renderButtonContent(isOpen) {\n      return /*#__PURE__*/_react[\"default\"].createElement(_core.Flex, null, /*#__PURE__*/_react[\"default\"].createElement(EllipsisParagraph, {\n        width: \"20ch\"\n      }, selected.name), /*#__PURE__*/_react[\"default\"].createElement(_core.Padded, {\n        left: true,\n        size: \"sm\"\n      }, /*#__PURE__*/_react[\"default\"].createElement(_strapiHelperPlugin.Carret, {\n        fill: isOpen ? '#007eff' : '#292b2c',\n        isUp: isOpen\n      })));\n    },\n    renderSectionContent: function renderSectionContent(onToggle) {\n      var handleClick = function handleClick(locale) {\n        dispatch({\n          type: 'ContentManager/RBACManager/RESET_PERMISSIONS'\n        });\n        setSelected(locale);\n        setQuery({\n          plugins: _objectSpread(_objectSpread({}, query.plugins), {}, {\n            i18n: {\n              locale: locale.code\n            }\n          })\n        });\n        onToggle();\n      };\n\n      var hasMultipleLocales = displayedLocales.length > 1;\n      return hasMultipleLocales ? /*#__PURE__*/_react[\"default\"].createElement(_core.Padded, {\n        left: true,\n        right: true\n      }, /*#__PURE__*/_react[\"default\"].createElement(List, null, displayedLocales.map(function (locale) {\n        if (locale.id === selected.id) {\n          return null;\n        }\n\n        return /*#__PURE__*/_react[\"default\"].createElement(ListItem, {\n          key: locale.id\n        }, /*#__PURE__*/_react[\"default\"].createElement(\"button\", {\n          onClick: function onClick() {\n            return handleClick(locale);\n          },\n          type: \"button\"\n        }, /*#__PURE__*/_react[\"default\"].createElement(EllipsisParagraph, {\n          width: \"200px\"\n        }, locale.name || locale.code)));\n      }))) : null;\n    }\n  });\n};\n\nvar _default = LocalePicker;\nexports[\"default\"] = _default;","map":{"version":3,"sources":["/Users/joaovictorlobao/prefeituramaragogistrapi/.cache/plugins/strapi-plugin-i18n/admin/src/components/LocalePicker/index.js"],"names":["List","styled","ul","ListItem","li","props","theme","main","colors","mediumGrey","EllipsisParagraph","Text","width","LocalePicker","dispatch","locales","selectI18NLocales","query","setQuery","slug","params","isFieldLocalized","createPermissions","readPermissions","initialLocale","selected","setSelected","length","displayedLocales","filter","locale","canCreate","find","properties","includes","code","canRead","isOpen","name","onToggle","handleClick","type","plugins","i18n","hasMultipleLocales","map","id"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { Picker, Padded, Text, Flex } from '@buffetjs/core';\nimport { Carret, useQueryParams } from 'strapi-helper-plugin';\nimport { useRouteMatch } from 'react-router-dom';\nimport styled from 'styled-components';\nimport get from 'lodash/get';\nimport useContentTypePermissions from '../../hooks/useContentTypePermissions';\nimport useHasI18n from '../../hooks/useHasI18n';\nimport selectI18NLocales from '../../selectors/selectI18nLocales';\nimport getInitialLocale from '../../utils/getInitialLocale';\n\nconst List = styled.ul`\n  list-style-type: none;\n  padding: 3px 0;\n  margin: 0;\n`;\n\nconst ListItem = styled.li`\n  margin-top: 0;\n  margin-bottom: 0;\n  margin-left: -10px;\n  margin-right: -10px;\n  padding-left: 10px;\n  padding-right: 10px;\n  height: 36px;\n  display: flex;\n  justify-content: center;\n\n  &:hover {\n    background: ${props => props.theme.main.colors.mediumGrey};\n  }\n`;\n\nconst EllipsisParagraph = styled(Text)`\n  width: ${props => props.width};\n  text-overflow: ellipsis;\n  overflow: hidden;\n  white-space: nowrap;\n  text-align: left;\n`;\n\nconst LocalePicker = () => {\n  const dispatch = useDispatch();\n  const locales = useSelector(selectI18NLocales);\n  const [{ query }, setQuery] = useQueryParams();\n  const {\n    params: { slug },\n  } = useRouteMatch('/plugins/content-manager/collectionType/:slug');\n  const isFieldLocalized = useHasI18n();\n  const { createPermissions, readPermissions } = useContentTypePermissions(slug);\n\n  const initialLocale = getInitialLocale(query, locales);\n  const [selected, setSelected] = useState(initialLocale);\n\n  if (!isFieldLocalized) {\n    return null;\n  }\n\n  if (!locales || locales.length === 0) {\n    return null;\n  }\n\n  const displayedLocales = locales.filter(locale => {\n    const canCreate = createPermissions.find(({ properties }) => {\n      return get(properties, 'locales', []).includes(locale.code);\n    });\n    const canRead = readPermissions.find(({ properties }) =>\n      get(properties, 'locales', []).includes(locale.code)\n    );\n\n    return canCreate || canRead;\n  });\n\n  return (\n    <Picker\n      position=\"right\"\n      renderButtonContent={isOpen => (\n        <Flex>\n          <EllipsisParagraph width=\"20ch\">{selected.name}</EllipsisParagraph>\n\n          <Padded left size=\"sm\">\n            <Carret fill={isOpen ? '#007eff' : '#292b2c'} isUp={isOpen} />\n          </Padded>\n        </Flex>\n      )}\n      renderSectionContent={onToggle => {\n        const handleClick = locale => {\n          dispatch({ type: 'ContentManager/RBACManager/RESET_PERMISSIONS' });\n          setSelected(locale);\n\n          setQuery({\n            plugins: { ...query.plugins, i18n: { locale: locale.code } },\n          });\n          onToggle();\n        };\n\n        const hasMultipleLocales = displayedLocales.length > 1;\n\n        return hasMultipleLocales ? (\n          <Padded left right>\n            <List>\n              {displayedLocales.map(locale => {\n                if (locale.id === selected.id) {\n                  return null;\n                }\n\n                return (\n                  <ListItem key={locale.id}>\n                    <button onClick={() => handleClick(locale)} type=\"button\">\n                      <EllipsisParagraph width=\"200px\">\n                        {locale.name || locale.code}\n                      </EllipsisParagraph>\n                    </button>\n                  </ListItem>\n                );\n              })}\n            </List>\n          </Padded>\n        ) : null;\n      }}\n    />\n  );\n};\n\nexport default LocalePicker;\n"]},"metadata":{},"sourceType":"script"}