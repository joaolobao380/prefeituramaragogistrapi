{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _typeof = require(\"@babel/runtime/helpers/typeof\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nvar _objectWithoutProperties2 = _interopRequireDefault(require(\"@babel/runtime/helpers/objectWithoutProperties\"));\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _hooks = require(\"@buffetjs/hooks\");\n\nvar _styles = require(\"@buffetjs/styles\");\n\nvar _reactVirtualized = require(\"react-virtualized\");\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _reactFontawesome = require(\"@fortawesome/react-fontawesome\");\n\nvar _useDataManager2 = _interopRequireDefault(require(\"../../hooks/useDataManager\"));\n\nvar _CellRenderer = _interopRequireDefault(require(\"./CellRenderer\"));\n\nvar _Search = _interopRequireDefault(require(\"./Search\"));\n\nvar _SearchWrapper = _interopRequireDefault(require(\"./SearchWrapper\"));\n\nvar _Wrapper = _interopRequireDefault(require(\"./Wrapper\"));\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\n/* eslint-disable jsx-a11y/control-has-associated-label */\nvar ComponentIconPicker = function ComponentIconPicker(_ref) {\n  var error = _ref.error,\n      isCreating = _ref.isCreating,\n      label = _ref.label,\n      name = _ref.name,\n      onChange = _ref.onChange,\n      value = _ref.value;\n\n  var _useDataManager = (0, _useDataManager2[\"default\"])(),\n      allIcons = _useDataManager.allIcons,\n      allComponentsIconAlreadyTaken = _useDataManager.allComponentsIconAlreadyTaken;\n\n  var _useState = (0, _react.useState)(value),\n      _useState2 = (0, _slicedToArray2[\"default\"])(_useState, 1),\n      originalIcon = _useState2[0];\n\n  var initialIcons = allIcons.filter(function (ico) {\n    if (isCreating) {\n      return !allComponentsIconAlreadyTaken.includes(ico);\n    } // Edition\n\n\n    return !allComponentsIconAlreadyTaken.filter(function (icon) {\n      return icon !== originalIcon;\n    }).includes(ico);\n  });\n  var ref = (0, _react.useRef)();\n  var searchWrapperRef = (0, _react.useRef)();\n\n  var _useState3 = (0, _react.useState)(false),\n      _useState4 = (0, _slicedToArray2[\"default\"])(_useState3, 2),\n      showSearch = _useState4[0],\n      setShowSearch = _useState4[1];\n\n  var _useState5 = (0, _react.useState)(''),\n      _useState6 = (0, _slicedToArray2[\"default\"])(_useState5, 2),\n      search = _useState6[0],\n      setSearch = _useState6[1];\n\n  var _useState7 = (0, _react.useState)(initialIcons),\n      _useState8 = (0, _slicedToArray2[\"default\"])(_useState7, 2),\n      icons = _useState8[0],\n      setIcons = _useState8[1];\n\n  var toggleSearch = function toggleSearch() {\n    return setShowSearch(function (prev) {\n      return !prev;\n    });\n  };\n\n  (0, _hooks.useClickAwayListener)(searchWrapperRef, function () {\n    setShowSearch(false);\n  });\n  (0, _react.useEffect)(function () {\n    if (showSearch && ref.current) {\n      ref.current.focus();\n    }\n  }, [ref, showSearch]);\n  var cellCount = icons.length;\n\n  var cellSizeAndPositionGetter = function cellSizeAndPositionGetter(_ref2) {\n    var index = _ref2.index;\n    var columnCount = 16;\n    var columnPosition = index % (columnCount || 1);\n    var height = 48;\n    var width = 52;\n    var x = columnPosition * width;\n\n    if (x === 0) {\n      x = 8;\n    }\n\n    var y = parseInt(index / 16, 10) * 48;\n    return {\n      height: height,\n      width: width,\n      x: x,\n      y: y\n    };\n  };\n\n  var handleChangeSearch = function handleChangeSearch(_ref3) {\n    var value = _ref3.target.value;\n    setSearch(value);\n    setIcons(function () {\n      return initialIcons.filter(function (icon) {\n        return icon.includes(value);\n      });\n    });\n  };\n\n  return /*#__PURE__*/_react[\"default\"].createElement(_Wrapper[\"default\"], {\n    error: error !== null\n  }, /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n    className: \"search\"\n  }, /*#__PURE__*/_react[\"default\"].createElement(_styles.Label, {\n    htmlFor: name,\n    style: {\n      marginBottom: 12\n    }\n  }, label), !showSearch ? /*#__PURE__*/_react[\"default\"].createElement(\"button\", {\n    onClick: toggleSearch,\n    type: \"button\"\n  }, /*#__PURE__*/_react[\"default\"].createElement(_reactFontawesome.FontAwesomeIcon, {\n    icon: \"search\"\n  })) : /*#__PURE__*/_react[\"default\"].createElement(_SearchWrapper[\"default\"], {\n    ref: searchWrapperRef\n  }, /*#__PURE__*/_react[\"default\"].createElement(_reactFontawesome.FontAwesomeIcon, {\n    icon: \"search\"\n  }), /*#__PURE__*/_react[\"default\"].createElement(\"button\", {\n    onClick: toggleSearch,\n    type: \"button\"\n  }), /*#__PURE__*/_react[\"default\"].createElement(_Search[\"default\"], {\n    ref: ref,\n    onChange: handleChangeSearch,\n    value: search,\n    placeholder: \"Search\\u2026\"\n  }), /*#__PURE__*/_react[\"default\"].createElement(\"button\", {\n    onClick: function onClick() {\n      setSearch('');\n      setIcons(initialIcons);\n      toggleSearch();\n    },\n    type: \"button\"\n  }, /*#__PURE__*/_react[\"default\"].createElement(_reactFontawesome.FontAwesomeIcon, {\n    icon: \"times\"\n  })))), /*#__PURE__*/_react[\"default\"].createElement(_reactVirtualized.AutoSizer, {\n    disableHeight: true\n  }, function (_ref4) {\n    var width = _ref4.width;\n    return /*#__PURE__*/_react[\"default\"].createElement(_reactVirtualized.Collection, {\n      cellCount: cellCount,\n      cellRenderer: function cellRenderer(_ref5) {\n        var key = _ref5.key,\n            index = _ref5.index,\n            rest = (0, _objectWithoutProperties2[\"default\"])(_ref5, [\"key\", \"index\"]);\n        return /*#__PURE__*/_react[\"default\"].createElement(_CellRenderer[\"default\"], (0, _extends2[\"default\"])({}, rest, {\n          key: key,\n          icon: icons[index],\n          name: name,\n          value: value,\n          onChange: onChange\n        }));\n      },\n      cellSizeAndPositionGetter: cellSizeAndPositionGetter,\n      className: \"collection\",\n      height: 144,\n      width: width + 4\n    });\n  }), error && /*#__PURE__*/_react[\"default\"].createElement(_styles.ErrorMessage, {\n    style: {\n      marginTop: 5,\n      marginBottom: 16\n    }\n  }, error));\n};\n\nComponentIconPicker.defaultProps = {\n  error: null\n};\nComponentIconPicker.propTypes = {\n  error: _propTypes[\"default\"].string,\n  isCreating: _propTypes[\"default\"].bool.isRequired,\n  label: _propTypes[\"default\"].string.isRequired,\n  name: _propTypes[\"default\"].string.isRequired,\n  onChange: _propTypes[\"default\"].func.isRequired,\n  value: _propTypes[\"default\"].string.isRequired\n};\nvar _default = ComponentIconPicker;\nexports[\"default\"] = _default;","map":{"version":3,"sources":["/Users/joaovictorlobao/prefeituramaragogistrapi/.cache/plugins/strapi-plugin-content-type-builder/admin/src/components/ComponentIconPicker/index.js"],"names":["ComponentIconPicker","error","isCreating","label","name","onChange","value","allIcons","allComponentsIconAlreadyTaken","originalIcon","initialIcons","filter","ico","includes","icon","ref","searchWrapperRef","showSearch","setShowSearch","search","setSearch","icons","setIcons","toggleSearch","prev","current","focus","cellCount","length","cellSizeAndPositionGetter","index","columnCount","columnPosition","height","width","x","y","parseInt","handleChangeSearch","target","marginBottom","key","rest","marginTop","defaultProps","propTypes","PropTypes","string","bool","isRequired","func"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\nimport { useClickAwayListener } from '@buffetjs/hooks';\nimport { Label, ErrorMessage } from '@buffetjs/styles';\nimport { AutoSizer, Collection } from 'react-virtualized';\nimport PropTypes from 'prop-types';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport useDataManager from '../../hooks/useDataManager';\nimport CellRenderer from './CellRenderer';\nimport Search from './Search';\nimport SearchWrapper from './SearchWrapper';\nimport Wrapper from './Wrapper';\n\n/* eslint-disable jsx-a11y/control-has-associated-label */\n\nconst ComponentIconPicker = ({ error, isCreating, label, name, onChange, value }) => {\n  const { allIcons, allComponentsIconAlreadyTaken } = useDataManager();\n  const [originalIcon] = useState(value);\n  const initialIcons = allIcons.filter(ico => {\n    if (isCreating) {\n      return !allComponentsIconAlreadyTaken.includes(ico);\n    }\n\n    // Edition\n    return !allComponentsIconAlreadyTaken.filter(icon => icon !== originalIcon).includes(ico);\n  });\n  const ref = useRef();\n  const searchWrapperRef = useRef();\n  const [showSearch, setShowSearch] = useState(false);\n  const [search, setSearch] = useState('');\n  const [icons, setIcons] = useState(initialIcons);\n  const toggleSearch = () => setShowSearch(prev => !prev);\n\n  useClickAwayListener(searchWrapperRef, () => {\n    setShowSearch(false);\n  });\n\n  useEffect(() => {\n    if (showSearch && ref.current) {\n      ref.current.focus();\n    }\n  }, [ref, showSearch]);\n\n  const cellCount = icons.length;\n\n  const cellSizeAndPositionGetter = ({ index }) => {\n    const columnCount = 16;\n    const columnPosition = index % (columnCount || 1);\n\n    const height = 48;\n    const width = 52;\n    let x = columnPosition * width;\n\n    if (x === 0) {\n      x = 8;\n    }\n\n    const y = parseInt(index / 16, 10) * 48;\n\n    return {\n      height,\n      width,\n      x,\n      y,\n    };\n  };\n\n  const handleChangeSearch = ({ target: { value } }) => {\n    setSearch(value);\n    setIcons(() => initialIcons.filter(icon => icon.includes(value)));\n  };\n\n  return (\n    <Wrapper error={error !== null}>\n      <div className=\"search\">\n        <Label htmlFor={name} style={{ marginBottom: 12 }}>\n          {label}\n        </Label>\n        {!showSearch ? (\n          <button onClick={toggleSearch} type=\"button\">\n            <FontAwesomeIcon icon=\"search\" />\n          </button>\n        ) : (\n          <SearchWrapper ref={searchWrapperRef}>\n            <FontAwesomeIcon icon=\"search\" />\n            <button onClick={toggleSearch} type=\"button\" />\n            <Search ref={ref} onChange={handleChangeSearch} value={search} placeholder=\"Searchâ€¦\" />\n            <button\n              onClick={() => {\n                setSearch('');\n                setIcons(initialIcons);\n                toggleSearch();\n              }}\n              type=\"button\"\n            >\n              <FontAwesomeIcon icon=\"times\" />\n            </button>\n          </SearchWrapper>\n        )}\n      </div>\n      <AutoSizer disableHeight>\n        {({ width }) => {\n          return (\n            <Collection\n              cellCount={cellCount}\n              cellRenderer={({ key, index, ...rest }) => {\n                return (\n                  <CellRenderer\n                    {...rest}\n                    key={key}\n                    icon={icons[index]}\n                    name={name}\n                    value={value}\n                    onChange={onChange}\n                  />\n                );\n              }}\n              cellSizeAndPositionGetter={cellSizeAndPositionGetter}\n              className=\"collection\"\n              height={144}\n              width={width + 4}\n            />\n          );\n        }}\n      </AutoSizer>\n      {error && <ErrorMessage style={{ marginTop: 5, marginBottom: 16 }}>{error}</ErrorMessage>}\n    </Wrapper>\n  );\n};\n\nComponentIconPicker.defaultProps = {\n  error: null,\n};\n\nComponentIconPicker.propTypes = {\n  error: PropTypes.string,\n  isCreating: PropTypes.bool.isRequired,\n  label: PropTypes.string.isRequired,\n  name: PropTypes.string.isRequired,\n  onChange: PropTypes.func.isRequired,\n  value: PropTypes.string.isRequired,\n};\n\nexport default ComponentIconPicker;\n"]},"metadata":{},"sourceType":"script"}