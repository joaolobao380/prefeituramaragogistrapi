{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _typeof = require(\"@babel/runtime/helpers/typeof\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _reactRouterDom = require(\"react-router-dom\");\n\nvar _lodash = require(\"lodash\");\n\nvar _custom = require(\"@buffetjs/custom\");\n\nvar _icons = require(\"@buffetjs/icons\");\n\nvar _strapiHelperPlugin = require(\"strapi-helper-plugin\");\n\nvar _hooks = require(\"../../../hooks\");\n\nvar _SettingsPageTitle = _interopRequireDefault(require(\"../../../components/SettingsPageTitle\"));\n\nvar _Webhooks = require(\"../../../components/Webhooks\");\n\nvar _reducer = _interopRequireWildcard(require(\"./reducer\"));\n\nvar _utils = require(\"./utils\");\n\nvar _Wrapper = _interopRequireDefault(require(\"./Wrapper\"));\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\n/**\n *\n * EditView\n *\n */\nfunction EditView() {\n  var _useModels = (0, _hooks.useModels)(),\n      isLoadingForModels = _useModels.isLoading,\n      collectionTypes = _useModels.collectionTypes;\n\n  var isMounted = (0, _react.useRef)();\n\n  var _useGlobalContext = (0, _strapiHelperPlugin.useGlobalContext)(),\n      formatMessage = _useGlobalContext.formatMessage;\n\n  var _useState = (0, _react.useState)(false),\n      _useState2 = (0, _slicedToArray2[\"default\"])(_useState, 2),\n      submittedOnce = _useState2[0],\n      setSubmittedOnce = _useState2[1];\n\n  var _useState3 = (0, _react.useState)(false),\n      _useState4 = (0, _slicedToArray2[\"default\"])(_useState3, 2),\n      isSubmitting = _useState4[0],\n      setIsSubmitting = _useState4[1];\n\n  var _useReducer = (0, _react.useReducer)(_reducer[\"default\"], _reducer.initialState),\n      _useReducer2 = (0, _slicedToArray2[\"default\"])(_useReducer, 2),\n      reducerState = _useReducer2[0],\n      dispatch = _useReducer2[1];\n\n  var _useHistory = (0, _reactRouterDom.useHistory)(),\n      push = _useHistory.push,\n      replace = _useHistory.replace;\n\n  var _useRouteMatch = (0, _reactRouterDom.useRouteMatch)('/settings/webhooks/:id'),\n      id = _useRouteMatch.params.id;\n\n  var abortController = new AbortController();\n  var signal = abortController.signal;\n  var isCreating = id === 'create';\n\n  var _reducerState$toJS = reducerState.toJS(),\n      formErrors = _reducerState$toJS.formErrors,\n      modifiedData = _reducerState$toJS.modifiedData,\n      initialData = _reducerState$toJS.initialData,\n      isLoading = _reducerState$toJS.isLoading,\n      isTriggering = _reducerState$toJS.isTriggering,\n      triggerResponse = _reducerState$toJS.triggerResponse;\n\n  (0, _react.useEffect)(function () {\n    isMounted.current = true;\n\n    var fetchData = /*#__PURE__*/function () {\n      var _ref = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee() {\n        var _yield$request, data;\n\n        return _regenerator[\"default\"].wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return (0, _strapiHelperPlugin.request)(\"/admin/webhooks/\".concat(id), {\n                  method: 'GET'\n                });\n\n              case 3:\n                _yield$request = _context.sent;\n                data = _yield$request.data;\n\n                if (isMounted.current) {\n                  dispatch({\n                    type: 'GET_DATA_SUCCEEDED',\n                    data: data\n                  });\n                }\n\n                _context.next = 11;\n                break;\n\n              case 8:\n                _context.prev = 8;\n                _context.t0 = _context[\"catch\"](0);\n\n                if (isMounted.current) {\n                  dispatch({\n                    type: 'UNSET_LOADER'\n                  });\n\n                  if (_context.t0.code !== 20) {\n                    strapi.notification.toggle({\n                      type: 'warning',\n                      message: {\n                        id: 'notification.error'\n                      }\n                    });\n                  }\n                }\n\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[0, 8]]);\n      }));\n\n      return function fetchData() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    if (!isCreating) {\n      fetchData();\n    } else {\n      dispatch({\n        type: 'UNSET_LOADER'\n      });\n    }\n\n    return function () {\n      isMounted.current = false;\n      abortController.abort();\n    }; // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [id, isCreating]);\n  var areActionDisabled = (0, _lodash.isEqual)(initialData, modifiedData);\n  var isTriggerActionDisabled = isCreating || !isCreating && !areActionDisabled || isTriggering;\n  var formattedErrors = Object.keys(formErrors).filter(function (key) {\n    return key.includes('headers');\n  }).reduce(function (obj, key) {\n    obj[key] = formErrors[key];\n    return obj;\n  }, {});\n  /* eslint-disable indent */\n\n  var headerTitle = isCreating ? formatMessage({\n    id: 'Settings.webhooks.create'\n  }) : initialData.name;\n  var headersActions = [{\n    color: 'primary',\n    disabled: isTriggerActionDisabled,\n    label: formatMessage({\n      id: 'Settings.webhooks.trigger'\n    }),\n    onClick: function onClick() {\n      return handleTrigger();\n    },\n    title: isTriggerActionDisabled ? formatMessage({\n      id: 'Settings.webhooks.trigger.save'\n    }) : null,\n    type: 'button',\n    icon: /*#__PURE__*/_react[\"default\"].createElement(_icons.Play, {\n      width: \"8px\",\n      height: \"10px\",\n      fill: isTriggerActionDisabled ? '#b4b6ba' : '#ffffff'\n    })\n  }, {\n    color: 'cancel',\n    disabled: areActionDisabled,\n    label: formatMessage({\n      id: 'app.components.Button.reset'\n    }),\n    onClick: function onClick() {\n      return handleReset();\n    },\n    style: {\n      paddingLeft: '20px',\n      paddingRight: '20px'\n    },\n    type: 'button'\n  }, {\n    color: 'success',\n    disabled: areActionDisabled,\n    label: formatMessage({\n      id: 'app.components.Button.save'\n    }),\n    isLoading: isSubmitting,\n    style: {\n      minWidth: 140\n    },\n    type: 'submit'\n  }];\n  /* eslint-enable indent */\n\n  var headerProps = {\n    title: {\n      label: headerTitle\n    },\n    actions: headersActions\n  };\n\n  var checkFormErrors = /*#__PURE__*/function () {\n    var _ref2 = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee2() {\n      var submit,\n          _args2 = arguments;\n      return _regenerator[\"default\"].wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              submit = _args2.length > 0 && _args2[0] !== undefined ? _args2[0] : false;\n              _context2.prev = 1;\n              _context2.next = 4;\n              return _utils.schema.validate(modifiedData, {\n                abortEarly: false\n              });\n\n            case 4:\n              if (isMounted.current) {\n                setErrors({});\n\n                if (submit) {\n                  submitForm();\n                }\n              }\n\n              _context2.next = 10;\n              break;\n\n            case 7:\n              _context2.prev = 7;\n              _context2.t0 = _context2[\"catch\"](1);\n\n              if (isMounted.current) {\n                setErrors((0, _strapiHelperPlugin.getYupInnerErrors)(_context2.t0));\n\n                if (submit) {\n                  strapi.notification.toggle({\n                    type: 'warning',\n                    message: {\n                      id: 'notification.form.error.fields'\n                    }\n                  });\n                }\n              }\n\n            case 10:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[1, 7]]);\n    }));\n\n    return function checkFormErrors() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var createWebhooks = /*#__PURE__*/function () {\n    var _ref3 = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee3() {\n      var _yield$request2, data;\n\n      return _regenerator[\"default\"].wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.prev = 0;\n              strapi.lockAppWithOverlay();\n              setIsSubmitting(true);\n              _context3.next = 5;\n              return (0, _strapiHelperPlugin.request)('/admin/webhooks', {\n                method: 'POST',\n                body: (0, _utils.cleanData)(modifiedData)\n              });\n\n            case 5:\n              _yield$request2 = _context3.sent;\n              data = _yield$request2.data;\n              setIsSubmitting(false);\n              dispatch({\n                type: 'SUBMIT_SUCCEEDED'\n              });\n              strapi.notification.toggle({\n                type: 'success',\n                message: {\n                  id: 'Settings.webhooks.created'\n                }\n              });\n              replace(\"/settings/webhooks/\".concat(data.id));\n              _context3.next = 17;\n              break;\n\n            case 13:\n              _context3.prev = 13;\n              _context3.t0 = _context3[\"catch\"](0);\n              setIsSubmitting(false);\n              strapi.notification.toggle({\n                type: 'warning',\n                message: {\n                  id: 'notification.error'\n                }\n              });\n\n            case 17:\n              _context3.prev = 17;\n              strapi.unlockApp();\n              return _context3.finish(17);\n\n            case 20:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, null, [[0, 13, 17, 20]]);\n    }));\n\n    return function createWebhooks() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var getErrorMessage = function getErrorMessage(error) {\n    if (!error) {\n      return null;\n    }\n\n    return formatMessage({\n      id: error.id\n    });\n  };\n\n  var goToList = function goToList() {\n    return push('/settings/webhooks');\n  };\n\n  var handleChange = function handleChange(_ref4) {\n    var _ref4$target = _ref4.target,\n        name = _ref4$target.name,\n        value = _ref4$target.value;\n    dispatch({\n      type: 'ON_CHANGE',\n      keys: name.split('.'),\n      value: value\n    });\n\n    if (submittedOnce) {\n      if (name === 'events') {\n        resetEventsError();\n      }\n\n      if (name.includes('headers')) {\n        resetHeadersError(name);\n      }\n    }\n  };\n\n  var handleClick = function handleClick() {\n    dispatch({\n      type: 'ADD_NEW_HEADER',\n      keys: ['headers']\n    });\n  };\n\n  var handleTrigger = /*#__PURE__*/function () {\n    var _ref5 = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee4() {\n      var _yield$request3, data;\n\n      return _regenerator[\"default\"].wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              dispatch({\n                type: 'SET_IS_TRIGGERING'\n              });\n              _context4.prev = 1;\n              _context4.next = 4;\n              return (0, _strapiHelperPlugin.request)(\"/admin/webhooks/\".concat(id, \"/trigger\"), {\n                method: 'POST',\n                signal: signal\n              });\n\n            case 4:\n              _yield$request3 = _context4.sent;\n              data = _yield$request3.data;\n\n              if (isMounted.current) {\n                dispatch({\n                  type: 'TRIGGER_SUCCEEDED',\n                  response: data\n                });\n              }\n\n              _context4.next = 12;\n              break;\n\n            case 9:\n              _context4.prev = 9;\n              _context4.t0 = _context4[\"catch\"](1);\n\n              if (isMounted.current) {\n                if (_context4.t0.code !== 20) {\n                  strapi.notification.toggle({\n                    type: 'warning',\n                    message: {\n                      id: 'notification.error'\n                    }\n                  });\n                }\n\n                dispatch({\n                  type: 'SET_IS_TRIGGERING'\n                });\n              }\n\n            case 12:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4, null, [[1, 9]]);\n    }));\n\n    return function handleTrigger() {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  var handleRemove = function handleRemove(index) {\n    dispatch({\n      type: 'ON_HEADER_REMOVE',\n      index: index\n    });\n    resetHeadersErrors();\n  };\n\n  var handleReset = function handleReset() {\n    return dispatch({\n      type: 'RESET_FORM'\n    });\n  };\n\n  var handleSubmit = function handleSubmit(e) {\n    e.preventDefault();\n    setSubmittedOnce(true);\n    checkFormErrors(true);\n  };\n\n  var onCancelTrigger = function onCancelTrigger() {\n    abortController.abort();\n    dispatch({\n      type: 'ON_TRIGGER_CANCELED'\n    });\n  };\n\n  var resetEventsError = function resetEventsError() {\n    var errors = formErrors;\n    delete errors.events;\n    setErrors(errors);\n  };\n\n  var resetHeadersError = function resetHeadersError(keys) {\n    var errors = formErrors;\n    setErrors((0, _lodash.omit)(errors, [keys]));\n  };\n\n  var resetHeadersErrors = function resetHeadersErrors() {\n    var errors = formErrors;\n    var newErrors = Object.keys(errors).filter(function (key) {\n      return !key.includes('headers');\n    }).reduce(function (obj, key) {\n      obj[key] = formErrors[key];\n      return obj;\n    }, {});\n    setErrors(newErrors);\n  };\n\n  var setErrors = function setErrors(errors) {\n    dispatch({\n      type: 'SET_ERRORS',\n      errors: errors\n    });\n  };\n\n  var submitForm = function submitForm() {\n    if (!isCreating) {\n      updateWebhook();\n    } else {\n      createWebhooks();\n    }\n  };\n\n  var updateWebhook = /*#__PURE__*/function () {\n    var _ref6 = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee5() {\n      var body;\n      return _regenerator[\"default\"].wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              _context5.prev = 0;\n              strapi.lockAppWithOverlay();\n              setIsSubmitting(true);\n              body = (0, _utils.cleanData)(modifiedData);\n              delete body.id;\n              _context5.next = 7;\n              return (0, _strapiHelperPlugin.request)(\"/admin/webhooks/\".concat(id), {\n                method: 'PUT',\n                body: body\n              });\n\n            case 7:\n              setIsSubmitting(false);\n              dispatch({\n                type: 'SUBMIT_SUCCEEDED'\n              });\n              strapi.notification.toggle({\n                type: 'success',\n                message: {\n                  id: 'notification.form.success.fields'\n                }\n              });\n              _context5.next = 16;\n              break;\n\n            case 12:\n              _context5.prev = 12;\n              _context5.t0 = _context5[\"catch\"](0);\n              setIsSubmitting(false);\n              strapi.notification.toggle({\n                type: 'warning',\n                message: {\n                  id: 'notification.error'\n                }\n              });\n\n            case 16:\n              _context5.prev = 16;\n              strapi.unlockApp();\n              return _context5.finish(16);\n\n            case 19:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5, null, [[0, 12, 16, 19]]);\n    }));\n\n    return function updateWebhook() {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n\n  var shouldShowDPEvents = (0, _react.useMemo)(function () {\n    return collectionTypes.some(function (ct) {\n      return ct.options.draftAndPublish === true;\n    });\n  }, [collectionTypes]);\n\n  if (isLoading || isLoadingForModels) {\n    return /*#__PURE__*/_react[\"default\"].createElement(_strapiHelperPlugin.LoadingIndicatorPage, null);\n  }\n\n  return /*#__PURE__*/_react[\"default\"].createElement(_Wrapper[\"default\"], null, /*#__PURE__*/_react[\"default\"].createElement(_SettingsPageTitle[\"default\"], {\n    name: \"Webhooks\"\n  }), /*#__PURE__*/_react[\"default\"].createElement(_strapiHelperPlugin.BackHeader, {\n    onClick: goToList\n  }), /*#__PURE__*/_react[\"default\"].createElement(\"form\", {\n    onSubmit: handleSubmit\n  }, /*#__PURE__*/_react[\"default\"].createElement(_custom.Header, headerProps), (isTriggering || !(0, _lodash.isEmpty)(triggerResponse)) && /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n    className: \"trigger-wrapper\"\n  }, /*#__PURE__*/_react[\"default\"].createElement(_Webhooks.TriggerContainer, {\n    isPending: isTriggering,\n    response: triggerResponse,\n    onCancel: onCancelTrigger\n  })), /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n    className: \"form-wrapper\"\n  }, /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n    className: \"form-card\"\n  }, /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n    className: \"row\"\n  }, Object.keys(_utils.form).map(function (key) {\n    return /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n      key: key,\n      className: _utils.form[key].styleName\n    }, /*#__PURE__*/_react[\"default\"].createElement(_custom.Inputs, (0, _extends2[\"default\"])({}, _utils.form[key], {\n      customInputs: {\n        headers: _Webhooks.Inputs,\n        events: _Webhooks.Inputs\n      },\n      label: formatMessage({\n        id: _utils.form[key].label\n      }),\n      error: getErrorMessage((0, _lodash.get)(formErrors, key, null)),\n      name: key,\n      onChange: handleChange,\n      shouldShowDPEvents: shouldShowDPEvents,\n      validations: _utils.form[key].validations,\n      value: modifiedData[key] || _utils.form[key].value\n    }, _utils.form[key].type === 'headers' && {\n      onClick: handleClick,\n      onRemove: handleRemove,\n      customError: formattedErrors\n    })));\n  }))))));\n}\n\nvar _default = EditView;\nexports[\"default\"] = _default;","map":{"version":3,"sources":["/Users/joaovictorlobao/prefeituramaragogistrapi/.cache/admin/src/containers/Webhooks/EditView/index.js"],"names":["EditView","isLoadingForModels","isLoading","collectionTypes","isMounted","formatMessage","submittedOnce","setSubmittedOnce","isSubmitting","setIsSubmitting","reducer","initialState","reducerState","dispatch","push","replace","id","params","abortController","AbortController","signal","isCreating","toJS","formErrors","modifiedData","initialData","isTriggering","triggerResponse","current","fetchData","method","data","type","code","strapi","notification","toggle","message","abort","areActionDisabled","isTriggerActionDisabled","formattedErrors","Object","keys","filter","key","includes","reduce","obj","headerTitle","name","headersActions","color","disabled","label","onClick","handleTrigger","title","icon","handleReset","style","paddingLeft","paddingRight","minWidth","headerProps","actions","checkFormErrors","submit","schema","validate","abortEarly","setErrors","submitForm","createWebhooks","lockAppWithOverlay","body","unlockApp","getErrorMessage","error","goToList","handleChange","target","value","split","resetEventsError","resetHeadersError","handleClick","response","handleRemove","index","resetHeadersErrors","handleSubmit","e","preventDefault","onCancelTrigger","errors","events","newErrors","updateWebhook","shouldShowDPEvents","some","ct","options","draftAndPublish","form","map","styleName","headers","Inputs","validations","onRemove","customError"],"mappings":"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","sourcesContent":["/**\n *\n * EditView\n *\n */\n\nimport React, { useEffect, useMemo, useReducer, useRef, useState } from 'react';\nimport { useHistory, useRouteMatch } from 'react-router-dom';\nimport { get, isEmpty, isEqual, omit } from 'lodash';\nimport { Header, Inputs as InputsIndex } from '@buffetjs/custom';\nimport { Play } from '@buffetjs/icons';\nimport {\n  request,\n  useGlobalContext,\n  getYupInnerErrors,\n  BackHeader,\n  LoadingIndicatorPage,\n} from 'strapi-helper-plugin';\nimport { useModels } from '../../../hooks';\nimport PageTitle from '../../../components/SettingsPageTitle';\nimport { Inputs, TriggerContainer } from '../../../components/Webhooks';\nimport reducer, { initialState } from './reducer';\nimport { cleanData, form, schema } from './utils';\nimport Wrapper from './Wrapper';\n\nfunction EditView() {\n  const { isLoading: isLoadingForModels, collectionTypes } = useModels();\n\n  const isMounted = useRef();\n  const { formatMessage } = useGlobalContext();\n  const [submittedOnce, setSubmittedOnce] = useState(false);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [reducerState, dispatch] = useReducer(reducer, initialState);\n  const { push, replace } = useHistory();\n  const {\n    params: { id },\n  } = useRouteMatch('/settings/webhooks/:id');\n\n  const abortController = new AbortController();\n  const { signal } = abortController;\n  const isCreating = id === 'create';\n\n  const {\n    formErrors,\n    modifiedData,\n    initialData,\n    isLoading,\n    isTriggering,\n    triggerResponse,\n  } = reducerState.toJS();\n\n  useEffect(() => {\n    isMounted.current = true;\n\n    const fetchData = async () => {\n      try {\n        const { data } = await request(`/admin/webhooks/${id}`, {\n          method: 'GET',\n        });\n\n        if (isMounted.current) {\n          dispatch({\n            type: 'GET_DATA_SUCCEEDED',\n            data,\n          });\n        }\n      } catch (err) {\n        if (isMounted.current) {\n          dispatch({ type: 'UNSET_LOADER' });\n\n          if (err.code !== 20) {\n            strapi.notification.toggle({\n              type: 'warning',\n              message: { id: 'notification.error' },\n            });\n          }\n        }\n      }\n    };\n\n    if (!isCreating) {\n      fetchData();\n    } else {\n      dispatch({ type: 'UNSET_LOADER' });\n    }\n\n    return () => {\n      isMounted.current = false;\n      abortController.abort();\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [id, isCreating]);\n\n  const areActionDisabled = isEqual(initialData, modifiedData);\n\n  const isTriggerActionDisabled = isCreating || (!isCreating && !areActionDisabled) || isTriggering;\n\n  const formattedErrors = Object.keys(formErrors)\n    .filter(key => key.includes('headers'))\n    .reduce((obj, key) => {\n      obj[key] = formErrors[key];\n\n      return obj;\n    }, {});\n\n  /* eslint-disable indent */\n  const headerTitle = isCreating\n    ? formatMessage({\n        id: 'Settings.webhooks.create',\n      })\n    : initialData.name;\n\n  const headersActions = [\n    {\n      color: 'primary',\n      disabled: isTriggerActionDisabled,\n      label: formatMessage({\n        id: 'Settings.webhooks.trigger',\n      }),\n      onClick: () => handleTrigger(),\n      title: isTriggerActionDisabled\n        ? formatMessage({\n            id: 'Settings.webhooks.trigger.save',\n          })\n        : null,\n      type: 'button',\n      icon: (\n        <Play width=\"8px\" height=\"10px\" fill={isTriggerActionDisabled ? '#b4b6ba' : '#ffffff'} />\n      ),\n    },\n    {\n      color: 'cancel',\n      disabled: areActionDisabled,\n      label: formatMessage({\n        id: 'app.components.Button.reset',\n      }),\n      onClick: () => handleReset(),\n      style: {\n        paddingLeft: '20px',\n        paddingRight: '20px',\n      },\n      type: 'button',\n    },\n    {\n      color: 'success',\n      disabled: areActionDisabled,\n      label: formatMessage({\n        id: 'app.components.Button.save',\n      }),\n      isLoading: isSubmitting,\n      style: {\n        minWidth: 140,\n      },\n      type: 'submit',\n    },\n  ];\n  /* eslint-enable indent */\n\n  const headerProps = {\n    title: {\n      label: headerTitle,\n    },\n    actions: headersActions,\n  };\n\n  const checkFormErrors = async (submit = false) => {\n    try {\n      await schema.validate(modifiedData, { abortEarly: false });\n\n      if (isMounted.current) {\n        setErrors({});\n\n        if (submit) {\n          submitForm();\n        }\n      }\n    } catch (err) {\n      if (isMounted.current) {\n        setErrors(getYupInnerErrors(err));\n\n        if (submit) {\n          strapi.notification.toggle({\n            type: 'warning',\n            message: { id: 'notification.form.error.fields' },\n          });\n        }\n      }\n    }\n  };\n\n  const createWebhooks = async () => {\n    try {\n      strapi.lockAppWithOverlay();\n      setIsSubmitting(true);\n      const { data } = await request('/admin/webhooks', {\n        method: 'POST',\n        body: cleanData(modifiedData),\n      });\n      setIsSubmitting(false);\n      dispatch({\n        type: 'SUBMIT_SUCCEEDED',\n      });\n      strapi.notification.toggle({\n        type: 'success',\n        message: { id: 'Settings.webhooks.created' },\n      });\n      replace(`/settings/webhooks/${data.id}`);\n    } catch (err) {\n      setIsSubmitting(false);\n      strapi.notification.toggle({\n        type: 'warning',\n        message: { id: 'notification.error' },\n      });\n    } finally {\n      strapi.unlockApp();\n    }\n  };\n\n  const getErrorMessage = error => {\n    if (!error) {\n      return null;\n    }\n\n    return formatMessage({\n      id: error.id,\n    });\n  };\n\n  const goToList = () => push('/settings/webhooks');\n\n  const handleChange = ({ target: { name, value } }) => {\n    dispatch({\n      type: 'ON_CHANGE',\n      keys: name.split('.'),\n      value,\n    });\n\n    if (submittedOnce) {\n      if (name === 'events') {\n        resetEventsError();\n      }\n      if (name.includes('headers')) {\n        resetHeadersError(name);\n      }\n    }\n  };\n\n  const handleClick = () => {\n    dispatch({\n      type: 'ADD_NEW_HEADER',\n      keys: ['headers'],\n    });\n  };\n\n  const handleTrigger = async () => {\n    dispatch({\n      type: 'SET_IS_TRIGGERING',\n    });\n\n    try {\n      const { data } = await request(`/admin/webhooks/${id}/trigger`, {\n        method: 'POST',\n        signal,\n      });\n\n      if (isMounted.current) {\n        dispatch({\n          type: 'TRIGGER_SUCCEEDED',\n          response: data,\n        });\n      }\n    } catch (err) {\n      if (isMounted.current) {\n        if (err.code !== 20) {\n          strapi.notification.toggle({\n            type: 'warning',\n            message: { id: 'notification.error' },\n          });\n        }\n        dispatch({\n          type: 'SET_IS_TRIGGERING',\n        });\n      }\n    }\n  };\n\n  const handleRemove = index => {\n    dispatch({\n      type: 'ON_HEADER_REMOVE',\n      index,\n    });\n\n    resetHeadersErrors();\n  };\n\n  const handleReset = () =>\n    dispatch({\n      type: 'RESET_FORM',\n    });\n\n  const handleSubmit = e => {\n    e.preventDefault();\n    setSubmittedOnce(true);\n    checkFormErrors(true);\n  };\n\n  const onCancelTrigger = () => {\n    abortController.abort();\n\n    dispatch({\n      type: 'ON_TRIGGER_CANCELED',\n    });\n  };\n\n  const resetEventsError = () => {\n    const errors = formErrors;\n    delete errors.events;\n    setErrors(errors);\n  };\n\n  const resetHeadersError = keys => {\n    const errors = formErrors;\n\n    setErrors(omit(errors, [keys]));\n  };\n\n  const resetHeadersErrors = () => {\n    const errors = formErrors;\n    const newErrors = Object.keys(errors)\n      .filter(key => !key.includes('headers'))\n      .reduce((obj, key) => {\n        obj[key] = formErrors[key];\n\n        return obj;\n      }, {});\n\n    setErrors(newErrors);\n  };\n\n  const setErrors = errors => {\n    dispatch({\n      type: 'SET_ERRORS',\n      errors,\n    });\n  };\n\n  const submitForm = () => {\n    if (!isCreating) {\n      updateWebhook();\n    } else {\n      createWebhooks();\n    }\n  };\n\n  const updateWebhook = async () => {\n    try {\n      strapi.lockAppWithOverlay();\n      setIsSubmitting(true);\n\n      const body = cleanData(modifiedData);\n      delete body.id;\n\n      await request(`/admin/webhooks/${id}`, {\n        method: 'PUT',\n        body,\n      });\n      setIsSubmitting(false);\n      dispatch({\n        type: 'SUBMIT_SUCCEEDED',\n      });\n      strapi.notification.toggle({\n        type: 'success',\n        message: { id: 'notification.form.success.fields' },\n      });\n    } catch (err) {\n      setIsSubmitting(false);\n      strapi.notification.toggle({\n        type: 'warning',\n        message: { id: 'notification.error' },\n      });\n    } finally {\n      strapi.unlockApp();\n    }\n  };\n\n  const shouldShowDPEvents = useMemo(\n    () => collectionTypes.some(ct => ct.options.draftAndPublish === true),\n    [collectionTypes]\n  );\n\n  if (isLoading || isLoadingForModels) {\n    return <LoadingIndicatorPage />;\n  }\n\n  return (\n    <Wrapper>\n      <PageTitle name=\"Webhooks\" />\n      <BackHeader onClick={goToList} />\n      <form onSubmit={handleSubmit}>\n        <Header {...headerProps} />\n        {(isTriggering || !isEmpty(triggerResponse)) && (\n          <div className=\"trigger-wrapper\">\n            <TriggerContainer\n              isPending={isTriggering}\n              response={triggerResponse}\n              onCancel={onCancelTrigger}\n            />\n          </div>\n        )}\n        <div className=\"form-wrapper\">\n          <div className=\"form-card\">\n            <div className=\"row\">\n              {Object.keys(form).map(key => {\n                return (\n                  <div key={key} className={form[key].styleName}>\n                    <InputsIndex\n                      {...form[key]}\n                      customInputs={{\n                        headers: Inputs,\n                        events: Inputs,\n                      }}\n                      label={formatMessage({\n                        id: form[key].label,\n                      })}\n                      error={getErrorMessage(get(formErrors, key, null))}\n                      name={key}\n                      onChange={handleChange}\n                      shouldShowDPEvents={shouldShowDPEvents}\n                      validations={form[key].validations}\n                      value={modifiedData[key] || form[key].value}\n                      {...(form[key].type === 'headers' && {\n                        onClick: handleClick,\n                        onRemove: handleRemove,\n                        customError: formattedErrors,\n                      })}\n                    />\n                  </div>\n                );\n              })}\n            </div>\n          </div>\n        </div>\n      </form>\n    </Wrapper>\n  );\n}\n\nexport default EditView;\n"]},"metadata":{},"sourceType":"script"}