{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _strapiHelperPlugin = require(\"strapi-helper-plugin\");\n\nvar _custom = require(\"@buffetjs/custom\");\n\nvar _PageTitle = _interopRequireDefault(require(\"../../components/PageTitle\"));\n\nvar _ContainerFluid = _interopRequireDefault(require(\"../../components/ContainerFluid\"));\n\nvar _ListWrapper = _interopRequireDefault(require(\"./ListWrapper\"));\n\nvar _Row = _interopRequireDefault(require(\"./Row\"));\n\nvar _generateRows = _interopRequireDefault(require(\"./utils/generateRows\"));\n\nvar InstalledPluginsPage = function InstalledPluginsPage() {\n  var _useGlobalContext = (0, _strapiHelperPlugin.useGlobalContext)(),\n      formatMessage = _useGlobalContext.formatMessage,\n      plugins = _useGlobalContext.plugins;\n\n  var onConfirm = /*#__PURE__*/function () {\n    var _ref = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee(id) {\n      var requestUrl, overlayblockerParams, response;\n      return _regenerator[\"default\"].wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              requestUrl = \"/admin/plugins/uninstall/\".concat(id); // Force the Overlayblocker to be displayed\n\n              overlayblockerParams = {\n                enabled: true,\n                title: 'app.components.ListPluginsPage.deletePlugin.title',\n                description: 'app.components.ListPluginsPage.deletePlugin.description'\n              }; // Lock the app\n\n              strapi.lockApp(overlayblockerParams);\n              _context.next = 6;\n              return (0, _strapiHelperPlugin.request)(requestUrl, {\n                method: 'DELETE'\n              }, overlayblockerParams);\n\n            case 6:\n              response = _context.sent;\n\n              if (response.ok) {\n                // Reload the app\n                window.location.reload();\n              }\n\n              _context.next = 14;\n              break;\n\n            case 10:\n              _context.prev = 10;\n              _context.t0 = _context[\"catch\"](0);\n              strapi.unlockApp();\n              strapi.notification.toggle({\n                type: 'warning',\n                message: {\n                  id: 'app.components.listPluginsPage.deletePlugin.error'\n                }\n              });\n\n            case 14:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 10]]);\n    }));\n\n    return function onConfirm(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var rows = (0, _generateRows[\"default\"])(plugins, onConfirm);\n  return /*#__PURE__*/_react[\"default\"].createElement(\"div\", null, /*#__PURE__*/_react[\"default\"].createElement(_PageTitle[\"default\"], {\n    title: formatMessage({\n      id: 'app.components.ListPluginsPage.helmet.title'\n    })\n  }), /*#__PURE__*/_react[\"default\"].createElement(_ContainerFluid[\"default\"], null, /*#__PURE__*/_react[\"default\"].createElement(_custom.Header, {\n    title: {\n      label: formatMessage({\n        id: 'app.components.ListPluginsPage.title'\n      })\n    },\n    content: formatMessage({\n      id: 'app.components.ListPluginsPage.description'\n    })\n  }), /*#__PURE__*/_react[\"default\"].createElement(_ListWrapper[\"default\"], null, /*#__PURE__*/_react[\"default\"].createElement(_custom.List, {\n    title: formatMessage({\n      id: 'app.components.listPlugins.title.plural'\n    }, {\n      number: rows.length\n    }),\n    items: rows,\n    customRowComponent: _Row[\"default\"]\n  }))));\n};\n\nvar _default = InstalledPluginsPage;\nexports[\"default\"] = _default;","map":{"version":3,"sources":["/Users/joaovictorlobao/prefeituramaragogistrapi/.cache/admin/src/containers/InstalledPluginsPage/index.js"],"names":["InstalledPluginsPage","formatMessage","plugins","onConfirm","id","requestUrl","overlayblockerParams","enabled","title","description","strapi","lockApp","method","response","ok","window","location","reload","unlockApp","notification","toggle","type","message","rows","label","number","length","Row"],"mappings":";;;;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAEA,IAAMA,oBAAoB,GAAG,SAAvBA,oBAAuB,GAAM;AACjC,0BAAmC,2CAAnC;AAAA,MAAQC,aAAR,qBAAQA,aAAR;AAAA,MAAuBC,OAAvB,qBAAuBA,OAAvB;;AACA,MAAMC,SAAS;AAAA,6FAAG,iBAAMC,EAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAERC,cAAAA,UAFQ,sCAEiCD,EAFjC,GAGd;;AACME,cAAAA,oBAJQ,GAIe;AAC3BC,gBAAAA,OAAO,EAAE,IADkB;AAE3BC,gBAAAA,KAAK,EAAE,mDAFoB;AAG3BC,gBAAAA,WAAW,EAAE;AAHc,eAJf,EASd;;AACAC,cAAAA,MAAM,CAACC,OAAP,CAAeL,oBAAf;AAVc;AAAA,qBAWS,iCAAQD,UAAR,EAAoB;AAAEO,gBAAAA,MAAM,EAAE;AAAV,eAApB,EAA0CN,oBAA1C,CAXT;;AAAA;AAWRO,cAAAA,QAXQ;;AAad,kBAAIA,QAAQ,CAACC,EAAb,EAAiB;AACf;AACAC,gBAAAA,MAAM,CAACC,QAAP,CAAgBC,MAAhB;AACD;;AAhBa;AAAA;;AAAA;AAAA;AAAA;AAkBdP,cAAAA,MAAM,CAACQ,SAAP;AACAR,cAAAA,MAAM,CAACS,YAAP,CAAoBC,MAApB,CAA2B;AACzBC,gBAAAA,IAAI,EAAE,SADmB;AAEzBC,gBAAAA,OAAO,EAAE;AAAElB,kBAAAA,EAAE,EAAE;AAAN;AAFgB,eAA3B;;AAnBc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAATD,SAAS;AAAA;AAAA;AAAA,KAAf;;AA0BA,MAAMoB,IAAI,GAAG,8BAAarB,OAAb,EAAsBC,SAAtB,CAAb;AAEA,sBACE,0DACE,gCAAC,qBAAD;AACE,IAAA,KAAK,EAAEF,aAAa,CAAC;AACnBG,MAAAA,EAAE,EAAE;AADe,KAAD;AADtB,IADF,eAME,gCAAC,0BAAD,qBACE,gCAAC,cAAD;AACE,IAAA,KAAK,EAAE;AACLoB,MAAAA,KAAK,EAAEvB,aAAa,CAAC;AACnBG,QAAAA,EAAE,EAAE;AADe,OAAD;AADf,KADT;AAME,IAAA,OAAO,EAAEH,aAAa,CAAC;AACrBG,MAAAA,EAAE,EAAE;AADiB,KAAD;AANxB,IADF,eAWE,gCAAC,uBAAD,qBACE,gCAAC,YAAD;AACE,IAAA,KAAK,EAAEH,aAAa,CAClB;AAAEG,MAAAA,EAAE,EAAE;AAAN,KADkB,EAElB;AAAEqB,MAAAA,MAAM,EAAEF,IAAI,CAACG;AAAf,KAFkB,CADtB;AAKE,IAAA,KAAK,EAAEH,IALT;AAME,IAAA,kBAAkB,EAAEI;AANtB,IADF,CAXF,CANF,CADF;AA+BD,CA7DD;;eA+De3B,oB","sourcesContent":["import React from 'react';\nimport { useGlobalContext, request } from 'strapi-helper-plugin';\nimport { Header, List } from '@buffetjs/custom';\nimport PageTitle from '../../components/PageTitle';\nimport ContainerFluid from '../../components/ContainerFluid';\nimport ListWrapper from './ListWrapper';\nimport Row from './Row';\nimport generateRows from './utils/generateRows';\n\nconst InstalledPluginsPage = () => {\n  const { formatMessage, plugins } = useGlobalContext();\n  const onConfirm = async id => {\n    try {\n      const requestUrl = `/admin/plugins/uninstall/${id}`;\n      // Force the Overlayblocker to be displayed\n      const overlayblockerParams = {\n        enabled: true,\n        title: 'app.components.ListPluginsPage.deletePlugin.title',\n        description: 'app.components.ListPluginsPage.deletePlugin.description',\n      };\n      // Lock the app\n      strapi.lockApp(overlayblockerParams);\n      const response = await request(requestUrl, { method: 'DELETE' }, overlayblockerParams);\n\n      if (response.ok) {\n        // Reload the app\n        window.location.reload();\n      }\n    } catch (err) {\n      strapi.unlockApp();\n      strapi.notification.toggle({\n        type: 'warning',\n        message: { id: 'app.components.listPluginsPage.deletePlugin.error' },\n      });\n    }\n  };\n\n  const rows = generateRows(plugins, onConfirm);\n\n  return (\n    <div>\n      <PageTitle\n        title={formatMessage({\n          id: 'app.components.ListPluginsPage.helmet.title',\n        })}\n      />\n      <ContainerFluid>\n        <Header\n          title={{\n            label: formatMessage({\n              id: 'app.components.ListPluginsPage.title',\n            }),\n          }}\n          content={formatMessage({\n            id: 'app.components.ListPluginsPage.description',\n          })}\n        />\n        <ListWrapper>\n          <List\n            title={formatMessage(\n              { id: 'app.components.listPlugins.title.plural' },\n              { number: rows.length }\n            )}\n            items={rows}\n            customRowComponent={Row}\n          />\n        </ListWrapper>\n      </ContainerFluid>\n    </div>\n  );\n};\n\nexport default InstalledPluginsPage;\n"]},"metadata":{},"sourceType":"script"}